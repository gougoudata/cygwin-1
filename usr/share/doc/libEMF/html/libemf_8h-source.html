<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>libemf.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.8.1 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>libemf.h</h1><div class="fragment"><pre>00001 <font class="comment">/* -*- c++ -*-</font>
00002 <font class="comment"> * EMF: A library for generating ECMA-234 Enhanced Metafiles</font>
00003 <font class="comment"> * Copyright (C) 2002 lignum Computing, Inc. &lt;libemf@lignumcomputing.com&gt;</font>
00004 <font class="comment"> * $Id: libemf_8h-source.html 43 2002-02-04 20:57:04Z allen $</font>
00005 <font class="comment"> *</font>
00006 <font class="comment"> * This library is free software; you can redistribute it and/or</font>
00007 <font class="comment"> * modify it under the terms of the GNU Lesser General Public</font>
00008 <font class="comment"> * License as published by the Free Software Foundation; either</font>
00009 <font class="comment"> * version 2.1 of the License, or (at your option) any later version.</font>
00010 <font class="comment"> *</font>
00011 <font class="comment"> * This library is distributed in the hope that it will be useful,</font>
00012 <font class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</font>
00013 <font class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</font>
00014 <font class="comment"> * Lesser General Public License for more details.</font>
00015 <font class="comment"> *</font>
00016 <font class="comment"> * You should have received a copy of the GNU Lesser General Public</font>
00017 <font class="comment"> * License along with this library; if not, write to the Free Software</font>
00018 <font class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</font>
00019 <font class="comment"> *</font>
00020 <font class="comment"> */</font>
00021 <font class="preprocessor">#ifndef _LIBEMF_H</font>
00022 <font class="preprocessor"></font><font class="preprocessor">#define _LIBEMF_H 1</font>
00023 <font class="preprocessor"></font>
00024 <font class="preprocessor">#include &lt;cmath&gt;</font>
00025 <font class="preprocessor">#include &lt;vector&gt;</font>
00026 <font class="preprocessor">#include &lt;map&gt;</font>
00027 <font class="preprocessor">#include &lt;functional&gt;</font>
00028 <font class="preprocessor">#include &lt;algorithm&gt;</font>
00029 
00030 <font class="preprocessor">#include &lt;config.h&gt;</font>
00031 <font class="preprocessor">#include &lt;emf.h&gt;</font>
00032 
00033 <font class="preprocessor">#include &lt;wine/w16.h&gt;</font>
00034 
00035 <font class="keyword">namespace </font>EMF {
00040   <font class="keyword">const</font> <font class="keywordtype">int</font> XMAX_PIXELS = 1024; <font class="comment">/*(INT_MAX)*/</font>
00045   <font class="keyword">const</font> <font class="keywordtype">int</font> YMAX_PIXELS = 768; <font class="comment">/*(INT_MAX)*/</font>
00051   <font class="keyword">const</font> <font class="keywordtype">int</font> XMAX_MM = 320;
00057   <font class="keyword">const</font> <font class="keywordtype">int</font> YMAX_MM = 240;
00061   <font class="keyword">const</font> <font class="keywordtype">int</font> RESOLUTION = 96;
00065   <font class="keyword">static</font> <font class="keyword">inline</font> <font class="keywordtype">int</font> ROUND_TO_LONG ( <font class="keywordtype">int</font> n )<font class="keyword"> </font>{ <font class="keywordflow">return</font> ((n+3)/4)*4; }
00066 
00068 
<a name="l00073"></a><a class="code" href="structEMF_1_1WCHARSTR.html">00073</a>   <font class="keyword">struct </font>WCHARSTR {
<a name="l00074"></a><a class="code" href="structEMF_1_1WCHARSTR.html#m0">00074</a>     WCHAR *<font class="keyword">const</font> string_;       
<a name="l00075"></a><a class="code" href="structEMF_1_1WCHARSTR.html#m1">00075</a>     <font class="keyword">const</font> <font class="keywordtype">int</font> length_;          
00076 
<a name="l00081"></a><a class="code" href="structEMF_1_1WCHARSTR.html#a0">00081</a>     <a class="code" href="structEMF_1_1WCHARSTR.html#a0">WCHARSTR</a> ( WCHAR *<font class="keyword">const</font> string, <font class="keyword">const</font> <font class="keywordtype">int</font> length )
00082       : string_( string ), length_( length ) {}
00083   };
00084 
00086 
<a name="l00091"></a><a class="code" href="structEMF_1_1CHARSTR.html">00091</a>   <font class="keyword">struct </font>CHARSTR {
<a name="l00092"></a><a class="code" href="structEMF_1_1CHARSTR.html#m0">00092</a>     CHAR *<font class="keyword">const</font> string_;        
<a name="l00093"></a><a class="code" href="structEMF_1_1CHARSTR.html#m1">00093</a>     <font class="keyword">const</font> <font class="keywordtype">int</font> length_;          
00094 
<a name="l00099"></a><a class="code" href="structEMF_1_1CHARSTR.html#a0">00099</a>     <a class="code" href="structEMF_1_1CHARSTR.html#a0">CHARSTR</a> ( CHAR *<font class="keyword">const</font> string, <font class="keyword">const</font> <font class="keywordtype">int</font> length )
00100       : string_( string ), length_( length ) {}
00101   };
00102 
00104 
<a name="l00108"></a><a class="code" href="structEMF_1_1BYTEARRAY.html">00108</a>   <font class="keyword">struct </font>BYTEARRAY {
<a name="l00109"></a><a class="code" href="structEMF_1_1BYTEARRAY.html#m0">00109</a>     BYTE *<font class="keyword">const</font> array_;         
<a name="l00110"></a><a class="code" href="structEMF_1_1BYTEARRAY.html#m1">00110</a>     <font class="keyword">const</font> <font class="keywordtype">int</font> n_;               
00111 
<a name="l00116"></a><a class="code" href="structEMF_1_1BYTEARRAY.html#a0">00116</a>     <a class="code" href="structEMF_1_1BYTEARRAY.html#a0">BYTEARRAY</a> ( BYTE *<font class="keyword">const</font> array, <font class="keyword">const</font> <font class="keywordtype">int</font> n )
00117       : array_( array ), n_( n ) {}
00118   };
00119 
00121 
<a name="l00124"></a><a class="code" href="structEMF_1_1POINTLARRAY.html">00124</a>   <font class="keyword">struct </font>POINTLARRAY {
<a name="l00125"></a><a class="code" href="structEMF_1_1POINTLARRAY.html#m0">00125</a>     POINTL *<font class="keyword">const</font> points_;      
<a name="l00126"></a><a class="code" href="structEMF_1_1POINTLARRAY.html#m1">00126</a>     <font class="keyword">const</font> DWORD n_;             
00127 
<a name="l00132"></a><a class="code" href="structEMF_1_1POINTLARRAY.html#a0">00132</a>     <a class="code" href="structEMF_1_1POINTLARRAY.html#a0">POINTLARRAY</a> ( POINTL *<font class="keyword">const</font> points, <font class="keyword">const</font> DWORD n )
00133       : points_( points ), n_( n ) {}
00134   };
00135 
00137 
<a name="l00140"></a><a class="code" href="structEMF_1_1POINT16ARRAY.html">00140</a>   <font class="keyword">struct </font>POINT16ARRAY {
<a name="l00141"></a><a class="code" href="structEMF_1_1POINT16ARRAY.html#m0">00141</a>     POINT16 *<font class="keyword">const</font> points_;     
<a name="l00142"></a><a class="code" href="structEMF_1_1POINT16ARRAY.html#m1">00142</a>     <font class="keyword">const</font> DWORD n_;             
00143 
<a name="l00148"></a><a class="code" href="structEMF_1_1POINT16ARRAY.html#a0">00148</a>     <a class="code" href="structEMF_1_1POINT16ARRAY.html#a0">POINT16ARRAY</a> ( POINT16 *<font class="keyword">const</font> points, <font class="keyword">const</font> DWORD n )
00149       : points_( points ), n_( n ) {}
00150   };
00151 
00153 
<a name="l00156"></a><a class="code" href="structEMF_1_1INTARRAY.html">00156</a>   <font class="keyword">struct </font>INTARRAY {
<a name="l00157"></a><a class="code" href="structEMF_1_1INTARRAY.html#m0">00157</a>     INT *<font class="keyword">const</font> ints_;           
<a name="l00158"></a><a class="code" href="structEMF_1_1INTARRAY.html#m1">00158</a>     <font class="keyword">const</font> DWORD n_;             
00159 
<a name="l00164"></a><a class="code" href="structEMF_1_1INTARRAY.html#a0">00164</a>     <a class="code" href="structEMF_1_1INTARRAY.html#a0">INTARRAY</a> ( INT *<font class="keyword">const</font> ints, <font class="keyword">const</font> DWORD n )
00165       : ints_( ints ), n_( n ) {}
00166   };
00167 
00169 
<a name="l00172"></a><a class="code" href="structEMF_1_1DWORDARRAY.html">00172</a>   <font class="keyword">struct </font>DWORDARRAY {
<a name="l00173"></a><a class="code" href="structEMF_1_1DWORDARRAY.html#m0">00173</a>     DWORD *<font class="keyword">const</font> dwords_;       
<a name="l00174"></a><a class="code" href="structEMF_1_1DWORDARRAY.html#m1">00174</a>     <font class="keyword">const</font> DWORD n_;             
00175 
<a name="l00180"></a><a class="code" href="structEMF_1_1DWORDARRAY.html#a0">00180</a>     <a class="code" href="structEMF_1_1DWORDARRAY.html#a0">DWORDARRAY</a> ( DWORD *<font class="keyword">const</font> dwords, <font class="keyword">const</font> DWORD n )
00181       : dwords_( dwords ), n_( n ) {}
00182   };
00183 
00185 
<a name="l00188"></a><a class="code" href="structEMF_1_1PADDING.html">00188</a>   <font class="keyword">struct </font>PADDING {
<a name="l00189"></a><a class="code" href="structEMF_1_1PADDING.html#p0">00189</a>     <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">char</font> padding_[4]; 
<a name="l00190"></a><a class="code" href="structEMF_1_1PADDING.html#m0">00190</a>     <font class="keyword">const</font> <font class="keywordtype">int</font> size_;            
00191 
<a name="l00195"></a><a class="code" href="structEMF_1_1PADDING.html#a0">00195</a>     <a class="code" href="structEMF_1_1PADDING.html#a0">PADDING</a> ( <font class="keyword">const</font> <font class="keywordtype">int</font> size ) : size_( size ) {}
00196   };
00197   
00199 
<a name="l00206"></a><a class="code" href="classEMF_1_1DATASTREAM.html">00206</a>   <font class="keyword">class </font>DATASTREAM {
00207     <font class="keywordtype">bool</font> swap_;
00208     ::FILE* fp_;
00209 
00210     <font class="keyword">static</font> <font class="keywordtype">bool</font> bigEndian ( <font class="keywordtype">void</font> );
00211   <font class="keyword">public</font>:
<a name="l00217"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a0">00217</a>     <a class="code" href="classEMF_1_1DATASTREAM.html#a0">DATASTREAM</a> ( ::FILE* fp = 0 ) : swap_( bigEndian() ), fp_( fp ) {}
<a name="l00222"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a1">00222</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1DATASTREAM.html#a1">setStream</a> ( ::FILE* fp )<font class="keyword"> </font>{ fp_ = fp; }
<a name="l00227"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a2">00227</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> BYTE&amp; byte )<font class="keyword"></font>
00228 <font class="keyword">    </font>{
00229       fwrite( &amp;byte, <font class="keyword">sizeof</font>(BYTE), 1, fp_ );
00230       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00231     }
<a name="l00236"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a3">00236</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( BYTE&amp; byte )<font class="keyword"></font>
00237 <font class="keyword">    </font>{
00238       fread( &amp;byte, <font class="keyword">sizeof</font>(BYTE), 1, fp_ );
00239       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00240     }
<a name="l00245"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a4">00245</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> WORD&amp; word )<font class="keyword"></font>
00246 <font class="keyword">    </font>{
00247       <font class="keywordflow">if</font> ( swap_ ) {
00248         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font> * p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>*)&amp;word;
00249         fwrite( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00250         fwrite( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00251       }
00252       <font class="keywordflow">else</font>
00253         fwrite( &amp;word, <font class="keyword">sizeof</font>(WORD), 1, fp_ );
00254       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00255     }
<a name="l00260"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a5">00260</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( WORD&amp; word )<font class="keyword"></font>
00261 <font class="keyword">    </font>{
00262       <font class="keywordflow">if</font> ( swap_ ) {
00263         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>*)&amp;word;
00264         fread( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00265         fread( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00266       }
00267       <font class="keywordflow">else</font>
00268         fread( &amp;word, <font class="keyword">sizeof</font>(WORD), 1, fp_ );
00269       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00270     }
<a name="l00275"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a6">00275</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> INT16&amp; word )<font class="keyword"></font>
00276 <font class="keyword">    </font>{
00277       <font class="keywordflow">if</font> ( swap_ ) {
00278         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font> * p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>*)&amp;word;
00279         fwrite( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00280         fwrite( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00281       }
00282       <font class="keywordflow">else</font>
00283         fwrite( &amp;word, <font class="keyword">sizeof</font>(INT16), 1, fp_ );
00284       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00285     }
<a name="l00290"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a7">00290</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( INT16&amp; word )<font class="keyword"></font>
00291 <font class="keyword">    </font>{
00292       <font class="keywordflow">if</font> ( swap_ ) {
00293         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>*)&amp;word;
00294         fread( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00295         fread( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00296       }
00297       <font class="keywordflow">else</font>
00298         fread( &amp;word, <font class="keyword">sizeof</font>(INT16), 1, fp_ );
00299       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00300     }
<a name="l00305"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a8">00305</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> DWORD&amp; dword )<font class="keyword"></font>
00306 <font class="keyword">    </font>{
00307       <font class="keywordflow">if</font> ( swap_ ) {
00308         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>*)&amp;dword;
00309         fwrite( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00310         fwrite( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00311         fwrite( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00312         fwrite( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00313       }
00314       <font class="keywordflow">else</font>
00315         fwrite( &amp;dword, <font class="keyword">sizeof</font>(DWORD), 1, fp_ );
00316       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00317     }
<a name="l00322"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a9">00322</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( DWORD&amp; dword )<font class="keyword"></font>
00323 <font class="keyword">    </font>{
00324       <font class="keywordflow">if</font> ( swap_ ) {
00325         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>*)&amp;dword;
00326         fread( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00327         fread( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00328         fread( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00329         fread( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00330       }
00331       <font class="keywordflow">else</font>
00332         fread( &amp;dword, <font class="keyword">sizeof</font>(DWORD), 1, fp_ );
00333       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00334     }
<a name="l00339"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a10">00339</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> LONG&amp; long_ )<font class="keyword"></font>
00340 <font class="keyword">    </font>{
00341       <font class="keywordflow">if</font> ( swap_ ) {
00342         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>*)&amp;long_;
00343         fwrite( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00344         fwrite( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00345         fwrite( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00346         fwrite( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00347       }
00348       <font class="keywordflow">else</font>
00349         fwrite( &amp;long_, <font class="keyword">sizeof</font>(LONG), 1, fp_ );
00350       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00351     }
<a name="l00356"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a11">00356</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( LONG&amp; long_ )<font class="keyword"></font>
00357 <font class="keyword">    </font>{
00358       <font class="keywordflow">if</font> ( swap_ ) {
00359         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>*)&amp;long_;
00360         fread( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00361         fread( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00362         fread( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00363         fread( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00364       }
00365       <font class="keywordflow">else</font>
00366         fread( &amp;long_, <font class="keyword">sizeof</font>(LONG), 1, fp_ );
00367       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00368     }
<a name="l00373"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a12">00373</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> INT&amp; int_ )<font class="keyword"></font>
00374 <font class="keyword">    </font>{
00375       <font class="keywordflow">if</font> ( swap_ ) {
00376         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>*)&amp;int_;
00377         fwrite( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00378         fwrite( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00379         fwrite( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00380         fwrite( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00381       }
00382       <font class="keywordflow">else</font>
00383         fwrite( &amp;int_, <font class="keyword">sizeof</font>(INT), 1, fp_ );
00384       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00385     }
<a name="l00390"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a13">00390</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( INT&amp; int_ )<font class="keyword"></font>
00391 <font class="keyword">    </font>{
00392       <font class="keywordflow">if</font> ( swap_ ) {
00393         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>*)&amp;int_;
00394         fread( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00395         fread( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00396         fread( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00397         fread( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00398       }
00399       <font class="keywordflow">else</font>
00400         fread( &amp;int_, <font class="keyword">sizeof</font>(INT), 1, fp_ );
00401       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00402     }
<a name="l00407"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a14">00407</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> UINT&amp; uint )<font class="keyword"></font>
00408 <font class="keyword">    </font>{
00409       <font class="keywordflow">if</font> ( swap_ ) {
00410         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>*)&amp;uint;
00411         fwrite( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00412         fwrite( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00413         fwrite( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00414         fwrite( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00415       }
00416       <font class="keywordflow">else</font>
00417         fwrite( &amp;uint, <font class="keyword">sizeof</font>(UINT), 1, fp_ );
00418       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00419     }
<a name="l00424"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a15">00424</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( UINT&amp; uint )<font class="keyword"></font>
00425 <font class="keyword">    </font>{
00426       <font class="keywordflow">if</font> ( swap_ ) {
00427         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>*)&amp;uint;
00428         fread( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00429         fread( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00430         fread( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00431         fread( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00432       }
00433       <font class="keywordflow">else</font>
00434         fread( &amp;uint, <font class="keyword">sizeof</font>(UINT), 1, fp_ );
00435       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00436     }
<a name="l00441"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a16">00441</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> FLOAT&amp; float_ )<font class="keyword"></font>
00442 <font class="keyword">    </font>{
00443       <font class="keywordflow">if</font> ( swap_ ) {
00444         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>*)&amp;float_;
00445         fwrite( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00446         fwrite( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00447         fwrite( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00448         fwrite( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00449       }
00450       <font class="keywordflow">else</font>
00451         fwrite( &amp;float_, <font class="keyword">sizeof</font>(FLOAT), 1, fp_ );
00452       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00453     }
<a name="l00458"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a17">00458</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( FLOAT&amp; float_ )<font class="keyword"></font>
00459 <font class="keyword">    </font>{
00460       <font class="keywordflow">if</font> ( swap_ ) {
00461         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>*)&amp;float_;
00462         fread( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00463         fread( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00464         fread( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00465         fread( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00466       }
00467       <font class="keywordflow">else</font>
00468         fread( &amp;float_, <font class="keyword">sizeof</font>(FLOAT), 1, fp_ );
00469       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00470     }
<a name="l00475"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a18">00475</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> PADDING&amp; padding )<font class="keyword"></font>
00476 <font class="keyword">    </font>{
00477       <font class="keywordflow">if</font> ( padding.size_ != 0 )
00478         fwrite( &amp;padding.padding_, <font class="keyword">sizeof</font>(CHAR), padding.size_, fp_ );
00479       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00480     }
<a name="l00485"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a19">00485</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> RECTL&amp; rectl )<font class="keyword"></font>
00486 <font class="keyword">    </font>{
00487       *<font class="keyword">this</font> &lt;&lt; rectl.left &lt;&lt; rectl.top &lt;&lt; rectl.right &lt;&lt; rectl.bottom;
00488       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00489     }
<a name="l00494"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a20">00494</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( RECTL&amp; rectl )<font class="keyword"></font>
00495 <font class="keyword">    </font>{
00496       *<font class="keyword">this</font> &gt;&gt; rectl.left &gt;&gt; rectl.top &gt;&gt; rectl.right &gt;&gt; rectl.bottom;
00497       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00498     }
<a name="l00503"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a21">00503</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> SIZEL&amp; sizel )<font class="keyword"></font>
00504 <font class="keyword">    </font>{
00505       *<font class="keyword">this</font> &lt;&lt; sizel.cx &lt;&lt; sizel.cy;
00506       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00507     }
<a name="l00512"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a22">00512</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( SIZEL&amp; sizel )<font class="keyword"></font>
00513 <font class="keyword">    </font>{
00514       *<font class="keyword">this</font> &gt;&gt; sizel.cx &gt;&gt; sizel.cy;
00515       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00516     }
<a name="l00521"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a23">00521</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> WCHARSTR&amp; wcharstr )<font class="keyword"></font>
00522 <font class="keyword">    </font>{
00523       <font class="keywordflow">for</font> ( <font class="keywordtype">int</font> i = 0; i &lt; wcharstr.length_; i++ )
00524         *<font class="keyword">this</font> &lt;&lt; wcharstr.string_[i];
00525       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00526     }
<a name="l00531"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a24">00531</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( WCHARSTR&amp; wcharstr )<font class="keyword"></font>
00532 <font class="keyword">    </font>{
00533       <font class="keywordflow">for</font> ( <font class="keywordtype">int</font> i = 0; i &lt; wcharstr.length_; i++ )
00534         *<font class="keyword">this</font> &gt;&gt; wcharstr.string_[i];
00535       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00536     }
<a name="l00541"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a25">00541</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> CHARSTR&amp; charstr )<font class="keyword"></font>
00542 <font class="keyword">    </font>{
00543       fwrite( charstr.string_, <font class="keyword">sizeof</font>(CHAR), charstr.length_, fp_ );
00544       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00545     }
<a name="l00550"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a26">00550</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( CHARSTR&amp; charstr )<font class="keyword"></font>
00551 <font class="keyword">    </font>{
00552       fread( charstr.string_, <font class="keyword">sizeof</font>(CHAR), charstr.length_, fp_ );
00553       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00554     }
<a name="l00559"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a27">00559</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> ::EMR&amp; emr )<font class="keyword"></font>
00560 <font class="keyword">    </font>{
00561       *<font class="keyword">this</font> &lt;&lt; emr.iType &lt;&lt; emr.nSize;
00562       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00563     }
<a name="l00568"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a28">00568</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( ::EMR&amp; emr )<font class="keyword"></font>
00569 <font class="keyword">    </font>{
00570       *<font class="keyword">this</font> &gt;&gt; emr.iType &gt;&gt; emr.nSize;
00571       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00572     }
<a name="l00577"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a29">00577</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> POINT&amp; point )<font class="keyword"></font>
00578 <font class="keyword">    </font>{
00579       *<font class="keyword">this</font> &lt;&lt; point.x &lt;&lt; point.y;
00580       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00581     }
<a name="l00586"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a30">00586</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( POINT&amp; point )<font class="keyword"></font>
00587 <font class="keyword">    </font>{
00588       *<font class="keyword">this</font> &gt;&gt; point.x &gt;&gt; point.y;
00589       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00590     }
<a name="l00595"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a31">00595</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> POINTL&amp; pointl )<font class="keyword"></font>
00596 <font class="keyword">    </font>{
00597       *<font class="keyword">this</font> &lt;&lt; pointl.x &lt;&lt; pointl.y;
00598       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00599     }
<a name="l00604"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a32">00604</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( POINTL&amp; pointl )<font class="keyword"></font>
00605 <font class="keyword">    </font>{
00606       *<font class="keyword">this</font> &gt;&gt; pointl.x &gt;&gt; pointl.y;
00607       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00608     }
<a name="l00613"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a33">00613</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> POINT16&amp; point )<font class="keyword"></font>
00614 <font class="keyword">    </font>{
00615       *<font class="keyword">this</font> &lt;&lt; point.x &lt;&lt; point.y;
00616       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00617     }
<a name="l00622"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a34">00622</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( POINT16&amp; point )<font class="keyword"></font>
00623 <font class="keyword">    </font>{
00624       *<font class="keyword">this</font> &gt;&gt; point.x &gt;&gt; point.y;
00625       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00626     }
<a name="l00631"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a35">00631</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> XFORM&amp; xform )<font class="keyword"></font>
00632 <font class="keyword">    </font>{
00633       *<font class="keyword">this</font> &lt;&lt; xform.eM11 &lt;&lt; xform.eM12 &lt;&lt; xform.eM21 &lt;&lt; xform.eM22
00634             &lt;&lt; xform.eDx &lt;&lt; xform.eDy;
00635       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00636     }
<a name="l00641"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a36">00641</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( XFORM&amp; xform )<font class="keyword"></font>
00642 <font class="keyword">    </font>{
00643       *<font class="keyword">this</font> &gt;&gt; xform.eM11 &gt;&gt; xform.eM12 &gt;&gt; xform.eM21 &gt;&gt; xform.eM22
00644             &gt;&gt; xform.eDx &gt;&gt; xform.eDy;
00645       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00646     }
<a name="l00651"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a37">00651</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> BYTEARRAY&amp; array )<font class="keyword"></font>
00652 <font class="keyword">    </font>{
00653       fwrite( array.array_, <font class="keyword">sizeof</font>(BYTE), array.n_, fp_ );
00654       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00655     }
<a name="l00660"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a38">00660</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( BYTEARRAY&amp; array )<font class="keyword"></font>
00661 <font class="keyword">    </font>{
00662       fread( array.array_, <font class="keyword">sizeof</font>(BYTE), array.n_, fp_ );
00663       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00664     }
<a name="l00669"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a39">00669</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> POINTLARRAY&amp; array )<font class="keyword"></font>
00670 <font class="keyword">    </font>{
00671       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; array.n_; i++ )
00672         *<font class="keyword">this</font> &lt;&lt; array.points_[i];
00673       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00674     }
<a name="l00679"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a40">00679</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( POINTLARRAY&amp; array )<font class="keyword"></font>
00680 <font class="keyword">    </font>{
00681       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; array.n_; i++ )
00682         *<font class="keyword">this</font> &gt;&gt; array.points_[i];
00683       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00684     }
<a name="l00689"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a41">00689</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> POINT16ARRAY&amp; array )<font class="keyword"></font>
00690 <font class="keyword">    </font>{
00691       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; array.n_; i++ )
00692         *<font class="keyword">this</font> &lt;&lt; array.points_[i];
00693       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00694     }
<a name="l00699"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a42">00699</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( POINT16ARRAY&amp; array )<font class="keyword"></font>
00700 <font class="keyword">    </font>{
00701       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; array.n_; i++ )
00702         *<font class="keyword">this</font> &gt;&gt; array.points_[i];
00703       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00704     }
<a name="l00709"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a43">00709</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> INTARRAY&amp; array )<font class="keyword"></font>
00710 <font class="keyword">    </font>{
00711       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; array.n_; i++ )
00712         *<font class="keyword">this</font> &lt;&lt; array.ints_[i];
00713       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00714     }
<a name="l00719"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a44">00719</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( INTARRAY&amp; array )<font class="keyword"></font>
00720 <font class="keyword">    </font>{
00721       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; array.n_; i++ )
00722         *<font class="keyword">this</font> &gt;&gt; array.ints_[i];
00723       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00724     }
<a name="l00729"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a45">00729</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> DWORDARRAY&amp; array )<font class="keyword"></font>
00730 <font class="keyword">    </font>{
00731       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; array.n_; i++ )
00732         *<font class="keyword">this</font> &lt;&lt; array.dwords_[i];
00733       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00734     }
<a name="l00739"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a46">00739</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( DWORDARRAY&amp; array )<font class="keyword"></font>
00740 <font class="keyword">    </font>{
00741       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; array.n_; i++ )
00742         *<font class="keyword">this</font> &gt;&gt; array.dwords_[i];
00743       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00744     }
<a name="l00749"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a47">00749</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> ::EMRTEXT&amp; text )<font class="keyword"></font>
00750 <font class="keyword">    </font>{
00751       *<font class="keyword">this</font> &lt;&lt; text.ptlReference &lt;&lt; text.nChars &lt;&lt; text.offString &lt;&lt; text.fOptions
00752          &lt;&lt; text.rcl &lt;&lt; text.offDx;
00753       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00754     }
<a name="l00759"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a48">00759</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( ::EMRTEXT&amp; text )<font class="keyword"></font>
00760 <font class="keyword">    </font>{
00761       *<font class="keyword">this</font> &gt;&gt; text.ptlReference &gt;&gt; text.nChars &gt;&gt; text.offString &gt;&gt; text.fOptions
00762             &gt;&gt; text.rcl &gt;&gt; text.offDx;
00763       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00764     }
<a name="l00769"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a49">00769</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> LOGPEN&amp; pen )<font class="keyword"></font>
00770 <font class="keyword">    </font>{
00771       *<font class="keyword">this</font> &lt;&lt; pen.lopnStyle &lt;&lt; pen.lopnWidth &lt;&lt; pen.lopnColor;
00772       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00773     }
<a name="l00778"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a50">00778</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( LOGPEN&amp; pen )<font class="keyword"></font>
00779 <font class="keyword">    </font>{
00780       *<font class="keyword">this</font> &gt;&gt; pen.lopnStyle &gt;&gt; pen.lopnWidth &gt;&gt; pen.lopnColor;
00781       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00782     }
<a name="l00787"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a51">00787</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> EXTLOGPEN&amp; pen )<font class="keyword"></font>
00788 <font class="keyword">    </font>{
00789       <font class="comment">// *** How big is this structure if there are no style entries? ***</font>
00790       *<font class="keyword">this</font> &lt;&lt; pen.elpPenStyle &lt;&lt; pen.elpWidth &lt;&lt; pen.elpBrushStyle &lt;&lt; pen.elpColor
00791             &lt;&lt; pen.elpHatch &lt;&lt; pen.elpNumEntries;
00792       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00793     }
<a name="l00798"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a52">00798</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( EXTLOGPEN&amp; pen )<font class="keyword"></font>
00799 <font class="keyword">    </font>{
00800       <font class="comment">// *** How big is this structure if there are no style entries? ***</font>
00801       *<font class="keyword">this</font> &gt;&gt; pen.elpPenStyle &gt;&gt; pen.elpWidth &gt;&gt; pen.elpBrushStyle &gt;&gt; pen.elpColor
00802             &gt;&gt; pen.elpHatch &gt;&gt; pen.elpNumEntries;
00803       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00804     }
<a name="l00809"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a53">00809</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> LOGBRUSH&amp; brush )<font class="keyword"></font>
00810 <font class="keyword">    </font>{
00811       *<font class="keyword">this</font> &lt;&lt; brush.lbStyle &lt;&lt; brush.lbColor &lt;&lt; brush.lbHatch;
00812       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00813     }
<a name="l00818"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a54">00818</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( LOGBRUSH&amp; brush )<font class="keyword"></font>
00819 <font class="keyword">    </font>{
00820       *<font class="keyword">this</font> &gt;&gt; brush.lbStyle &gt;&gt; brush.lbColor &gt;&gt; brush.lbHatch;
00821       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00822     }
<a name="l00827"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a55">00827</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> LOGFONTW&amp; font )<font class="keyword"></font>
00828 <font class="keyword">    </font>{
00829       *<font class="keyword">this</font> &lt;&lt; font.lfHeight &lt;&lt; font.lfWidth &lt;&lt; font.lfEscapement
00830             &lt;&lt; font.lfOrientation &lt;&lt; font.lfWeight &lt;&lt; font.lfItalic
00831             &lt;&lt; font.lfUnderline &lt;&lt; font.lfStrikeOut &lt;&lt; font.lfCharSet
00832             &lt;&lt; font.lfOutPrecision &lt;&lt; font.lfClipPrecision &lt;&lt; font.lfQuality
00833             &lt;&lt; font.lfPitchAndFamily
00834             &lt;&lt; WCHARSTR( const_cast&lt;WCHAR*const&gt;(font.lfFaceName), LF_FACESIZE );
00835       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00836     }
<a name="l00841"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a56">00841</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( LOGFONTW&amp; font )<font class="keyword"></font>
00842 <font class="keyword">    </font>{
00843       WCHARSTR wFaceName( font.lfFaceName, LF_FACESIZE );
00844 
00845       *<font class="keyword">this</font> &gt;&gt; font.lfHeight &gt;&gt; font.lfWidth &gt;&gt; font.lfEscapement
00846             &gt;&gt; font.lfOrientation &gt;&gt; font.lfWeight &gt;&gt; font.lfItalic
00847             &gt;&gt; font.lfUnderline &gt;&gt; font.lfStrikeOut &gt;&gt; font.lfCharSet
00848             &gt;&gt; font.lfOutPrecision &gt;&gt; font.lfClipPrecision &gt;&gt; font.lfQuality
00849             &gt;&gt; font.lfPitchAndFamily
00850             &gt;&gt; wFaceName;
00851       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00852     }
<a name="l00857"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a57">00857</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> PANOSE&amp; panose )<font class="keyword"></font>
00858 <font class="keyword">    </font>{
00859       fwrite( &amp;panose, <font class="keyword">sizeof</font>(PANOSE), 1, fp_ );
00860       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00861     }
<a name="l00866"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a58">00866</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( PANOSE&amp; panose )<font class="keyword"></font>
00867 <font class="keyword">    </font>{
00868       fread( &amp;panose, <font class="keyword">sizeof</font>(PANOSE), 1, fp_ );
00869       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00870     }
<a name="l00875"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a59">00875</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> EXTLOGFONTW&amp; font )<font class="keyword"></font>
00876 <font class="keyword">    </font>{
00877       *<font class="keyword">this</font> &lt;&lt; font.elfLogFont
00878             &lt;&lt; WCHARSTR( const_cast&lt;WCHAR*const&gt;(font.elfFullName),
00879                          LF_FULLFACESIZE )
00880             &lt;&lt; WCHARSTR( const_cast&lt;WCHAR*const&gt;(font.elfStyle), LF_FACESIZE )
00881             &lt;&lt; font.elfVersion &lt;&lt; font.elfStyleSize &lt;&lt; font.elfMatch
00882             &lt;&lt; font.elfReserved
00883             &lt;&lt; BYTEARRAY( const_cast&lt;BYTE*const&gt;(font.elfVendorId),
00884                           ELF_VENDOR_SIZE )
00885             &lt;&lt; font.elfCulture &lt;&lt; font.elfPanose;
00886       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00887     }
<a name="l00892"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a60">00892</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( EXTLOGFONTW&amp; font )<font class="keyword"></font>
00893 <font class="keyword">    </font>{
00894       WCHARSTR wFullName( font.elfFullName, LF_FULLFACESIZE );
00895       WCHARSTR wStyle( font.elfStyle, LF_FACESIZE );
00896       BYTEARRAY bVendorId( font.elfVendorId, ELF_VENDOR_SIZE );
00897       *<font class="keyword">this</font> &gt;&gt; font.elfLogFont
00898             &gt;&gt; wFullName &gt;&gt; wStyle
00899             &gt;&gt; font.elfVersion &gt;&gt; font.elfStyleSize &gt;&gt; font.elfMatch
00900             &gt;&gt; font.elfReserved &gt;&gt; bVendorId
00901             &gt;&gt; font.elfCulture &gt;&gt; font.elfPanose;
00902       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00903     }
<a name="l00908"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a61">00908</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> LOGPALETTE&amp; palette )<font class="keyword"></font>
00909 <font class="keyword">    </font>{
00910       <font class="comment">// *** How big is this structure if the palette is empty? ***</font>
00911       *<font class="keyword">this</font> &lt;&lt; palette.palVersion &lt;&lt; palette.palNumEntries;
00912       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00913     }
<a name="l00918"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a62">00918</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( LOGPALETTE&amp; palette )<font class="keyword"></font>
00919 <font class="keyword">    </font>{
00920       <font class="comment">// *** How big is this structure if the palette is empty? ***</font>
00921       *<font class="keyword">this</font> &gt;&gt; palette.palVersion &gt;&gt; palette.palNumEntries;
00922       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00923     }
00924   };
00925 
00926   <font class="keyword">class </font>METAFILEDEVICECONTEXT;
00927 
00929 
<a name="l00935"></a><a class="code" href="classEMF_1_1METARECORD.html">00935</a>   <font class="keyword">class </font>METARECORD {
00936   <font class="keyword">public</font>:
00943     <font class="keyword">virtual</font> <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1METARECORD.html#a0">execute</a> ( METAFILEDEVICECONTEXT* source, HDC dc ) <font class="keyword">const</font> = 0;
00950     <font class="keyword">virtual</font> <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1METARECORD.html#a1">serialize</a> ( DATASTREAM ds ) = 0;
00956     <font class="keyword">virtual</font> <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1METARECORD.html#a2">size</a> ( <font class="keywordtype">void</font> ) <font class="keyword">const</font> = 0;
<a name="l00962"></a><a class="code" href="classEMF_1_1METARECORD.html#a3">00962</a>     <font class="keyword">virtual</font> <a class="code" href="classEMF_1_1METARECORD.html#a3">~METARECORD</a>( )<font class="keyword"> </font>{ }
00963 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
00964 <font class="preprocessor"></font>
00968     <font class="keyword">virtual</font> <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{}
00969 <font class="preprocessor">#endif</font>
00970 <font class="preprocessor"></font>  };
00971 
00972 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
00973 <font class="preprocessor"></font>  <font class="comment">/* Miscellaneous editing routines */</font>
00974   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_rectl ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, <font class="keyword">const</font> RECTL&amp; rectl )<font class="keyword"></font>
00975 <font class="keyword">  </font>{
00976     printf( <font class="stringliteral">"\t%s\t: (%ld, %ld) - (%ld, %ld)\n"</font>, tag, rectl.left, rectl.top,
00977             rectl.right, rectl.bottom );
00978   }
00979 
00980   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_xform ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, <font class="keyword">const</font> XFORM&amp; xform )<font class="keyword"></font>
00981 <font class="keyword">  </font>{
00982     printf( <font class="stringliteral">"\t%s.eM11\t: %f\n"</font>, tag, xform.eM11 );
00983     printf( <font class="stringliteral">"\t%s.eM12\t: %f\n"</font>, tag, xform.eM12 );
00984     printf( <font class="stringliteral">"\t%s.eM21\t: %f\n"</font>, tag, xform.eM21 );
00985     printf( <font class="stringliteral">"\t%s.eM22\t: %f\n"</font>, tag, xform.eM22 );
00986     printf( <font class="stringliteral">"\t%s.eDx\t: %f\n"</font>, tag, xform.eDx );
00987     printf( <font class="stringliteral">"\t%s.eDy\t: %f\n"</font>, tag, xform.eDy );
00988   }
00989 
00990   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_color ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, <font class="keyword">const</font> COLORREF&amp; color )<font class="keyword"></font>
00991 <font class="keyword">  </font>{
00992     printf( <font class="stringliteral">"\t%s\t: R(0x%02lx) G(0x%02lx) B(0x%02lx)\n"</font>, tag,
00993             GetRValue( color ), GetGValue( color ), GetBValue( color ) );
00994   }
00995 
00996   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_sizel ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, <font class="keyword">const</font> SIZEL&amp; size )<font class="keyword"></font>
00997 <font class="keyword">  </font>{
00998     printf( <font class="stringliteral">"\t%s\t: (%ld, %ld)\n"</font>, tag, size.cx, size.cy );
00999   }
01000 
01001   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_pointl ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, <font class="keyword">const</font> POINTL&amp; point )<font class="keyword"></font>
01002 <font class="keyword">  </font>{
01003     printf( <font class="stringliteral">"\t%s\t: (%ld, %ld)\n"</font>, tag, point.x, point.y );
01004   }
01005 
01006   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_pointlarray ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, <font class="keyword">const</font> DWORD cptl,
01007                                   <font class="keyword">const</font> POINTL* points )<font class="keyword"></font>
01008 <font class="keyword">  </font>{
01009     printf( <font class="stringliteral">"\tcptl%s\t: %ld\n"</font>, tag, cptl );
01010     printf( <font class="stringliteral">"\taptl%s\t: "</font>, tag );
01011     <font class="keywordflow">if</font> ( cptl &gt; 0 )
01012       printf( <font class="stringliteral">"%ld, %ld\n"</font>, points[0].x, points[0].y );
01013     <font class="keywordflow">else</font>
01014       puts( <font class="stringliteral">""</font> );
01015     <font class="keywordflow">for</font> ( DWORD i = 1; i &lt; cptl; i++ )
01016       printf( <font class="stringliteral">"\t\t%s  %ld, %ld\n"</font>, tag, points[i].x, points[i].y );
01017   }
01018 
01019   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_point16array ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, <font class="keyword">const</font> <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> cpts,
01020                                   <font class="keyword">const</font> POINT16* points )<font class="keyword"></font>
01021 <font class="keyword">  </font>{
01022     printf( <font class="stringliteral">"\tcpts%s\t: %d\n"</font>, tag, cpts );
01023     printf( <font class="stringliteral">"\tapts%s\t: "</font>, tag );
01024     <font class="keywordflow">if</font> ( cpts &gt; 0 )
01025       printf( <font class="stringliteral">"%d, %d\n"</font>, points[0].x, points[0].y );
01026     <font class="keywordflow">else</font>
01027       puts( <font class="stringliteral">""</font> );
01028     <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 1; i &lt; cpts; i++ )
01029       printf( <font class="stringliteral">"\t\t%s  %d, %d\n"</font>, tag, points[i].x, points[i].y );
01030   }
01031 
01032   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_pen_style ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, DWORD style )<font class="keyword"></font>
01033 <font class="keyword">  </font>{
01034     printf( <font class="stringliteral">"\t%s\t: "</font>, tag );
01035     <font class="keywordflow">switch</font> ( style &amp; PS_STYLE_MASK ) {
01036     <font class="keywordflow">case</font> PS_SOLID: printf( <font class="stringliteral">"PS_SOLID"</font> ); <font class="keywordflow">break</font>;
01037     <font class="keywordflow">case</font> PS_DASH: printf( <font class="stringliteral">"PS_DASH"</font> ); <font class="keywordflow">break</font>;
01038     <font class="keywordflow">case</font> PS_DOT: printf( <font class="stringliteral">"PS_DOT"</font> ); <font class="keywordflow">break</font>;
01039     <font class="keywordflow">case</font> PS_DASHDOT: printf( <font class="stringliteral">"PS_DASHDOT"</font> ); <font class="keywordflow">break</font>;
01040     <font class="keywordflow">case</font> PS_DASHDOTDOT: printf( <font class="stringliteral">"PS_DASHDOTDOT"</font> ); <font class="keywordflow">break</font>;
01041     <font class="keywordflow">case</font> PS_NULL: printf( <font class="stringliteral">"PS_NULL"</font> ); <font class="keywordflow">break</font>;
01042     <font class="keywordflow">case</font> PS_INSIDEFRAME: printf( <font class="stringliteral">"PS_INSIDEFRAME"</font> ); <font class="keywordflow">break</font>;
01043     <font class="keywordflow">case</font> PS_USERSTYLE: printf( <font class="stringliteral">"PS_USERSTYLE"</font> ); <font class="keywordflow">break</font>;
01044     <font class="keywordflow">case</font> PS_ALTERNATE: printf( <font class="stringliteral">"PS_ALTERNATE"</font> ); <font class="keywordflow">break</font>;
01045     }
01046     <font class="keywordflow">switch</font> ( style &amp; PS_ENDCAP_MASK ) {
01047     <font class="keywordflow">case</font> PS_ENDCAP_ROUND: printf( <font class="stringliteral">" | PS_ENDCAP_ROUND"</font> ); <font class="keywordflow">break</font>;
01048     <font class="keywordflow">case</font> PS_ENDCAP_SQUARE: printf( <font class="stringliteral">" | PS_ENDCAP_SQUARE"</font> ); <font class="keywordflow">break</font>;
01049     <font class="keywordflow">case</font> PS_ENDCAP_FLAT: printf( <font class="stringliteral">" | PS_ENDCAP_FLAT"</font> ); <font class="keywordflow">break</font>;
01050     }
01051     <font class="keywordflow">switch</font> ( style &amp; PS_JOIN_MASK ) {
01052     <font class="keywordflow">case</font> PS_JOIN_ROUND: printf( <font class="stringliteral">" | PS_JOIN_ROUND"</font> ); <font class="keywordflow">break</font>;
01053     <font class="keywordflow">case</font> PS_JOIN_BEVEL: printf( <font class="stringliteral">" | PS_JOIN_BEVEL"</font> ); <font class="keywordflow">break</font>;
01054     <font class="keywordflow">case</font> PS_JOIN_MITER: printf( <font class="stringliteral">" | PS_JOIN_MITER"</font> ); <font class="keywordflow">break</font>;
01055     }
01056     <font class="keywordflow">switch</font> ( style &amp; PS_TYPE_MASK ) {
01057     <font class="keywordflow">case</font> PS_COSMETIC: printf( <font class="stringliteral">" | PS_COSMETIC"</font> ); <font class="keywordflow">break</font>;
01058     <font class="keywordflow">case</font> PS_GEOMETRIC: printf( <font class="stringliteral">" | PS_GEOMETRIC"</font> ); <font class="keywordflow">break</font>;
01059     }
01060     printf( <font class="stringliteral">"\n"</font> );
01061   }
01062 
01063   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_brush_style ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, DWORD style )<font class="keyword"></font>
01064 <font class="keyword">  </font>{
01065     printf( <font class="stringliteral">"\t%s\t: "</font>, tag );
01066     <font class="keywordflow">switch</font> ( style ) {
01067     <font class="keywordflow">case</font> BS_SOLID: printf( <font class="stringliteral">"BS_SOLID"</font> ); <font class="keywordflow">break</font>;
01068     <font class="keywordflow">case</font> BS_NULL: printf( <font class="stringliteral">"BS_NULL"</font> ); <font class="keywordflow">break</font>;
01069     <font class="keywordflow">case</font> BS_HATCHED: printf( <font class="stringliteral">"BS_HATCHED"</font> ); <font class="keywordflow">break</font>;
01070     <font class="keywordflow">case</font> BS_PATTERN: printf( <font class="stringliteral">"BS_PATTERN"</font> ); <font class="keywordflow">break</font>;
01071     <font class="keywordflow">case</font> BS_INDEXED: printf( <font class="stringliteral">"BS_INDEXED"</font> ); <font class="keywordflow">break</font>;
01072     <font class="keywordflow">case</font> BS_DIBPATTERN: printf( <font class="stringliteral">"BS_DIBPATTERN"</font> ); <font class="keywordflow">break</font>;
01073     <font class="keywordflow">case</font> BS_DIBPATTERNPT: printf( <font class="stringliteral">"BS_DIBPATTERNPT"</font> ); <font class="keywordflow">break</font>;
01074     <font class="keywordflow">case</font> BS_PATTERN8X8: printf( <font class="stringliteral">"BS_PATTERN8X8"</font> ); <font class="keywordflow">break</font>;
01075     <font class="keywordflow">case</font> BS_DIBPATTERN8X8: printf( <font class="stringliteral">"BS_DIBPATTERN8X8"</font> ); <font class="keywordflow">break</font>;
01076     <font class="keywordflow">case</font> BS_MONOPATTERN: printf( <font class="stringliteral">"BS_DIBPATTERN8X8"</font> ); <font class="keywordflow">break</font>;
01077     <font class="keywordflow">default</font>: printf( <font class="stringliteral">"unknown(%ld)"</font>, style );
01078     }
01079     printf( <font class="stringliteral">"\n"</font> );
01080   }
01081 
01082   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_brush_hatch ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, DWORD hatch )<font class="keyword"></font>
01083 <font class="keyword">  </font>{
01084     printf( <font class="stringliteral">"\t%s\t: "</font>, tag );
01085     <font class="keywordflow">switch</font> ( hatch ) {
01086     <font class="keywordflow">case</font> HS_HORIZONTAL: printf( <font class="stringliteral">"HS_HORIZONTAL"</font> ); <font class="keywordflow">break</font>;
01087     <font class="keywordflow">case</font> HS_VERTICAL: printf( <font class="stringliteral">"HS_VERTICAL"</font> ); <font class="keywordflow">break</font>;
01088     <font class="keywordflow">case</font> HS_FDIAGONAL: printf( <font class="stringliteral">"HS_FDIAGONAL"</font> ); <font class="keywordflow">break</font>;
01089     <font class="keywordflow">case</font> HS_BDIAGONAL: printf( <font class="stringliteral">"HS_BDIAGONAL"</font> ); <font class="keywordflow">break</font>;
01090     <font class="keywordflow">case</font> HS_CROSS: printf( <font class="stringliteral">"HS_CROSS"</font> ); <font class="keywordflow">break</font>;
01091     <font class="keywordflow">case</font> HS_DIAGCROSS: printf( <font class="stringliteral">"HS_DIAGCROSS"</font> ); <font class="keywordflow">break</font>;
01092     <font class="keywordflow">default</font>: printf( <font class="stringliteral">"unknown(%ld)"</font>, hatch );
01093     }
01094     printf( <font class="stringliteral">"\n"</font> );
01095   }
01096 <font class="preprocessor">#endif</font>
01097 <font class="preprocessor"></font>
01104   <font class="keyword">enum</font> OBJECTTYPE { O_METAFILEDEVICECONTEXT     = OBJ_METADC,
01105                     O_FONT                      = OBJ_FONT,
01106                     O_PEN                       = OBJ_PEN,
01107                     O_EXTPEN                    = OBJ_EXTPEN,
01108                     O_BRUSH                     = OBJ_BRUSH,
01109                     O_PALETTE                   = OBJ_PAL };
01110 <font class="preprocessor">#if 0</font>
01111 <font class="preprocessor"></font>
01114   <font class="keyword">static</font> <font class="keywordtype">char</font>* typStr ( OBJECTTYPE type )<font class="keyword"></font>
01115 <font class="keyword">  </font>{
01116     <font class="keywordflow">switch</font> (type) {
01117     <font class="keywordflow">case</font> O_METAFILEDEVICECONTEXT:
01118       <font class="keywordflow">return</font> <font class="stringliteral">"metafile device context"</font>;
01119     <font class="keywordflow">case</font> O_FONT:
01120       <font class="keywordflow">return</font> <font class="stringliteral">"font"</font>;
01121     <font class="keywordflow">case</font> O_PEN:
01122       <font class="keywordflow">return</font> <font class="stringliteral">"pen"</font>;
01123     <font class="keywordflow">case</font> O_EXTPEN:
01124       <font class="keywordflow">return</font> <font class="stringliteral">"extended pen"</font>;
01125     <font class="keywordflow">case</font> O_BRUSH:
01126       <font class="keywordflow">return</font> <font class="stringliteral">"brush"</font>;
01127     <font class="keywordflow">case</font> O_PALETTE:
01128       <font class="keywordflow">return</font> <font class="stringliteral">"palette"</font>;
01129     }
01130     <font class="keywordflow">return</font> <font class="stringliteral">"unknown object"</font>;
01131   }
01132 <font class="preprocessor">#endif</font>
01133 <font class="preprocessor"></font>
01134 
<a name="l01139"></a><a class="code" href="classEMF_1_1OBJECT.html">01139</a>   <font class="keyword">class </font>OBJECT {
01140   <font class="keyword">public</font>:
<a name="l01141"></a><a class="code" href="classEMF_1_1OBJECT.html#m0">01141</a>     HGDIOBJ handle;             
01142 
<a name="l01143"></a><a class="code" href="classEMF_1_1OBJECT.html#a0">01143</a>     <font class="keyword">virtual</font> <a class="code" href="classEMF_1_1OBJECT.html#a0">~OBJECT</a> ()<font class="keyword"> </font>{}
<a name="l01148"></a><a class="code" href="classEMF_1_1OBJECT.html#a1">01148</a>     <a class="code" href="classEMF_1_1OBJECT.html#a1">OBJECT</a> ( <font class="keywordtype">void</font> ) : handle( 0 ) {}
01152     <font class="keyword">virtual</font> OBJECTTYPE <a class="code" href="classEMF_1_1OBJECT.html#a2">getType</a> ( <font class="keywordtype">void</font> ) <font class="keyword">const</font> = 0;
01153   };
01154 
01156 
<a name="l01161"></a><a class="code" href="classEMF_1_1GRAPHICSOBJECT.html">01161</a>   <font class="keyword">class </font>GRAPHICSOBJECT : <font class="keyword">public</font> OBJECT {
01162   <font class="keyword">public</font>:
<a name="l01164"></a><a class="code" href="classEMF_1_1GRAPHICSOBJECT.html#a0">01164</a>     <font class="keyword">virtual</font> <a class="code" href="classEMF_1_1GRAPHICSOBJECT.html#a0">~GRAPHICSOBJECT</a> ()<font class="keyword"> </font>{}
<a name="l01169"></a><a class="code" href="classEMF_1_1GRAPHICSOBJECT.html#m0">01169</a>     std::map&lt; HDC, HGDIOBJ &gt; contexts;
01175     <font class="keyword">virtual</font> METARECORD* <a class="code" href="classEMF_1_1GRAPHICSOBJECT.html#a1">newEMR</a> ( HDC dc, HGDIOBJ handle ) = 0;
01176   };
01177 
01178   <font class="keyword">typedef</font> METARECORD*(*METARECORDCTOR)(DATASTREAM&amp;);
01179 
01180   <font class="keyword">class </font>GLOBALOBJECTS {
01184     std::vector&lt;OBJECT*&gt; objects;
01185 
01192     std::map&lt; DWORD, METARECORDCTOR &gt; new_records;
01193 
01194   <font class="keyword">public</font>:
01195     GLOBALOBJECTS ( <font class="keywordtype">void</font> );
01196     ~GLOBALOBJECTS ( <font class="keywordtype">void</font> );
01197     HGDIOBJ add ( OBJECT* object );
01198     OBJECT* find ( <font class="keyword">const</font> HGDIOBJ handle );
01199     <font class="keywordtype">void</font> remove ( <font class="keyword">const</font> OBJECT* object );
01200 
01201     std::vector&lt;EMF::OBJECT*&gt;::const_iterator begin ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01202 <font class="keyword">    </font>{ <font class="keywordflow">return</font> objects.begin(); }
01203     std::vector&lt;EMF::OBJECT*&gt;::const_iterator end ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01204 <font class="keyword">    </font>{ <font class="keywordflow">return</font> objects.end(); }
01205 
01206     METARECORDCTOR newRecord ( DWORD iType ) <font class="keyword">const</font>;
01207 
01208     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_eof ( DATASTREAM&amp; ds );
01209     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setviewportorgex ( DATASTREAM&amp; ds );
01210     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setwindoworgex ( DATASTREAM&amp; ds );
01211     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setviewportextex ( DATASTREAM&amp; ds );
01212     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setwindowextex ( DATASTREAM&amp; ds );
01213     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_scaleviewportextex ( DATASTREAM&amp; ds );
01214     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_scalewindowextex ( DATASTREAM&amp; ds );
01215     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_modifyworldtransform ( DATASTREAM&amp; ds );
01216     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setworldtransform ( DATASTREAM&amp; ds );
01217     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_settextalign ( DATASTREAM&amp; ds );
01218     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_settextcolor ( DATASTREAM&amp; ds );
01219     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setbkcolor ( DATASTREAM&amp; ds );
01220     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setbkmode ( DATASTREAM&amp; ds );
01221     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setpolyfillmode ( DATASTREAM&amp; ds );
01222     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setmapmode ( DATASTREAM&amp; ds );
01223     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_selectobject ( DATASTREAM&amp; ds );
01224     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_deleteobject ( DATASTREAM&amp; ds );
01225     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_movetoex ( DATASTREAM&amp; ds );
01226     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_lineto ( DATASTREAM&amp; ds );
01227     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_arc ( DATASTREAM&amp; ds );
01228     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_arcto ( DATASTREAM&amp; ds );
01229     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_rectangle ( DATASTREAM&amp; ds );
01230     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_ellipse ( DATASTREAM&amp; ds );
01231     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polyline ( DATASTREAM&amp; ds );
01232     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polyline16 ( DATASTREAM&amp; ds );
01233     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polygon ( DATASTREAM&amp; ds );
01234     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polygon16 ( DATASTREAM&amp; ds );
01235     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polypolygon ( DATASTREAM&amp; ds );
01236     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polypolygon16 ( DATASTREAM&amp; ds );
01237     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polybezier ( DATASTREAM&amp; ds );
01238     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polybezier16 ( DATASTREAM&amp; ds );
01239     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polybezierto ( DATASTREAM&amp; ds );
01240     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polybezierto16 ( DATASTREAM&amp; ds );
01241     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polylineto ( DATASTREAM&amp; ds );
01242     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polylineto16 ( DATASTREAM&amp; ds );
01243     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_exttextouta ( DATASTREAM&amp; ds );
01244     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setpixelv ( DATASTREAM&amp; ds );
01245     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_createpen ( DATASTREAM&amp; ds );
01246     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_extcreatepen ( DATASTREAM&amp; ds );
01247     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_createbrushindirect ( DATASTREAM&amp; ds );
01248     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_extcreatefontindirectw ( DATASTREAM&amp; ds );
01249     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_fillpath ( DATASTREAM&amp; ds );
01250     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_strokepath ( DATASTREAM&amp; ds );
01251     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_beginpath ( DATASTREAM&amp; ds );
01252     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_endpath ( DATASTREAM&amp; ds );
01253     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_closefigure ( DATASTREAM&amp; ds );
01254     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_savedc ( DATASTREAM&amp; ds );
01255     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_restoredc ( DATASTREAM&amp; ds );
01256     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setmetargn ( DATASTREAM&amp; ds );
01257   };
01258 
01259   <font class="keyword">extern</font> GLOBALOBJECTS globalObjects;
01260 
01262 
<a name="l01268"></a><a class="code" href="classEMF_1_1ENHMETAHEADER.html">01268</a>   <font class="keyword">class </font>ENHMETAHEADER : <font class="keyword">public</font> METARECORD, <font class="keyword">public</font> ::ENHMETAHEADER {
01269 
01270     LPWSTR description_w;
01271     <font class="keywordtype">int</font> description_size;
01272 
01273   <font class="keyword">public</font>:
<a name="l01280"></a><a class="code" href="classEMF_1_1ENHMETAHEADER.html#a0">01280</a>     <a class="code" href="classEMF_1_1ENHMETAHEADER.html#a0">ENHMETAHEADER</a> ( LPCWSTR description = 0 )
01281       : description_w( 0 ), description_size( 0 )
01282     {
01283       iType = EMR_HEADER;
01284       nSize = <font class="keyword">sizeof</font>( ::ENHMETAHEADER );
01285 
01286       <font class="comment">// Compute the bounds</font>
01287       RECTL default_bounds = { 0, 0, 0, 0 };
01288       rclBounds = default_bounds;
01289       RECTL default_frame = { 0, 0, 0, 0 };
01290       rclFrame = default_frame;
01291       dSignature = ENHMETA_SIGNATURE;
01292       nVersion = 0x10000;
01293       nBytes = nSize;
01294       nRecords = 1;
01295       nHandles = 0;
01296       sReserved = 0;
01297       nDescription = 0;
01298       offDescription = 0;
01299       nPalEntries = 0;
01300       szlDevice.cx = XMAX_PIXELS;
01301       szlDevice.cy = YMAX_PIXELS;
01302       szlMillimeters.cx = XMAX_MM;
01303       szlMillimeters.cy = YMAX_MM;
01304       <font class="comment">//</font>
01305       cbPixelFormat = 0;
01306       offPixelFormat = 0;
01307       bOpenGL = FALSE;
01308       <font class="comment">//</font>
01309       szlMicrometers.cx = 1000 * szlMillimeters.cx;
01310       szlMicrometers.cy = 1000 * szlMillimeters.cy;
01311 
01312       <font class="keywordflow">if</font> ( description ) {
01313         <font class="comment">// Count the number of characters in the description</font>
01314         <font class="keywordtype">int</font> description_count = 0, nulls = 0;
01315         LPCWSTR description_p = description;
01316         <font class="keywordflow">while</font> ( nulls &lt; 3 ) {
01317           description_count++;
01318           <font class="keywordflow">if</font> ( (*description_p++) == 0 ) nulls++;
01319         }
01320 
01321         <font class="comment">// Make sure that the TOTAL record length will be a multiple of 4</font>
01322 
01323         <font class="keywordtype">int</font> record_size = ROUND_TO_LONG( <font class="keyword">sizeof</font>( ::ENHMETAHEADER ) +
01324                                          <font class="keyword">sizeof</font>( WCHAR ) * description_count );
01325         description_size =
01326           (record_size - <font class="keyword">sizeof</font>( ::ENHMETAHEADER )) / <font class="keyword">sizeof</font>( WCHAR );
01327 
01328         description_w = <font class="keyword">new</font> WCHAR[ description_size ];
01329 
01330         memset( description_w, 0, <font class="keyword">sizeof</font>(WCHAR) * description_size );
01331 
01332         <font class="keywordflow">for</font> ( <font class="keywordtype">int</font> i=0; i&lt;description_count; i++ )
01333           description_w[i] = *description++;
01334 
01335         nSize = nBytes = record_size;
01336         nDescription = description_count;
01337         offDescription = <font class="keyword">sizeof</font>( ::ENHMETAHEADER );
01338       }
01339     }
01340     
<a name="l01344"></a><a class="code" href="classEMF_1_1ENHMETAHEADER.html#a1">01344</a>     <a class="code" href="classEMF_1_1ENHMETAHEADER.html#a1">~ENHMETAHEADER</a> ( )<font class="keyword"></font>
01345 <font class="keyword">    </font>{
01346       <font class="keywordflow">if</font> ( description_w ) <font class="keyword">delete</font>[] description_w;
01347     }
<a name="l01352"></a><a class="code" href="classEMF_1_1ENHMETAHEADER.html#a2">01352</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1ENHMETAHEADER.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01353 <font class="keyword">    </font>{
01354       ds &lt;&lt; iType &lt;&lt; nSize
01355          &lt;&lt; rclBounds &lt;&lt; rclFrame
01356          &lt;&lt; dSignature &lt;&lt; nVersion &lt;&lt; nBytes &lt;&lt; nRecords &lt;&lt; nHandles &lt;&lt; sReserved
01357          &lt;&lt; nDescription &lt;&lt; offDescription &lt;&lt; nPalEntries
01358          &lt;&lt; szlDevice &lt;&lt; szlMillimeters
01359          &lt;&lt; cbPixelFormat &lt;&lt; offPixelFormat &lt;&lt; bOpenGL
01360          &lt;&lt; szlMicrometers
01361          &lt;&lt; WCHARSTR( description_w, description_size );
01362       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01363     }
<a name="l01367"></a><a class="code" href="classEMF_1_1ENHMETAHEADER.html#a3">01367</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1ENHMETAHEADER.html#a3">unserialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01368 <font class="keyword">    </font>{
01369       ds &gt;&gt; iType &gt;&gt; nSize
01370          &gt;&gt; rclBounds &gt;&gt; rclFrame
01371          &gt;&gt; dSignature &gt;&gt; nVersion &gt;&gt; nBytes &gt;&gt; nRecords &gt;&gt; nHandles &gt;&gt; sReserved
01372          &gt;&gt; nDescription &gt;&gt; offDescription &gt;&gt; nPalEntries
01373          &gt;&gt; szlDevice &gt;&gt; szlMillimeters;
01374 
01375       <font class="comment">// Some elements of the metafile header were added at later dates</font>
01376 
01377 <font class="preprocessor">#define OffsetOf( a, b ) ((unsigned int)(((char*)&amp;(((::ENHMETAHEADER*)a)-&gt;b)) - \</font>
01378 <font class="preprocessor">(char*)((::ENHMETAHEADER*)a)))</font>
01379 <font class="preprocessor"></font>
01380       <font class="keywordflow">if</font> ( OffsetOf( <font class="keyword">this</font>, szlMicrometers ) &lt;= offDescription )
01381         ds &gt;&gt; cbPixelFormat &gt;&gt; offPixelFormat &gt;&gt; bOpenGL;
01382 
01383 <font class="preprocessor">#undef OffsetOf</font>
01384 <font class="preprocessor"></font>
01385       <font class="keywordflow">if</font> ( <font class="keyword">sizeof</font>(::ENHMETAHEADER) &lt;= offDescription )
01386         ds &gt;&gt; szlMicrometers;
01387 
01388       <font class="comment">// Should now probably check that the offset is correct...</font>
01389 
01390       description_size = ( nSize - offDescription ) / <font class="keyword">sizeof</font>(WCHAR);
01391       description_w = <font class="keyword">new</font> WCHAR[ description_size ];
01392 
01393       WCHARSTR description( description_w, description_size );
01394 
01395       ds &gt;&gt; description;
01396 
01397       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01398     }
<a name="l01402"></a><a class="code" href="classEMF_1_1ENHMETAHEADER.html#a4">01402</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1ENHMETAHEADER.html#a4">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> nSize; }
<a name="l01408"></a><a class="code" href="classEMF_1_1ENHMETAHEADER.html#a5">01408</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1ENHMETAHEADER.html#a5">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC <font class="comment">/*dc*/</font> )<font class="keyword"> const</font>
01409 <font class="keyword">    </font>{
01410       <font class="comment">// Actually handled by the destination device context.</font>
01411     }
01412 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01413 <font class="preprocessor"></font>
01416     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01417 <font class="keyword">    </font>{
01418       printf( <font class="stringliteral">"*HEADER*\n"</font> );
01419       printf( <font class="stringliteral">"\tiType\t\t\t: %ld\n"</font>, iType );
01420       printf( <font class="stringliteral">"\tnSize\t\t\t: %ld\n"</font>, nSize );
01421       edit_rectl( <font class="stringliteral">"rclBounds\t"</font>, rclBounds );
01422       edit_rectl( <font class="stringliteral">"rclFrame\t"</font>, rclFrame );
01423       printf( <font class="stringliteral">"\tdSignature\t\t: %.4s\n"</font>, (<font class="keyword">const</font> <font class="keywordtype">char</font>*)&amp;dSignature );
01424       printf( <font class="stringliteral">"\tnVersion\t\t: 0x%x\n"</font>, (<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>)nVersion );
01425       printf( <font class="stringliteral">"\tnBytes\t\t\t: %ld\n"</font>, nBytes );
01426       printf( <font class="stringliteral">"\tnRecords\t\t: %ld\n"</font>, nRecords );
01427       printf( <font class="stringliteral">"\tnHandles\t\t: %d\n"</font>, nHandles );
01428       printf( <font class="stringliteral">"\tnDescription\t\t: %ld\n"</font>, nDescription );
01429       printf( <font class="stringliteral">"\toffDescription\t\t: %ld\n"</font>, offDescription );
01430       printf( <font class="stringliteral">"\tnPalEntries\t\t: %ld\n"</font>, nPalEntries );
01431       edit_sizel( <font class="stringliteral">"szlDevice\t"</font>, szlDevice );
01432       edit_sizel( <font class="stringliteral">"szlMillimeters\t"</font>, szlMillimeters );
01433 
01434       <font class="comment">/* Make a crude guess as to the age of this file */</font>
01435 <font class="preprocessor">#define OffsetOf( a, b ) ((unsigned int)(((const char*)&amp;(((const ::ENHMETAHEADER*)a)-&gt;b)) - \</font>
01436 <font class="preprocessor">(const char*)((const ::ENHMETAHEADER*)a)))</font>
01437 <font class="preprocessor"></font>
01438       <font class="keywordflow">if</font> ( OffsetOf( <font class="keyword">this</font>, cbPixelFormat ) &lt;= offDescription ) {
01439         printf( <font class="stringliteral">"\tcbPixelFormat\t\t: %ld\n"</font>, cbPixelFormat );
01440         printf( <font class="stringliteral">"\toffPixelFormat\t\t: %ld\n"</font>, offPixelFormat );
01441         printf( <font class="stringliteral">"\tbOpenGL\t\t\t: %ld\n"</font>, bOpenGL );
01442 
01443         <font class="keywordflow">if</font> ( <font class="keyword">sizeof</font>(::ENHMETAHEADER) &lt;= offDescription ) {
01444           edit_sizel( <font class="stringliteral">"szlMicrometers\t"</font>, szlMicrometers );
01445         }
01446       }
01447 
01448 <font class="preprocessor">#undef OffsetOf</font>
01449 <font class="preprocessor"></font>
01450       <font class="keywordflow">if</font> ( nDescription != 0 ) {
01451 
01452         <font class="keywordtype">wchar_t</font> last_w = 0;
01453         WCHAR* description = description_w;
01454 
01455         printf( <font class="stringliteral">"\tDescription:"</font> );
01456 
01457         <font class="keywordflow">for</font> ( DWORD i = 0; i &lt; nDescription; i++ ) {
01458 
01459           <font class="keywordtype">wchar_t</font> w = *description++; <font class="comment">/* This is not true, really. UNICODE is not</font>
01460 <font class="comment">                                       * glibc's wide character representation */</font>
01461 
01462           <font class="keywordflow">if</font> ( w != 0 ) {
01463             <font class="keywordflow">if</font> ( last_w == 0 ) printf( <font class="stringliteral">"\n\t\t"</font> );
01464             putchar( w );
01465           }
01466           
01467           last_w = w;
01468         }
01469         printf( <font class="stringliteral">"\n"</font> );
01470       }
01471     }
01472 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01473   };
01474 
01476 
<a name="l01481"></a><a class="code" href="classEMF_1_1EMREOF.html">01481</a>   <font class="keyword">class </font>EMREOF : <font class="keyword">public</font> METARECORD, ::EMREOF {
01482   <font class="keyword">public</font>:
<a name="l01486"></a><a class="code" href="classEMF_1_1EMREOF.html#a0">01486</a>     <a class="code" href="classEMF_1_1EMREOF.html#a0">EMREOF</a> ( <font class="keywordtype">void</font> )<font class="keyword"></font>
01487 <font class="keyword">    </font>{
01488       emr.iType = EMR_EOF;
01489       emr.nSize = <font class="keyword">sizeof</font>( ::EMREOF );
01490       nPalEntries = 0;
01491       offPalEntries = 0;
01492       nSizeLast = 0;
01493     }
01494 
<a name="l01499"></a><a class="code" href="classEMF_1_1EMREOF.html#a1">01499</a>     <a class="code" href="classEMF_1_1EMREOF.html#a0">EMREOF</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
01500 <font class="keyword">    </font>{
01501       ds &gt;&gt; emr &gt;&gt; nPalEntries &gt;&gt; offPalEntries &gt;&gt; nSizeLast;
01502     }
01503 
<a name="l01507"></a><a class="code" href="classEMF_1_1EMREOF.html#a2">01507</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMREOF.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01508 <font class="keyword">    </font>{
01509       ds &lt;&lt; emr &lt;&lt; nPalEntries &lt;&lt; offPalEntries &lt;&lt; nSizeLast;
01510       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01511     }
<a name="l01515"></a><a class="code" href="classEMF_1_1EMREOF.html#a3">01515</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMREOF.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l01521"></a><a class="code" href="classEMF_1_1EMREOF.html#a4">01521</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMREOF.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC <font class="comment">/*dc*/</font> )<font class="keyword"> const</font>
01522 <font class="keyword">    </font>{
01523       <font class="comment">// Actually handled by the destination device context.</font>
01524     }
01525 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01526 <font class="preprocessor"></font>
01529     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01530 <font class="keyword">    </font>{
01531       printf( <font class="stringliteral">"*EOF*\n"</font> );
01532     }
01533 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01534   };
01535 
01537 
<a name="l01542"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html">01542</a>   <font class="keyword">class </font>EMRSETVIEWPORTORGEX : <font class="keyword">public</font> METARECORD, ::EMRSETVIEWPORTORGEX {
01543   <font class="keyword">public</font>:
<a name="l01548"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a0">01548</a>     <a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a0">EMRSETVIEWPORTORGEX</a> ( INT x, INT y )<font class="keyword"></font>
01549 <font class="keyword">    </font>{
01550       emr.iType = EMR_SETVIEWPORTORGEX;
01551       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETVIEWPORTORGEX );
01552       ptlOrigin.x = x;
01553       ptlOrigin.y = y;
01554     }
<a name="l01559"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a1">01559</a>     <a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a0">EMRSETVIEWPORTORGEX</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
01560 <font class="keyword">    </font>{
01561       ds &gt;&gt; emr &gt;&gt; ptlOrigin;
01562     }
<a name="l01566"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a2">01566</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01567 <font class="keyword">    </font>{
01568       ds &lt;&lt; emr &lt;&lt; ptlOrigin;
01569       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01570     }
<a name="l01574"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a3">01574</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l01580"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a4">01580</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
01581 <font class="keyword">    </font>{
01582       SetViewportOrgEx( dc, ptlOrigin.x, ptlOrigin.y, 0 );
01583     }
01584 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01585 <font class="preprocessor"></font>
01588     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01589 <font class="keyword">    </font>{
01590       printf( <font class="stringliteral">"*SETVIEWPORTORGEX*\n"</font> );
01591       edit_pointl( <font class="stringliteral">"ptlOrigin"</font>, ptlOrigin );
01592     }
01593 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01594   };
01595 
01597 
<a name="l01604"></a><a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html">01604</a>   <font class="keyword">class </font>EMRSETWINDOWORGEX : <font class="keyword">public</font> METARECORD, ::EMRSETWINDOWORGEX {
01605   <font class="keyword">public</font>:
<a name="l01610"></a><a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a0">01610</a>     <a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a0">EMRSETWINDOWORGEX</a> ( INT x, INT y )<font class="keyword"></font>
01611 <font class="keyword">    </font>{
01612       emr.iType = EMR_SETWINDOWORGEX;
01613       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETWINDOWORGEX );
01614       ptlOrigin.x = x;
01615       ptlOrigin.y = y;
01616     }
<a name="l01621"></a><a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a1">01621</a>     <a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a0">EMRSETWINDOWORGEX</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
01622 <font class="keyword">    </font>{
01623       ds &gt;&gt; emr &gt;&gt; ptlOrigin;
01624     }
<a name="l01628"></a><a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a2">01628</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01629 <font class="keyword">    </font>{
01630       ds &lt;&lt; emr &lt;&lt; ptlOrigin;
01631       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01632     }
<a name="l01636"></a><a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a3">01636</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l01642"></a><a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a4">01642</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
01643 <font class="keyword">    </font>{
01644       SetWindowOrgEx( dc, ptlOrigin.x, ptlOrigin.y, 0 );
01645     }
01646 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01647 <font class="preprocessor"></font>
01650     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01651 <font class="keyword">    </font>{
01652       printf( <font class="stringliteral">"*SETWINDOWORGEX*\n"</font> );
01653       edit_pointl( <font class="stringliteral">"ptlOrigin"</font>, ptlOrigin );
01654     }
01655 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01656   };
01657 
01659 
<a name="l01664"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html">01664</a>   <font class="keyword">class </font>EMRSETVIEWPORTEXTEX : <font class="keyword">public</font> METARECORD, ::EMRSETVIEWPORTEXTEX {
01665   <font class="keyword">public</font>:
<a name="l01670"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a0">01670</a>     <a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a0">EMRSETVIEWPORTEXTEX</a> ( INT cx, INT cy )<font class="keyword"></font>
01671 <font class="keyword">    </font>{
01672       emr.iType = EMR_SETVIEWPORTEXTEX;
01673       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETVIEWPORTEXTEX );
01674       szlExtent.cx = cx;
01675       szlExtent.cy = cy;
01676     }
<a name="l01681"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a1">01681</a>     <a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a0">EMRSETVIEWPORTEXTEX</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
01682 <font class="keyword">    </font>{
01683       ds &gt;&gt; emr &gt;&gt; szlExtent;
01684     }
<a name="l01688"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a2">01688</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01689 <font class="keyword">    </font>{
01690       ds &lt;&lt; emr &lt;&lt; szlExtent;
01691       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01692     }
<a name="l01696"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a3">01696</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l01702"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a4">01702</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
01703 <font class="keyword">    </font>{
01704       SetViewportExtEx( dc, szlExtent.cx, szlExtent.cy, 0 );
01705     }
01706 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01707 <font class="preprocessor"></font>
01710     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01711 <font class="keyword">    </font>{
01712       printf( <font class="stringliteral">"*SETVIEWPORTEXTEX*\n"</font> );
01713       edit_sizel( <font class="stringliteral">"szlExtent"</font>, szlExtent );
01714     }
01715 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01716   };
01717 
01719 
<a name="l01724"></a><a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html">01724</a>   <font class="keyword">class </font>EMRSCALEVIEWPORTEXTEX : <font class="keyword">public</font> METARECORD, ::EMRSCALEVIEWPORTEXTEX {
01725   <font class="keyword">public</font>:
<a name="l01732"></a><a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a0">01732</a>     <a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a0">EMRSCALEVIEWPORTEXTEX</a> ( LONG x_num, LONG x_den, LONG y_num, LONG y_den )<font class="keyword"></font>
01733 <font class="keyword">    </font>{
01734       emr.iType = EMR_SCALEVIEWPORTEXTEX;
01735       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSCALEVIEWPORTEXTEX );
01736       xNum = x_num;
01737       xDenom = x_den;
01738       yNum = y_num;
01739       yDenom = y_den;
01740     }
<a name="l01745"></a><a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a1">01745</a>     <a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a0">EMRSCALEVIEWPORTEXTEX</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
01746 <font class="keyword">    </font>{
01747       ds &gt;&gt; emr &gt;&gt; xNum &gt;&gt; xDenom &gt;&gt; yNum &gt;&gt; yDenom;
01748     }
<a name="l01752"></a><a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a2">01752</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01753 <font class="keyword">    </font>{
01754       ds &lt;&lt; emr &lt;&lt; xNum &lt;&lt; xDenom &lt;&lt; yNum &lt;&lt; yDenom;
01755       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01756     }
<a name="l01760"></a><a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a3">01760</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l01766"></a><a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a4">01766</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
01767 <font class="keyword">    </font>{
01768       ScaleViewportExtEx( dc, xNum, xDenom, yNum, yDenom, 0 );
01769     }
01770 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01771 <font class="preprocessor"></font>
01774     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01775 <font class="keyword">    </font>{
01776       printf( <font class="stringliteral">"*SCALEVIEWPORTEXTEX*\n"</font> );
01777       printf( <font class="stringliteral">"\txNum\t: %ld\n"</font>, xNum );
01778       printf( <font class="stringliteral">"\txDenom\t: %ld\n"</font>, xDenom );
01779       printf( <font class="stringliteral">"\tyNum\t: %ld\n"</font>, yNum );
01780       printf( <font class="stringliteral">"\tyDenom\t: %ld\n"</font>, yDenom );
01781     }
01782 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01783   };
01784 
01786 
<a name="l01791"></a><a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html">01791</a>   <font class="keyword">class </font>EMRSETWINDOWEXTEX : <font class="keyword">public</font> METARECORD, ::EMRSETWINDOWEXTEX {
01792   <font class="keyword">public</font>:
<a name="l01797"></a><a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a0">01797</a>     <a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a0">EMRSETWINDOWEXTEX</a> ( INT cx, INT cy )<font class="keyword"></font>
01798 <font class="keyword">    </font>{
01799       emr.iType = EMR_SETWINDOWEXTEX;
01800       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETWINDOWEXTEX );
01801       szlExtent.cx = cx;
01802       szlExtent.cy = cy;
01803     }
<a name="l01808"></a><a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a1">01808</a>     <a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a0">EMRSETWINDOWEXTEX</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
01809 <font class="keyword">    </font>{
01810       ds &gt;&gt; emr &gt;&gt; szlExtent;
01811     }
<a name="l01815"></a><a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a2">01815</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01816 <font class="keyword">    </font>{
01817       ds &lt;&lt; emr &lt;&lt; szlExtent;
01818       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01819     }
<a name="l01823"></a><a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a3">01823</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l01829"></a><a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a4">01829</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
01830 <font class="keyword">    </font>{
01831       SetWindowExtEx( dc, szlExtent.cx, szlExtent.cy, 0 );
01832     }
01833 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01834 <font class="preprocessor"></font>
01837     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01838 <font class="keyword">    </font>{
01839       printf( <font class="stringliteral">"*SETWINDOWEXTEX*\n"</font> );
01840       edit_sizel( <font class="stringliteral">"szlExtent"</font>, szlExtent );
01841     }
01842 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01843   };
01844 
01846 
<a name="l01851"></a><a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html">01851</a>   <font class="keyword">class </font>EMRSCALEWINDOWEXTEX : <font class="keyword">public</font> METARECORD, ::EMRSCALEWINDOWEXTEX {
01852   <font class="keyword">public</font>:
<a name="l01859"></a><a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a0">01859</a>     <a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a0">EMRSCALEWINDOWEXTEX</a> ( LONG x_num, LONG x_den, LONG y_num, LONG y_den )<font class="keyword"></font>
01860 <font class="keyword">    </font>{
01861       emr.iType = EMR_SCALEWINDOWEXTEX;
01862       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSCALEWINDOWEXTEX );
01863       xNum = x_num;
01864       xDenom = x_den;
01865       yNum = y_num;
01866       yDenom = y_den;
01867     }
<a name="l01872"></a><a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a1">01872</a>     <a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a0">EMRSCALEWINDOWEXTEX</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
01873 <font class="keyword">    </font>{
01874       ds &gt;&gt; emr &gt;&gt; xNum &gt;&gt; xDenom &gt;&gt; yNum &gt;&gt; yDenom;
01875     }
<a name="l01879"></a><a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a2">01879</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01880 <font class="keyword">    </font>{
01881       ds &lt;&lt; emr &lt;&lt; xNum &lt;&lt; xDenom &lt;&lt; yNum &lt;&lt; yDenom;
01882       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01883     }
<a name="l01887"></a><a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a3">01887</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l01893"></a><a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a4">01893</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
01894 <font class="keyword">    </font>{
01895       ScaleWindowExtEx( dc, xNum, xDenom, yNum, yDenom, 0 );
01896     }
01897 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01898 <font class="preprocessor"></font>
01901     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01902 <font class="keyword">    </font>{
01903       printf( <font class="stringliteral">"*SCALEWINDOWEXTEX*\n"</font> );
01904       printf( <font class="stringliteral">"\txNum\t: %ld\n"</font>, xNum );
01905       printf( <font class="stringliteral">"\txDenom\t: %ld\n"</font>, xDenom );
01906       printf( <font class="stringliteral">"\tyNum\t: %ld\n"</font>, yNum );
01907       printf( <font class="stringliteral">"\tyDenom\t: %ld\n"</font>, yDenom );
01908     }
01909 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01910   };
01911 
01913 
<a name="l01919"></a><a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html">01919</a>   <font class="keyword">class </font>EMRMODIFYWORLDTRANSFORM : <font class="keyword">public</font> METARECORD, ::EMRMODIFYWORLDTRANSFORM {
01920   <font class="keyword">public</font>:
<a name="l01926"></a><a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a0">01926</a>     <a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a0">EMRMODIFYWORLDTRANSFORM</a> ( <font class="keyword">const</font> XFORM* transform, DWORD mode )<font class="keyword"></font>
01927 <font class="keyword">    </font>{
01928       emr.iType = EMR_MODIFYWORLDTRANSFORM;
01929       emr.nSize = <font class="keyword">sizeof</font>( ::EMRMODIFYWORLDTRANSFORM );
01930       xform = *transform;
01931       iMode = mode;
01932     }
<a name="l01937"></a><a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a1">01937</a>     <a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a0">EMRMODIFYWORLDTRANSFORM</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
01938 <font class="keyword">    </font>{
01939       ds &gt;&gt; emr &gt;&gt; xform &gt;&gt; iMode;
01940     }
<a name="l01944"></a><a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a2">01944</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01945 <font class="keyword">    </font>{
01946       ds &lt;&lt; emr &lt;&lt; xform &lt;&lt; iMode;
01947       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01948     }
<a name="l01952"></a><a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a3">01952</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l01958"></a><a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a4">01958</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
01959 <font class="keyword">    </font>{
01960       ModifyWorldTransform( dc, &amp;xform, iMode );
01961     }
01962 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01963 <font class="preprocessor"></font>
01966     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01967 <font class="keyword">    </font>{
01968       printf( <font class="stringliteral">"*MODIFYWORLDTRANSFORM*\n"</font> );
01969       edit_xform( <font class="stringliteral">"xform"</font>, xform );
01970       printf( <font class="stringliteral">"\tiMode\t\t: "</font> );
01971       <font class="keywordflow">switch</font> ( iMode ) {
01972       <font class="keywordflow">case</font> MWT_IDENTITY: printf( <font class="stringliteral">"MWT_IDENTITY\n"</font> ); <font class="keywordflow">break</font>;
01973       <font class="keywordflow">case</font> MWT_LEFTMULTIPLY: printf( <font class="stringliteral">"MWT_LEFTMULTIPLY\n"</font> ); <font class="keywordflow">break</font>;
01974       <font class="keywordflow">case</font> MWT_RIGHTMULTIPLY: printf( <font class="stringliteral">"MWT_RIGHTMULTIPLY\n"</font> ); <font class="keywordflow">break</font>;
01975       <font class="keywordflow">default</font>: printf( <font class="stringliteral">"unknown(%ld)\n"</font>, iMode );
01976       }
01977     }
01978 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01979   };
01980 
01982 
<a name="l01988"></a><a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html">01988</a>   <font class="keyword">class </font>EMRSETWORLDTRANSFORM : <font class="keyword">public</font> METARECORD, ::EMRSETWORLDTRANSFORM {
01989   <font class="keyword">public</font>:
<a name="l01993"></a><a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a0">01993</a>     <a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a0">EMRSETWORLDTRANSFORM</a> ( <font class="keyword">const</font> XFORM* transform )<font class="keyword"></font>
01994 <font class="keyword">    </font>{
01995       emr.iType = EMR_SETWORLDTRANSFORM;
01996       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETWORLDTRANSFORM );
01997       xform = *transform;
01998     }
<a name="l02003"></a><a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a1">02003</a>     <a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a0">EMRSETWORLDTRANSFORM</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02004 <font class="keyword">    </font>{
02005       ds &gt;&gt; emr &gt;&gt; xform;
02006     }
<a name="l02010"></a><a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a2">02010</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02011 <font class="keyword">    </font>{
02012       ds &lt;&lt; emr &lt;&lt; xform;
02013       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02014     }
<a name="l02018"></a><a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a3">02018</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02024"></a><a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a4">02024</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02025 <font class="keyword">    </font>{
02026       SetWorldTransform( dc, &amp;xform );
02027     }
02028 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02029 <font class="preprocessor"></font>
02032     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02033 <font class="keyword">    </font>{
02034       printf( <font class="stringliteral">"*SETWORLDTRANSFORM*\n"</font> );
02035       edit_xform( <font class="stringliteral">"xform"</font>, xform );
02036     }
02037 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02038   };
02039 
02041 
<a name="l02044"></a><a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html">02044</a>   <font class="keyword">class </font>EMRSETTEXTALIGN : <font class="keyword">public</font> METARECORD, ::EMRSETTEXTALIGN {
02045   <font class="keyword">public</font>:
<a name="l02049"></a><a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a0">02049</a>     <a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a0">EMRSETTEXTALIGN</a> ( UINT mode )<font class="keyword"></font>
02050 <font class="keyword">    </font>{
02051       emr.iType = EMR_SETTEXTALIGN;
02052       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETTEXTALIGN );
02053       iMode = mode;
02054     }
<a name="l02059"></a><a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a1">02059</a>     <a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a0">EMRSETTEXTALIGN</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02060 <font class="keyword">    </font>{
02061       ds &gt;&gt; emr &gt;&gt; iMode;
02062     }
<a name="l02066"></a><a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a2">02066</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02067 <font class="keyword">    </font>{
02068       ds &lt;&lt; emr &lt;&lt; iMode;
02069       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02070     }
<a name="l02074"></a><a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a3">02074</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02080"></a><a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a4">02080</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02081 <font class="keyword">    </font>{
02082       SetTextAlign( dc, iMode );
02083     }
02084 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02085 <font class="preprocessor"></font>
02088     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02089 <font class="keyword">    </font>{
02090       <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> known_bits = TA_BASELINE+TA_CENTER+TA_UPDATECP+TA_RTLREADING;
02091       <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> unknown_bits = ~known_bits;
02092 
02093       printf( <font class="stringliteral">"*SETTEXTALIGN*\n"</font> );
02094       printf( <font class="stringliteral">"\tiMode\t: "</font> );
02095       <font class="keywordflow">if</font> ( iMode &amp; TA_UPDATECP )
02096         printf( <font class="stringliteral">"TA_UPDATECP"</font> );
02097       <font class="keywordflow">else</font>
02098         printf( <font class="stringliteral">"TA_NOUPDATECP"</font> );
02099       <font class="keywordflow">if</font> ( iMode &amp; TA_CENTER )
02100         printf( <font class="stringliteral">" | TA_CENTER"</font> );
02101       <font class="keywordflow">else</font> <font class="keywordflow">if</font> ( iMode &amp; TA_RIGHT )
02102         printf( <font class="stringliteral">" | TA_RIGHT"</font> );
02103       <font class="keywordflow">else</font>
02104         printf( <font class="stringliteral">" | TA_LEFT"</font> );
02105       <font class="keywordflow">if</font> ( iMode &amp; TA_BASELINE )
02106         printf( <font class="stringliteral">" | TA_BASELINE"</font> );
02107       <font class="keywordflow">else</font> <font class="keywordflow">if</font> ( iMode &amp; TA_BOTTOM )
02108         printf( <font class="stringliteral">" | TA_BOTTOM"</font> );
02109       <font class="keywordflow">else</font>
02110         printf( <font class="stringliteral">" | TA_TOP"</font> );
02111       <font class="keywordflow">if</font> ( iMode &amp; TA_RTLREADING )
02112         printf( <font class="stringliteral">" | TA_RTLREADING"</font> );
02113       <font class="keywordflow">if</font> ( iMode &amp; unknown_bits )
02114         printf( <font class="stringliteral">" | unknown bits(0x%lx)"</font>, iMode &amp; unknown_bits );
02115       printf( <font class="stringliteral">"\n"</font> );
02116     }
02117 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02118   };
02119 
02121 
<a name="l02124"></a><a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html">02124</a>   <font class="keyword">class </font>EMRSETTEXTCOLOR : <font class="keyword">public</font> METARECORD, ::EMRSETTEXTCOLOR {
02125   <font class="keyword">public</font>:
<a name="l02129"></a><a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a0">02129</a>     <a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a0">EMRSETTEXTCOLOR</a> ( COLORREF color )<font class="keyword"></font>
02130 <font class="keyword">    </font>{
02131       emr.iType = EMR_SETTEXTCOLOR;
02132       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETTEXTCOLOR );
02133       crColor = color;
02134     }
<a name="l02139"></a><a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a1">02139</a>     <a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a0">EMRSETTEXTCOLOR</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02140 <font class="keyword">    </font>{
02141       ds &gt;&gt; emr &gt;&gt; crColor;
02142     }
<a name="l02146"></a><a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a2">02146</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02147 <font class="keyword">    </font>{
02148       ds &lt;&lt; emr &lt;&lt; crColor;
02149       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02150     }
<a name="l02154"></a><a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a3">02154</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02160"></a><a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a4">02160</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02161 <font class="keyword">    </font>{
02162       SetTextColor( dc, crColor );
02163     }
02164 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02165 <font class="preprocessor"></font>
02168     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02169 <font class="keyword">    </font>{
02170       printf( <font class="stringliteral">"*SETTEXTCOLOR*\n"</font> );
02171       edit_color( <font class="stringliteral">"crColor"</font>, crColor );
02172     }
02173 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02174   };
02175 
02177 
<a name="l02180"></a><a class="code" href="classEMF_1_1EMRSETBKCOLOR.html">02180</a>   <font class="keyword">class </font>EMRSETBKCOLOR : <font class="keyword">public</font> METARECORD, ::EMRSETBKCOLOR {
02181   <font class="keyword">public</font>:
<a name="l02185"></a><a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a0">02185</a>     <a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a0">EMRSETBKCOLOR</a> ( COLORREF color )<font class="keyword"></font>
02186 <font class="keyword">    </font>{
02187       emr.iType = EMR_SETBKCOLOR;
02188       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETBKCOLOR );
02189       crColor = color;
02190     }
<a name="l02195"></a><a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a1">02195</a>     <a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a0">EMRSETBKCOLOR</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02196 <font class="keyword">    </font>{
02197       ds &gt;&gt; emr &gt;&gt; crColor;
02198     }
<a name="l02202"></a><a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a2">02202</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02203 <font class="keyword">    </font>{
02204       ds &lt;&lt; emr &lt;&lt; crColor;
02205       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02206     }
<a name="l02210"></a><a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a3">02210</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02216"></a><a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a4">02216</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02217 <font class="keyword">    </font>{
02218       SetBkColor( dc, crColor );
02219     }
02220 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02221 <font class="preprocessor"></font>
02224     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02225 <font class="keyword">    </font>{
02226       printf( <font class="stringliteral">"*SETBKCOLOR*\n"</font> );
02227       edit_color( <font class="stringliteral">"crColor"</font>, crColor );
02228     }
02229 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02230   };
02231 
02233 
<a name="l02237"></a><a class="code" href="classEMF_1_1EMRSETBKMODE.html">02237</a>   <font class="keyword">class </font>EMRSETBKMODE : <font class="keyword">public</font> METARECORD, ::EMRSETBKMODE {
02238   <font class="keyword">public</font>:
<a name="l02242"></a><a class="code" href="classEMF_1_1EMRSETBKMODE.html#a0">02242</a>     <a class="code" href="classEMF_1_1EMRSETBKMODE.html#a0">EMRSETBKMODE</a> ( DWORD mode )<font class="keyword"></font>
02243 <font class="keyword">    </font>{
02244       emr.iType = EMR_SETBKMODE;
02245       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETBKMODE );
02246       iMode = mode;
02247     }
<a name="l02252"></a><a class="code" href="classEMF_1_1EMRSETBKMODE.html#a1">02252</a>     <a class="code" href="classEMF_1_1EMRSETBKMODE.html#a0">EMRSETBKMODE</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02253 <font class="keyword">    </font>{
02254       ds &gt;&gt; emr &gt;&gt; iMode;
02255     }
<a name="l02259"></a><a class="code" href="classEMF_1_1EMRSETBKMODE.html#a2">02259</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETBKMODE.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02260 <font class="keyword">    </font>{
02261       ds &lt;&lt; emr &lt;&lt; iMode;
02262       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02263     }
<a name="l02267"></a><a class="code" href="classEMF_1_1EMRSETBKMODE.html#a3">02267</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETBKMODE.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02273"></a><a class="code" href="classEMF_1_1EMRSETBKMODE.html#a4">02273</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETBKMODE.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02274 <font class="keyword">    </font>{
02275       SetBkMode( dc, iMode );
02276     }
02277 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02278 <font class="preprocessor"></font>
02281     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02282 <font class="keyword">    </font>{
02283       printf( <font class="stringliteral">"*SETBKMODE*\n"</font> );
02284       printf( <font class="stringliteral">"\tiMode\t: "</font> );
02285       <font class="keywordflow">switch</font> ( iMode ) {
02286       <font class="keywordflow">case</font> TRANSPARENT: printf( <font class="stringliteral">"TRANSPARENT\n"</font> ); <font class="keywordflow">break</font>;
02287       <font class="keywordflow">case</font> OPAQUE: printf( <font class="stringliteral">"OPAQUE\n"</font> ); <font class="keywordflow">break</font>;
02288       <font class="keywordflow">default</font>: printf( <font class="stringliteral">"unknown(%ld)\n"</font>, iMode );
02289       }
02290     }
02291 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02292   };
02293 
02295 
<a name="l02298"></a><a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html">02298</a>   <font class="keyword">class </font>EMRSETPOLYFILLMODE : <font class="keyword">public</font> METARECORD, ::EMRSETPOLYFILLMODE {
02299   <font class="keyword">public</font>:
<a name="l02303"></a><a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a0">02303</a>     <a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a0">EMRSETPOLYFILLMODE</a> ( DWORD mode )<font class="keyword"></font>
02304 <font class="keyword">    </font>{
02305       emr.iType = EMR_SETPOLYFILLMODE;
02306       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETPOLYFILLMODE );
02307       iMode = mode;
02308     }
<a name="l02313"></a><a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a1">02313</a>     <a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a0">EMRSETPOLYFILLMODE</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02314 <font class="keyword">    </font>{
02315       ds &gt;&gt; emr &gt;&gt; iMode;
02316     }
<a name="l02320"></a><a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a2">02320</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02321 <font class="keyword">    </font>{
02322       ds &lt;&lt; emr &lt;&lt; iMode;
02323       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02324     }
<a name="l02328"></a><a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a3">02328</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02334"></a><a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a4">02334</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02335 <font class="keyword">    </font>{
02336       SetPolyFillMode( dc, iMode );
02337     }
02338 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02339 <font class="preprocessor"></font>
02342     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02343 <font class="keyword">    </font>{
02344       printf( <font class="stringliteral">"*SETPOLYFILLMODE*\n"</font> );
02345       printf( <font class="stringliteral">"\tiMode: "</font> );
02346       <font class="keywordflow">switch</font> ( iMode ) {
02347       <font class="keywordflow">case</font> ALTERNATE: printf( <font class="stringliteral">"ALTERNATE\n"</font> ); <font class="keywordflow">break</font>;
02348       <font class="keywordflow">case</font> WINDING: printf( <font class="stringliteral">"WINDING\n"</font> ); <font class="keywordflow">break</font>;
02349       <font class="keywordflow">default</font>: printf( <font class="stringliteral">"unknown(%ld)\n"</font>, iMode );
02350       }
02351     }
02352 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02353   };
02354 
02356 
<a name="l02360"></a><a class="code" href="classEMF_1_1EMRSETMAPMODE.html">02360</a>   <font class="keyword">class </font>EMRSETMAPMODE : <font class="keyword">public</font> METARECORD, ::EMRSETMAPMODE {
02361   <font class="keyword">public</font>:
<a name="l02365"></a><a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a0">02365</a>     <a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a0">EMRSETMAPMODE</a> ( DWORD mode )<font class="keyword"></font>
02366 <font class="keyword">    </font>{
02367       emr.iType = EMR_SETMAPMODE;
02368       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETMAPMODE );
02369       iMode = mode;
02370     }
<a name="l02375"></a><a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a1">02375</a>     <a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a0">EMRSETMAPMODE</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02376 <font class="keyword">    </font>{
02377       ds &gt;&gt; emr &gt;&gt; iMode;
02378     }
<a name="l02382"></a><a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a2">02382</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02383 <font class="keyword">    </font>{
02384       ds &lt;&lt; emr &lt;&lt; iMode;
02385       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02386     }
<a name="l02390"></a><a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a3">02390</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02396"></a><a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a4">02396</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02397 <font class="keyword">    </font>{
02398       SetMapMode( dc, iMode );
02399     }
02400 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02401 <font class="preprocessor"></font>
02404     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02405 <font class="keyword">    </font>{
02406       printf( <font class="stringliteral">"*SETMAPMODE*\n"</font> );
02407       printf( <font class="stringliteral">"\tiMode\t: "</font> );
02408       <font class="keywordflow">switch</font> ( iMode ) {
02409       <font class="keywordflow">case</font> MM_TEXT: printf( <font class="stringliteral">"MM_TEXT\n"</font> ); <font class="keywordflow">break</font>;
02410       <font class="keywordflow">case</font> MM_LOMETRIC: printf( <font class="stringliteral">"MM_LOMETRIC\n"</font> ); <font class="keywordflow">break</font>;
02411       <font class="keywordflow">case</font> MM_HIMETRIC: printf( <font class="stringliteral">"MM_HIMETRIC\n"</font> ); <font class="keywordflow">break</font>;
02412       <font class="keywordflow">case</font> MM_LOENGLISH: printf( <font class="stringliteral">"MM_LOENGLISH\n"</font> ); <font class="keywordflow">break</font>;
02413       <font class="keywordflow">case</font> MM_HIENGLISH: printf( <font class="stringliteral">"MM_HIENGLISH\n"</font> ); <font class="keywordflow">break</font>;
02414       <font class="keywordflow">case</font> MM_TWIPS: printf( <font class="stringliteral">"MM_TWIPS\n"</font> ); <font class="keywordflow">break</font>;
02415       <font class="keywordflow">case</font> MM_ISOTROPIC: printf( <font class="stringliteral">"MM_ISOTROPIC\n"</font> ); <font class="keywordflow">break</font>;
02416       <font class="keywordflow">case</font> MM_ANISOTROPIC: printf( <font class="stringliteral">"MM_ANISOTROPIC\n"</font> ); <font class="keywordflow">break</font>;
02417       <font class="keywordflow">default</font>: printf( <font class="stringliteral">"unknown(%ld)\n"</font>, iMode );
02418       }
02419     }
02420 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02421   };
02422 
02424 
<a name="l02427"></a><a class="code" href="classEMF_1_1EMRSELECTOBJECT.html">02427</a>   <font class="keyword">class </font>EMRSELECTOBJECT : <font class="keyword">public</font> METARECORD, ::EMRSELECTOBJECT {
02428   <font class="keyword">public</font>:
<a name="l02432"></a><a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a0">02432</a>     <a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a0">EMRSELECTOBJECT</a> ( HGDIOBJ object )<font class="keyword"></font>
02433 <font class="keyword">    </font>{
02434       emr.iType = EMR_SELECTOBJECT;
02435       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSELECTOBJECT );
02436       ihObject = object;
02437     }
<a name="l02442"></a><a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a1">02442</a>     <a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a0">EMRSELECTOBJECT</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02443 <font class="keyword">    </font>{
02444       ds &gt;&gt; emr &gt;&gt; ihObject;
02445     }
<a name="l02449"></a><a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a2">02449</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02450 <font class="keyword">    </font>{
02451       ds &lt;&lt; emr &lt;&lt; ihObject;
02452       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02453     }
<a name="l02457"></a><a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a3">02457</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
02463     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a4">execute</a> ( METAFILEDEVICECONTEXT* source, HDC dc ) <font class="keyword">const</font>;
02464 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02465 <font class="preprocessor"></font>
02468     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02469 <font class="keyword">    </font>{
02470       printf( <font class="stringliteral">"*SELECTOBJECT*\n"</font> );
02471       printf( <font class="stringliteral">"\tihObject\t: 0x%lx\n"</font>, ihObject );
02472     }
02473 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02474   };
02475 
02477 
<a name="l02480"></a><a class="code" href="classEMF_1_1EMRDELETEOBJECT.html">02480</a>   <font class="keyword">class </font>EMRDELETEOBJECT : <font class="keyword">public</font> METARECORD, ::EMRDELETEOBJECT {
02481   <font class="keyword">public</font>:
<a name="l02485"></a><a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a0">02485</a>     <a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a0">EMRDELETEOBJECT</a> ( HGDIOBJ object )<font class="keyword"></font>
02486 <font class="keyword">    </font>{
02487       emr.iType = EMR_DELETEOBJECT;
02488       emr.nSize = <font class="keyword">sizeof</font>( ::EMRDELETEOBJECT );
02489       ihObject = object;
02490     }
<a name="l02495"></a><a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a1">02495</a>     <a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a0">EMRDELETEOBJECT</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02496 <font class="keyword">    </font>{
02497       ds &gt;&gt; emr &gt;&gt; ihObject;
02498     }
<a name="l02502"></a><a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a2">02502</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02503 <font class="keyword">    </font>{
02504       ds &lt;&lt; emr &lt;&lt; ihObject;
02505       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02506     }
<a name="l02510"></a><a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a3">02510</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
02516     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a4">execute</a> ( METAFILEDEVICECONTEXT* source, HDC dc ) <font class="keyword">const</font>;
02517 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02518 <font class="preprocessor"></font>
02521     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02522 <font class="keyword">    </font>{
02523       printf( <font class="stringliteral">"*DELETEOBJECT*\n"</font> );
02524       printf( <font class="stringliteral">"\tihObject\t: 0x%lx\n"</font>, ihObject );
02525     }
02526 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02527   };
02528 
02530 
<a name="l02533"></a><a class="code" href="classEMF_1_1EMRMOVETOEX.html">02533</a>   <font class="keyword">class </font>EMRMOVETOEX : <font class="keyword">public</font> METARECORD, ::EMRMOVETOEX {
02534   <font class="keyword">public</font>:
<a name="l02539"></a><a class="code" href="classEMF_1_1EMRMOVETOEX.html#a0">02539</a>     <a class="code" href="classEMF_1_1EMRMOVETOEX.html#a0">EMRMOVETOEX</a> ( INT x, INT y )<font class="keyword"></font>
02540 <font class="keyword">    </font>{
02541       emr.iType = EMR_MOVETOEX;
02542       emr.nSize = <font class="keyword">sizeof</font>( ::EMRMOVETOEX );
02543       ptl.x = x;
02544       ptl.y = y;
02545     }
<a name="l02550"></a><a class="code" href="classEMF_1_1EMRMOVETOEX.html#a1">02550</a>     <a class="code" href="classEMF_1_1EMRMOVETOEX.html#a0">EMRMOVETOEX</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02551 <font class="keyword">    </font>{
02552       ds &gt;&gt; emr &gt;&gt; ptl;
02553     }
<a name="l02557"></a><a class="code" href="classEMF_1_1EMRMOVETOEX.html#a2">02557</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRMOVETOEX.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02558 <font class="keyword">    </font>{
02559       ds &lt;&lt; emr &lt;&lt; ptl;
02560       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02561     }
<a name="l02565"></a><a class="code" href="classEMF_1_1EMRMOVETOEX.html#a3">02565</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRMOVETOEX.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02571"></a><a class="code" href="classEMF_1_1EMRMOVETOEX.html#a4">02571</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRMOVETOEX.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02572 <font class="keyword">    </font>{
02573       MoveToEx( dc,  ptl.x, ptl.y, 0 );
02574     }
02575 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02576 <font class="preprocessor"></font>
02579     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02580 <font class="keyword">    </font>{
02581       printf( <font class="stringliteral">"*MOVETOEX*\n"</font> );
02582       edit_pointl( <font class="stringliteral">"ptl"</font>, ptl );
02583     }
02584 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02585   };
02586 
02588 
<a name="l02591"></a><a class="code" href="classEMF_1_1EMRLINETO.html">02591</a>   <font class="keyword">class </font>EMRLINETO : <font class="keyword">public</font> METARECORD, ::EMRLINETO {
02592   <font class="keyword">public</font>:
<a name="l02597"></a><a class="code" href="classEMF_1_1EMRLINETO.html#a0">02597</a>     <a class="code" href="classEMF_1_1EMRLINETO.html#a0">EMRLINETO</a> ( INT x, INT y )<font class="keyword"></font>
02598 <font class="keyword">    </font>{
02599       emr.iType = EMR_LINETO;
02600       emr.nSize = <font class="keyword">sizeof</font>( ::EMRLINETO );
02601       ptl.x = x;
02602       ptl.y = y;
02603     }
<a name="l02608"></a><a class="code" href="classEMF_1_1EMRLINETO.html#a1">02608</a>     <a class="code" href="classEMF_1_1EMRLINETO.html#a0">EMRLINETO</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02609 <font class="keyword">    </font>{
02610       ds &gt;&gt; emr &gt;&gt; ptl;
02611     }
<a name="l02615"></a><a class="code" href="classEMF_1_1EMRLINETO.html#a2">02615</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRLINETO.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02616 <font class="keyword">    </font>{
02617       ds &lt;&lt; emr &lt;&lt; ptl;
02618       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02619     }
<a name="l02623"></a><a class="code" href="classEMF_1_1EMRLINETO.html#a3">02623</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRLINETO.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02629"></a><a class="code" href="classEMF_1_1EMRLINETO.html#a4">02629</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRLINETO.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02630 <font class="keyword">    </font>{
02631       LineTo( dc,  ptl.x, ptl.y );
02632     }
02633 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02634 <font class="preprocessor"></font>
02637     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02638 <font class="keyword">    </font>{
02639       printf( <font class="stringliteral">"*LINETO*\n"</font> );
02640       edit_pointl( <font class="stringliteral">"ptl"</font>, ptl );
02641     }
02642 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02643   };
02644 
02646 
<a name="l02649"></a><a class="code" href="classEMF_1_1EMRARC.html">02649</a>   <font class="keyword">class </font>EMRARC : <font class="keyword">public</font> METARECORD, ::EMRARC {
02650   <font class="keyword">public</font>:
<a name="l02662"></a><a class="code" href="classEMF_1_1EMRARC.html#a0">02662</a>     <a class="code" href="classEMF_1_1EMRARC.html#a0">EMRARC</a> ( INT left, INT top, INT right, INT bottom, INT xstart,
02663              INT ystart, INT xend, INT yend )<font class="keyword"></font>
02664 <font class="keyword">    </font>{
02665       emr.iType = EMR_ARC;
02666       emr.nSize = <font class="keyword">sizeof</font>( ::EMRARC );
02667       rclBox.left = left;
02668       rclBox.right = right;
02669       rclBox.bottom = bottom;
02670       rclBox.top = top;
02671       ptlStart.x = xstart;
02672       ptlStart.y = ystart;
02673       ptlEnd.x = xend;
02674       ptlEnd.y = yend;
02675     }
<a name="l02680"></a><a class="code" href="classEMF_1_1EMRARC.html#a1">02680</a>     <a class="code" href="classEMF_1_1EMRARC.html#a0">EMRARC</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02681 <font class="keyword">    </font>{
02682       ds &gt;&gt; emr &gt;&gt; rclBox &gt;&gt; ptlStart &gt;&gt; ptlEnd;
02683     }
<a name="l02687"></a><a class="code" href="classEMF_1_1EMRARC.html#a2">02687</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRARC.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02688 <font class="keyword">    </font>{
02689       ds &lt;&lt; emr &lt;&lt; rclBox &lt;&lt; ptlStart &lt;&lt; ptlEnd;
02690       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02691     }
<a name="l02695"></a><a class="code" href="classEMF_1_1EMRARC.html#a3">02695</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRARC.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02701"></a><a class="code" href="classEMF_1_1EMRARC.html#a4">02701</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRARC.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02702 <font class="keyword">    </font>{
02703       Arc( dc, rclBox.left, rclBox.top, rclBox.right, rclBox.bottom,
02704            ptlStart.x, ptlStart.y, ptlEnd.x, ptlEnd.y );
02705     }
02706 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02707 <font class="preprocessor"></font>
02710     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02711 <font class="keyword">    </font>{
02712       printf( <font class="stringliteral">"*ARC*\n"</font> );
02713       edit_rectl( <font class="stringliteral">"rclBox\t"</font>, rclBox );
02714       edit_pointl( <font class="stringliteral">"ptlStart"</font>, ptlStart );
02715       edit_pointl( <font class="stringliteral">"ptlEnd\t"</font>, ptlEnd );
02716     }
02717 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02718   };
02719 
02721 
<a name="l02724"></a><a class="code" href="classEMF_1_1EMRARCTO.html">02724</a>   <font class="keyword">class </font>EMRARCTO : <font class="keyword">public</font> METARECORD, ::EMRARCTO {
02725   <font class="keyword">public</font>:
<a name="l02737"></a><a class="code" href="classEMF_1_1EMRARCTO.html#a0">02737</a>     <a class="code" href="classEMF_1_1EMRARCTO.html#a0">EMRARCTO</a> ( INT left, INT top, INT right, INT bottom, INT xstart,
02738              INT ystart, INT xend, INT yend )<font class="keyword"></font>
02739 <font class="keyword">    </font>{
02740       emr.iType = EMR_ARCTO;
02741       emr.nSize = <font class="keyword">sizeof</font>( ::EMRARCTO );
02742       rclBox.left = left;
02743       rclBox.right = right;
02744       rclBox.bottom = bottom;
02745       rclBox.top = top;
02746       ptlStart.x = xstart;
02747       ptlStart.y = ystart;
02748       ptlEnd.x = xend;
02749       ptlEnd.y = yend;
02750     }
<a name="l02755"></a><a class="code" href="classEMF_1_1EMRARCTO.html#a1">02755</a>     <a class="code" href="classEMF_1_1EMRARCTO.html#a0">EMRARCTO</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02756 <font class="keyword">    </font>{
02757       ds &gt;&gt; emr &gt;&gt; rclBox &gt;&gt; ptlStart &gt;&gt; ptlEnd;
02758     }
<a name="l02762"></a><a class="code" href="classEMF_1_1EMRARCTO.html#a2">02762</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRARCTO.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02763 <font class="keyword">    </font>{
02764       ds &lt;&lt; emr &lt;&lt; rclBox &lt;&lt; ptlStart &lt;&lt; ptlEnd;
02765       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02766     }
<a name="l02770"></a><a class="code" href="classEMF_1_1EMRARCTO.html#a3">02770</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRARCTO.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02776"></a><a class="code" href="classEMF_1_1EMRARCTO.html#a4">02776</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRARCTO.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02777 <font class="keyword">    </font>{
02778       ArcTo( dc, rclBox.left, rclBox.top, rclBox.right, rclBox.bottom,
02779              ptlStart.x, ptlStart.y, ptlEnd.x, ptlEnd.y );
02780     }
02781 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02782 <font class="preprocessor"></font>
02785     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02786 <font class="keyword">    </font>{
02787       printf( <font class="stringliteral">"*ARCTO*\n"</font> );
02788       edit_rectl( <font class="stringliteral">"rclBox\t"</font>, rclBox );
02789       edit_pointl( <font class="stringliteral">"ptlStart"</font>, ptlStart );
02790       edit_pointl( <font class="stringliteral">"ptlEnd\t"</font>, ptlEnd );
02791     }
02792 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02793   };
02794 
02796 
<a name="l02799"></a><a class="code" href="classEMF_1_1EMRRECTANGLE.html">02799</a>   <font class="keyword">class </font>EMRRECTANGLE : <font class="keyword">public</font> METARECORD, ::EMRRECTANGLE {
02800   <font class="keyword">public</font>:
<a name="l02807"></a><a class="code" href="classEMF_1_1EMRRECTANGLE.html#a0">02807</a>     <a class="code" href="classEMF_1_1EMRRECTANGLE.html#a0">EMRRECTANGLE</a> ( INT left, INT top, INT right, INT bottom )<font class="keyword"></font>
02808 <font class="keyword">    </font>{
02809       emr.iType = EMR_RECTANGLE;
02810       emr.nSize = <font class="keyword">sizeof</font>( ::EMRRECTANGLE );
02811       rclBox.left = left;
02812       rclBox.right = right;
02813       rclBox.bottom = bottom;
02814       rclBox.top = top;
02815     }
<a name="l02820"></a><a class="code" href="classEMF_1_1EMRRECTANGLE.html#a1">02820</a>     <a class="code" href="classEMF_1_1EMRRECTANGLE.html#a0">EMRRECTANGLE</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02821 <font class="keyword">    </font>{
02822       ds &gt;&gt; emr &gt;&gt; rclBox;
02823     }
<a name="l02827"></a><a class="code" href="classEMF_1_1EMRRECTANGLE.html#a2">02827</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRRECTANGLE.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02828 <font class="keyword">    </font>{
02829       ds &lt;&lt; emr &lt;&lt; rclBox;
02830       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02831     }
<a name="l02835"></a><a class="code" href="classEMF_1_1EMRRECTANGLE.html#a3">02835</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRRECTANGLE.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02841"></a><a class="code" href="classEMF_1_1EMRRECTANGLE.html#a4">02841</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRRECTANGLE.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02842 <font class="keyword">    </font>{
02843       Rectangle( dc, rclBox.left, rclBox.top, rclBox.right, rclBox.bottom );
02844     }
02845 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02846 <font class="preprocessor"></font>
02849     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02850 <font class="keyword">    </font>{
02851       printf( <font class="stringliteral">"*RECTANGLE*\n"</font> );
02852       edit_rectl( <font class="stringliteral">"rclBox"</font>, rclBox );
02853     }
02854 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02855   };
02856 
02858 
<a name="l02861"></a><a class="code" href="classEMF_1_1EMRELLIPSE.html">02861</a>   <font class="keyword">class </font>EMRELLIPSE : <font class="keyword">public</font> METARECORD, ::EMRELLIPSE {
02862   <font class="keyword">public</font>:
<a name="l02870"></a><a class="code" href="classEMF_1_1EMRELLIPSE.html#a0">02870</a>     <a class="code" href="classEMF_1_1EMRELLIPSE.html#a0">EMRELLIPSE</a> ( INT left, INT top, INT right, INT bottom )<font class="keyword"></font>
02871 <font class="keyword">    </font>{
02872       emr.iType = EMR_ELLIPSE;
02873       emr.nSize = <font class="keyword">sizeof</font>( ::EMRELLIPSE );
02874       rclBox.left = left;
02875       rclBox.right = right;
02876       rclBox.bottom = bottom;
02877       rclBox.top = top;
02878     }
<a name="l02883"></a><a class="code" href="classEMF_1_1EMRELLIPSE.html#a1">02883</a>     <a class="code" href="classEMF_1_1EMRELLIPSE.html#a0">EMRELLIPSE</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02884 <font class="keyword">    </font>{
02885       ds &gt;&gt; emr &gt;&gt; rclBox;
02886     }
<a name="l02890"></a><a class="code" href="classEMF_1_1EMRELLIPSE.html#a2">02890</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRELLIPSE.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02891 <font class="keyword">    </font>{
02892       ds &lt;&lt; emr &lt;&lt; rclBox;
02893       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02894     }
<a name="l02898"></a><a class="code" href="classEMF_1_1EMRELLIPSE.html#a3">02898</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRELLIPSE.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02904"></a><a class="code" href="classEMF_1_1EMRELLIPSE.html#a4">02904</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRELLIPSE.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02905 <font class="keyword">    </font>{
02906       Ellipse( dc, rclBox.left, rclBox.top, rclBox.right, rclBox.bottom );
02907     }
02908 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02909 <font class="preprocessor"></font>
02912     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02913 <font class="keyword">    </font>{
02914       printf( <font class="stringliteral">"*ELLIPSE*\n"</font> );
02915       edit_rectl( <font class="stringliteral">"rclBox"</font>, rclBox );
02916     }
02917 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02918   };
02919 
02921 
<a name="l02924"></a><a class="code" href="classEMF_1_1EMRPOLYLINE.html">02924</a>   <font class="keyword">class </font>EMRPOLYLINE : <font class="keyword">public</font> METARECORD, ::EMRPOLYLINE {
02925     POINTL* lpoints;
02926   <font class="keyword">public</font>:
<a name="l02932"></a><a class="code" href="classEMF_1_1EMRPOLYLINE.html#a0">02932</a>     <a class="code" href="classEMF_1_1EMRPOLYLINE.html#a0">EMRPOLYLINE</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
02933 <font class="keyword">    </font>{
02934       cptl = n;
02935       aptl[0].x = 0;            <font class="comment">// Really unused</font>
02936       aptl[0].y = 0;
02937 
02938       emr.iType = EMR_POLYLINE;
02939       <font class="comment">// The (cptl - 1) below is to account for aptl, which isn't written out</font>
02940       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYLINE ) + <font class="keyword">sizeof</font>( POINTL ) * ( cptl - 1);
02941 
02942       lpoints = <font class="keyword">new</font> POINTL[cptl];
02943 
02944       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
02945         lpoints[i].x = points[i].x;
02946         lpoints[i].y = points[i].y;
02947       }
02948 
02949       rclBounds = *bounds;
02950     }
<a name="l02954"></a><a class="code" href="classEMF_1_1EMRPOLYLINE.html#a1">02954</a>     <a class="code" href="classEMF_1_1EMRPOLYLINE.html#a1">~EMRPOLYLINE</a> ( )<font class="keyword"></font>
02955 <font class="keyword">    </font>{
02956       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
02957     }
<a name="l02962"></a><a class="code" href="classEMF_1_1EMRPOLYLINE.html#a2">02962</a>     <a class="code" href="classEMF_1_1EMRPOLYLINE.html#a0">EMRPOLYLINE</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02963 <font class="keyword">    </font>{
02964       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cptl;
02965 
02966       lpoints = <font class="keyword">new</font> POINTL[cptl];
02967 
02968       POINTLARRAY points( lpoints, cptl );
02969 
02970       ds &gt;&gt; points;
02971     }
<a name="l02975"></a><a class="code" href="classEMF_1_1EMRPOLYLINE.html#a3">02975</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYLINE.html#a3">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02976 <font class="keyword">    </font>{
02977       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cptl &lt;&lt; POINTLARRAY( lpoints, cptl );
02978       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02979     }
<a name="l02983"></a><a class="code" href="classEMF_1_1EMRPOLYLINE.html#a4">02983</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYLINE.html#a4">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02989"></a><a class="code" href="classEMF_1_1EMRPOLYLINE.html#a5">02989</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYLINE.html#a5">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02990 <font class="keyword">    </font>{
02991       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
02992       Polyline( dc, (POINT*)lpoints, cptl );
02993     }
02994 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02995 <font class="preprocessor"></font>
02998     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02999 <font class="keyword">    </font>{
03000       printf( <font class="stringliteral">"*POLYLINE*\n"</font> );
03001       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03002 <font class="preprocessor">#if 0</font>
03003 <font class="preprocessor"></font>      printf( <font class="stringliteral">"\tcptl              : %ld\n"</font>, cptl );
03004       printf( <font class="stringliteral">"\taptl-&gt;\n"</font> );
03005       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; cptl; i++ )
03006         printf( <font class="stringliteral">"\t\t%ld, %ld\n"</font>, lpoints[i].x, lpoints[i].y );
03007 <font class="preprocessor">#else</font>
03008 <font class="preprocessor"></font>      edit_pointlarray( <font class="stringliteral">"\t"</font>, cptl, lpoints );
03009 <font class="preprocessor">#endif</font>
03010 <font class="preprocessor"></font>    }
03011 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03012   };
03013 
03015 
<a name="l03018"></a><a class="code" href="classEMF_1_1EMRPOLYLINE16.html">03018</a>   <font class="keyword">class </font>EMRPOLYLINE16 : <font class="keyword">public</font> METARECORD, ::EMRPOLYLINE16 {
03019     POINT16* lpoints;
03020   <font class="keyword">public</font>:
<a name="l03026"></a><a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a0">03026</a>     <a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a0">EMRPOLYLINE16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT16* points, INT n )<font class="keyword"></font>
03027 <font class="keyword">    </font>{
03028       cpts = n;
03029       apts[0].x = 0;            <font class="comment">// Really unused</font>
03030       apts[0].y = 0;
03031 
03032       emr.iType = EMR_POLYLINE16;
03033       <font class="comment">// The (cptl - 1) below is to account for aptl, which isn't written out</font>
03034       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYLINE16 ) + <font class="keyword">sizeof</font>( POINT16 ) * ( cpts - 1);
03035 
03036       lpoints = <font class="keyword">new</font> POINT16[cpts];
03037 
03038       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03039         lpoints[i].x = points[i].x;
03040         lpoints[i].y = points[i].y;
03041       }
03042 
03043       rclBounds = *bounds;
03044     }
<a name="l03051"></a><a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a1">03051</a>     <a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a0">EMRPOLYLINE16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
03052 <font class="keyword">    </font>{
03053       cpts = n;
03054       apts[0].x = 0;            <font class="comment">// Really unused</font>
03055       apts[0].y = 0;
03056 
03057       emr.iType = EMR_POLYLINE16;
03058       <font class="comment">// The (cptl - 1) below is to account for aptl, which isn't written out</font>
03059       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYLINE16 ) + <font class="keyword">sizeof</font>( POINT16 ) * ( cpts - 1);
03060 
03061       lpoints = <font class="keyword">new</font> POINT16[cpts];
03062 
03063       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03064         lpoints[i].x = points[i].x;
03065         lpoints[i].y = points[i].y;
03066       }
03067 
03068       rclBounds = *bounds;
03069     }
<a name="l03073"></a><a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a2">03073</a>     <a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a2">~EMRPOLYLINE16</a> ( )<font class="keyword"></font>
03074 <font class="keyword">    </font>{
03075       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
03076     }
<a name="l03081"></a><a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a3">03081</a>     <a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a0">EMRPOLYLINE16</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
03082 <font class="keyword">    </font>{
03083       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cpts;
03084 
03085       lpoints = <font class="keyword">new</font> POINT16[cpts];
03086 
03087       POINT16ARRAY points( lpoints, cpts );
03088 
03089       ds &gt;&gt; points;
03090     }
<a name="l03094"></a><a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a4">03094</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a4">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
03095 <font class="keyword">    </font>{
03096       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cpts &lt;&lt; POINT16ARRAY( lpoints, cpts );
03097       <font class="keywordflow">return</font> <font class="keyword">true</font>;
03098     }
<a name="l03102"></a><a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a5">03102</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a5">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03108"></a><a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a6">03108</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a6">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03109 <font class="keyword">    </font>{
03110       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03111       Polyline16( dc, lpoints, cpts );
03112     }
03113 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03114 <font class="preprocessor"></font>
03117     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03118 <font class="keyword">    </font>{
03119       printf( <font class="stringliteral">"*POLYLINE16*\n"</font> );
03120       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03121       edit_point16array( <font class="stringliteral">"\t"</font>, cpts, lpoints );
03122     }
03123 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03124   };
03125 
03127 
<a name="l03130"></a><a class="code" href="classEMF_1_1EMRPOLYGON.html">03130</a>   <font class="keyword">class </font>EMRPOLYGON : <font class="keyword">public</font> METARECORD, ::EMRPOLYGON {
03131     POINTL* lpoints;
03132   <font class="keyword">public</font>:
<a name="l03138"></a><a class="code" href="classEMF_1_1EMRPOLYGON.html#a0">03138</a>     <a class="code" href="classEMF_1_1EMRPOLYGON.html#a0">EMRPOLYGON</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
03139 <font class="keyword">    </font>{
03140       cptl = n;
03141       aptl[0].x = 0;            <font class="comment">// Really unused</font>
03142       aptl[0].y = 0;
03143 
03144       emr.iType = EMR_POLYGON;
03145       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03146       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYGON ) + <font class="keyword">sizeof</font>( POINTL ) * (cptl-1);
03147 
03148       lpoints = <font class="keyword">new</font> POINTL[cptl];
03149 
03150       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03151         lpoints[i].x = points[i].x;
03152         lpoints[i].y = points[i].y;
03153       }
03154 
03155       rclBounds = *bounds;
03156     }
<a name="l03161"></a><a class="code" href="classEMF_1_1EMRPOLYGON.html#a1">03161</a>     <a class="code" href="classEMF_1_1EMRPOLYGON.html#a0">EMRPOLYGON</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
03162 <font class="keyword">    </font>{
03163       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cptl;
03164 
03165       lpoints = <font class="keyword">new</font> POINTL[cptl];
03166 
03167       POINTLARRAY points( lpoints, cptl );
03168 
03169       ds &gt;&gt; points;
03170     }
<a name="l03174"></a><a class="code" href="classEMF_1_1EMRPOLYGON.html#a2">03174</a>     <a class="code" href="classEMF_1_1EMRPOLYGON.html#a2">~EMRPOLYGON</a> ( )<font class="keyword"></font>
03175 <font class="keyword">    </font>{
03176       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
03177     }
<a name="l03181"></a><a class="code" href="classEMF_1_1EMRPOLYGON.html#a3">03181</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYGON.html#a3">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
03182 <font class="keyword">    </font>{
03183       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cptl &lt;&lt; POINTLARRAY( lpoints, cptl );
03184       <font class="keywordflow">return</font> <font class="keyword">true</font>;
03185     }
<a name="l03189"></a><a class="code" href="classEMF_1_1EMRPOLYGON.html#a4">03189</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYGON.html#a4">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03195"></a><a class="code" href="classEMF_1_1EMRPOLYGON.html#a5">03195</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYGON.html#a5">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03196 <font class="keyword">    </font>{
03197       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03198       Polygon( dc, (POINT*)lpoints, cptl );
03199     }
03200 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03201 <font class="preprocessor"></font>
03204     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03205 <font class="keyword">    </font>{
03206       printf( <font class="stringliteral">"*POLYGON*\n"</font> );
03207       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03208 <font class="preprocessor">#if 0</font>
03209 <font class="preprocessor"></font>      printf( <font class="stringliteral">"\tcptl              : %ld\n"</font>, cptl );
03210       printf( <font class="stringliteral">"\taptl-&gt;\n"</font> );
03211       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; cptl; i++ )
03212         printf( <font class="stringliteral">"\t\t%ld, %ld\n"</font>, lpoints[i].x, lpoints[i].y );
03213 <font class="preprocessor">#else</font>
03214 <font class="preprocessor"></font>      edit_pointlarray( <font class="stringliteral">"\t"</font>, cptl, lpoints );
03215 <font class="preprocessor">#endif</font>
03216 <font class="preprocessor"></font>    }
03217 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03218   };
03219 
03221 
<a name="l03224"></a><a class="code" href="classEMF_1_1EMRPOLYGON16.html">03224</a>   <font class="keyword">class </font>EMRPOLYGON16 : <font class="keyword">public</font> METARECORD, ::EMRPOLYGON16 {
03225     POINT16* lpoints;
03226   <font class="keyword">public</font>:
<a name="l03232"></a><a class="code" href="classEMF_1_1EMRPOLYGON16.html#a0">03232</a>     <a class="code" href="classEMF_1_1EMRPOLYGON16.html#a0">EMRPOLYGON16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT16 n )<font class="keyword"></font>
03233 <font class="keyword">    </font>{
03234       cpts = n;
03235       apts[0].x = 0;            <font class="comment">// Really unused</font>
03236       apts[0].y = 0;
03237 
03238       emr.iType = EMR_POLYGON16;
03239       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03240       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYGON16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1);
03241 
03242       lpoints = <font class="keyword">new</font> POINT16[cpts];
03243 
03244       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03245         lpoints[i].x = points[i].x;
03246         lpoints[i].y = points[i].y;
03247       }
03248 
03249       rclBounds = *bounds;
03250     }
<a name="l03257"></a><a class="code" href="classEMF_1_1EMRPOLYGON16.html#a1">03257</a>     <a class="code" href="classEMF_1_1EMRPOLYGON16.html#a0">EMRPOLYGON16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT16* points, INT16 n )<font class="keyword"></font>
03258 <font class="keyword">    </font>{
03259       cpts = n;
03260       apts[0].x = 0;            <font class="comment">// Really unused</font>
03261       apts[0].y = 0;
03262 
03263       emr.iType = EMR_POLYGON16;
03264       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03265       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYGON16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1);
03266 
03267       lpoints = <font class="keyword">new</font> POINT16[cpts];
03268 
03269       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03270         lpoints[i].x = points[i].x;
03271         lpoints[i].y = points[i].y;
03272       }
03273 
03274       rclBounds = *bounds;
03275     }
<a name="l03280"></a><a class="code" href="classEMF_1_1EMRPOLYGON16.html#a2">03280</a>     <a class="code" href="classEMF_1_1EMRPOLYGON16.html#a0">EMRPOLYGON16</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
03281 <font class="keyword">    </font>{
03282       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cpts;
03283 
03284       lpoints = <font class="keyword">new</font> POINT16[cpts];
03285 
03286       POINT16ARRAY points( lpoints, cpts );
03287 
03288       ds &gt;&gt; points;
03289     }
<a name="l03293"></a><a class="code" href="classEMF_1_1EMRPOLYGON16.html#a3">03293</a>     <a class="code" href="classEMF_1_1EMRPOLYGON16.html#a3">~EMRPOLYGON16</a> ( )<font class="keyword"></font>
03294 <font class="keyword">    </font>{
03295       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
03296     }
<a name="l03300"></a><a class="code" href="classEMF_1_1EMRPOLYGON16.html#a4">03300</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYGON16.html#a4">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
03301 <font class="keyword">    </font>{
03302       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cpts &lt;&lt; POINT16ARRAY( lpoints, cpts );
03303       <font class="keywordflow">return</font> <font class="keyword">true</font>;
03304     }
<a name="l03308"></a><a class="code" href="classEMF_1_1EMRPOLYGON16.html#a5">03308</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYGON16.html#a5">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03314"></a><a class="code" href="classEMF_1_1EMRPOLYGON16.html#a6">03314</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYGON16.html#a6">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03315 <font class="keyword">    </font>{
03316       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03317       Polygon16( dc, lpoints, cpts );
03318     }
03319 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03320 <font class="preprocessor"></font>
03323     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03324 <font class="keyword">    </font>{
03325       printf( <font class="stringliteral">"*POLYGON16*\n"</font> );
03326       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03327       edit_point16array( <font class="stringliteral">"\t"</font>, cpts, lpoints );
03328     }
03329 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03330   };
03331 
03333 
<a name="l03336"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html">03336</a>   <font class="keyword">class </font>EMRPOLYPOLYGON : <font class="keyword">public</font> METARECORD, ::EMRPOLYPOLYGON {
03337     DWORD* lcounts;
03338     POINTL* lpoints;
03339   <font class="keyword">public</font>:
<a name="l03346"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a0">03346</a>     <a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a0">EMRPOLYPOLYGON</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, <font class="keyword">const</font> INT* counts,
03347                      UINT polygons )<font class="keyword"></font>
03348 <font class="keyword">    </font>{
03349       nPolys = polygons;
03350       <font class="comment">// Count the number of points in points</font>
03351       <font class="keywordtype">int</font> n = 0;
03352       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; nPolys; i++ )
03353         n += counts[i];
03354 
03355       cptl = n;
03356       aPolyCounts[0] = 0;       <font class="comment">// Really unused</font>
03357       aptl[0].x = 0;
03358       aptl[0].y = 0;
03359 
03360       emr.iType = EMR_POLYPOLYGON;
03361       <font class="comment">// The (#-1)'s below are to account for aPolyCounts[0] and aptl[0], which</font>
03362       <font class="comment">// aren't directly written out</font>
03363       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYPOLYGON ) + <font class="keyword">sizeof</font>( POINTL ) * (cptl-1)
03364         + <font class="keyword">sizeof</font>( DWORD ) * (nPolys-1);
03365 
03366       lcounts = <font class="keyword">new</font> DWORD[nPolys];
03367 
03368       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; nPolys; i++ )
03369         lcounts[i] = counts[i];
03370 
03371       lpoints = <font class="keyword">new</font> POINTL[cptl];
03372 
03373       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03374         lpoints[i].x = points[i].x;
03375         lpoints[i].y = points[i].y;
03376       }
03377 
03378       rclBounds = *bounds;
03379     }
<a name="l03383"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a1">03383</a>     <a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a1">~EMRPOLYPOLYGON</a> ( )<font class="keyword"></font>
03384 <font class="keyword">    </font>{
03385       <font class="keywordflow">if</font> ( lcounts ) <font class="keyword">delete</font>[] lcounts;
03386       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
03387     }
<a name="l03392"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a2">03392</a>     <a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a0">EMRPOLYPOLYGON</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
03393 <font class="keyword">    </font>{
03394       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; nPolys &gt;&gt; cptl;
03395 
03396       lcounts = <font class="keyword">new</font> DWORD[nPolys];
03397 
03398       DWORDARRAY counts( lcounts, nPolys );
03399 
03400       ds &gt;&gt; counts;
03401 
03402       lpoints = <font class="keyword">new</font> POINTL[cptl];
03403 
03404       POINTLARRAY points( lpoints, cptl );
03405 
03406       ds &gt;&gt; points;
03407     }
<a name="l03411"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a3">03411</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a3">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
03412 <font class="keyword">    </font>{
03413       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; nPolys &lt;&lt; cptl &lt;&lt; DWORDARRAY( lcounts, nPolys )
03414          &lt;&lt; POINTLARRAY( lpoints, cptl );
03415       <font class="keywordflow">return</font> <font class="keyword">true</font>;
03416     }
<a name="l03420"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a4">03420</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a4">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03426"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a5">03426</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a5">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03427 <font class="keyword">    </font>{
03428       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03429       <font class="comment">// (but DWORD and INT are not)</font>
03430       INT* counts = <font class="keyword">new</font> INT[nPolys];
03431       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; nPolys; i++ )
03432         counts[i] = lcounts[i];
03433 
03434       PolyPolygon( dc, (POINT*)lpoints, counts, nPolys );
03435 
03436       <font class="keyword">delete</font>[] counts;
03437     }
03438 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03439 <font class="preprocessor"></font>
03442     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03443 <font class="keyword">    </font>{
03444       printf( <font class="stringliteral">"*POLYPOLYGON*\n"</font> );
03445       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03446       printf( <font class="stringliteral">"\tnPolys\t\t: %ld\n"</font>, nPolys );
03447       printf( <font class="stringliteral">"\tcptl\t\t: %ld\n"</font>, cptl );
03448       printf( <font class="stringliteral">"\taPolyCounts\t: "</font> );
03449       <font class="keywordflow">if</font> ( nPolys &gt; 0 )
03450         printf( <font class="stringliteral">"%ld\n"</font>, lcounts[0] );
03451       <font class="keywordflow">else</font>
03452         puts( <font class="stringliteral">""</font> );
03453       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 1; i &lt; nPolys; i++ )
03454         printf( <font class="stringliteral">"\t\t\t  %ld\n"</font>, lcounts[i] );
03455       printf( <font class="stringliteral">"\tapts\t\t: "</font> );
03456       <font class="keywordflow">if</font> ( cptl &gt; 0 )
03457         printf( <font class="stringliteral">"%ld, %ld\n"</font>, lpoints[0].x, lpoints[0].y );
03458       <font class="keywordflow">else</font>
03459         puts( <font class="stringliteral">""</font> );
03460       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 1; i &lt; cptl; i++ )
03461         printf( <font class="stringliteral">"\t\t\t  %ld, %ld\n"</font>, lpoints[i].x, lpoints[i].y );
03462     }
03463 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03464   };
03465 
03467 
<a name="l03470"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html">03470</a>   <font class="keyword">class </font>EMRPOLYPOLYGON16 : <font class="keyword">public</font> METARECORD, ::EMRPOLYPOLYGON16 {
03471     DWORD* lcounts;
03472     POINT16* lpoints;
03473   <font class="keyword">public</font>:
<a name="l03480"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a0">03480</a>     <a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a0">EMRPOLYPOLYGON16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points,
03481                        <font class="keyword">const</font> INT* counts, UINT polygons )<font class="keyword"></font>
03482 <font class="keyword">    </font>{
03483       nPolys = polygons;
03484       <font class="comment">// Count the number of points in points</font>
03485       <font class="keywordtype">int</font> n = 0;
03486       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; nPolys; i++ )
03487         n += counts[i];
03488 
03489       cpts = n;
03490       aPolyCounts[0] = 0;       <font class="comment">// Really unused</font>
03491       apts[0].x = 0;
03492       apts[0].y = 0;
03493 
03494       emr.iType = EMR_POLYPOLYGON16;
03495       <font class="comment">// The (#-1)'s below are to account for aPolyCounts[0] and aptl[0], which</font>
03496       <font class="comment">// aren't directly written out</font>
03497       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYPOLYGON16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1)
03498         + <font class="keyword">sizeof</font>( DWORD ) * (nPolys-1);
03499 
03500       lcounts = <font class="keyword">new</font> DWORD[nPolys];
03501 
03502       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; nPolys; i++ )
03503         lcounts[i] = counts[i];
03504 
03505       lpoints = <font class="keyword">new</font> POINT16[cpts];
03506 
03507       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03508         lpoints[i].x = points[i].x;
03509         lpoints[i].y = points[i].y;
03510       }
03511 
03512       rclBounds = *bounds;
03513     }
<a name="l03521"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a1">03521</a>     <a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a0">EMRPOLYPOLYGON16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT16* points,
03522                        <font class="keyword">const</font> INT* counts, UINT16 polygons )<font class="keyword"></font>
03523 <font class="keyword">    </font>{
03524       nPolys = polygons;
03525       <font class="comment">// Count the number of points in points</font>
03526       <font class="keywordtype">int</font> n = 0;
03527       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; nPolys; i++ )
03528         n += counts[i];
03529 
03530       cpts = n;
03531       aPolyCounts[0] = 0;       <font class="comment">// Really unused</font>
03532       apts[0].x = 0;
03533       apts[0].y = 0;
03534 
03535       emr.iType = EMR_POLYPOLYGON16;
03536       <font class="comment">// The (#-1)'s below are to account for aPolyCounts[0] and aptl[0], which</font>
03537       <font class="comment">// aren't directly written out</font>
03538       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYPOLYGON16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1)
03539         + <font class="keyword">sizeof</font>( DWORD ) * (nPolys-1);
03540 
03541       lcounts = <font class="keyword">new</font> DWORD[nPolys];
03542 
03543       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; nPolys; i++ )
03544         lcounts[i] = counts[i];
03545 
03546       lpoints = <font class="keyword">new</font> POINT16[cpts];
03547 
03548       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03549         lpoints[i].x = points[i].x;
03550         lpoints[i].y = points[i].y;
03551       }
03552 
03553       rclBounds = *bounds;
03554     }
<a name="l03558"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a2">03558</a>     <a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a2">~EMRPOLYPOLYGON16</a> ( )<font class="keyword"></font>
03559 <font class="keyword">    </font>{
03560       <font class="keywordflow">if</font> ( lcounts ) <font class="keyword">delete</font>[] lcounts;
03561       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
03562     }
<a name="l03567"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a3">03567</a>     <a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a0">EMRPOLYPOLYGON16</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
03568 <font class="keyword">    </font>{
03569       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; nPolys &gt;&gt; cpts;
03570 
03571       lcounts = <font class="keyword">new</font> DWORD[nPolys];
03572 
03573       DWORDARRAY counts( lcounts, nPolys );
03574 
03575       ds &gt;&gt; counts;
03576 
03577       lpoints = <font class="keyword">new</font> POINT16[cpts];
03578 
03579       POINT16ARRAY points( lpoints, cpts );
03580 
03581       ds &gt;&gt; points;
03582     }
<a name="l03586"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a4">03586</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a4">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
03587 <font class="keyword">    </font>{
03588       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; nPolys &lt;&lt; cpts &lt;&lt; DWORDARRAY( lcounts, nPolys )
03589          &lt;&lt; POINT16ARRAY( lpoints, cpts );
03590       <font class="keywordflow">return</font> <font class="keyword">true</font>;
03591     }
<a name="l03595"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a5">03595</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a5">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03601"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a6">03601</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a6">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03602 <font class="keyword">    </font>{
03603       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03604       <font class="comment">// (but DWORD and INT are not)</font>
03605       INT* counts = <font class="keyword">new</font> INT[nPolys];
03606       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; nPolys; i++ )
03607         counts[i] = lcounts[i];
03608 
03609       PolyPolygon16( dc, lpoints, counts, nPolys );
03610 
03611       <font class="keyword">delete</font>[] counts;
03612     }
03613 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03614 <font class="preprocessor"></font>
03617     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03618 <font class="keyword">    </font>{
03619       printf( <font class="stringliteral">"*POLYPOLYGON16*\n"</font> );
03620       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03621       printf( <font class="stringliteral">"\tnPolys\t\t: %ld\n"</font>, nPolys );
03622       printf( <font class="stringliteral">"\tcpts\t\t: %ld\n"</font>, cpts );
03623       printf( <font class="stringliteral">"\taPolyCounts\t: "</font> );
03624       <font class="keywordflow">if</font> ( nPolys &gt; 0 )
03625         printf( <font class="stringliteral">"%ld\n"</font>, lcounts[0] );
03626       <font class="keywordflow">else</font>
03627         puts( <font class="stringliteral">""</font> );
03628       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 1; i &lt; nPolys; i++ )
03629         printf( <font class="stringliteral">"\t\t\t  %ld\n"</font>, lcounts[i] );
03630       printf( <font class="stringliteral">"\tapts\t\t: "</font> );
03631       <font class="keywordflow">if</font> ( cpts &gt; 0 )
03632         printf( <font class="stringliteral">"%d, %d\n"</font>, lpoints[0].x, lpoints[0].y );
03633       <font class="keywordflow">else</font>
03634         puts( <font class="stringliteral">""</font> );
03635       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 1; i &lt; cpts; i++ )
03636         printf( <font class="stringliteral">"\t\t\t  %d, %d\n"</font>, lpoints[i].x, lpoints[i].y );
03637     }
03638 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03639   };
03640 
03642 
<a name="l03645"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER.html">03645</a>   <font class="keyword">class </font>EMRPOLYBEZIER : <font class="keyword">public</font> METARECORD, ::EMRPOLYBEZIER {
03646     POINTL* lpoints;
03647   <font class="keyword">public</font>:
<a name="l03653"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a0">03653</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a0">EMRPOLYBEZIER</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
03654 <font class="keyword">    </font>{
03655       cptl = n;
03656       aptl[0].x = 0;            <font class="comment">// Really unused</font>
03657       aptl[0].y = 0;
03658 
03659       emr.iType = EMR_POLYBEZIER;
03660       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03661       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYBEZIER ) + <font class="keyword">sizeof</font>( POINTL ) * (cptl-1);
03662 
03663       lpoints = <font class="keyword">new</font> POINTL[cptl];
03664 
03665       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03666         lpoints[i].x = points[i].x;
03667         lpoints[i].y = points[i].y;
03668       }
03669 
03670       rclBounds = *bounds;
03671     }
<a name="l03676"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a1">03676</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a0">EMRPOLYBEZIER</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
03677 <font class="keyword">    </font>{
03678       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cptl;
03679 
03680       lpoints = <font class="keyword">new</font> POINTL[cptl];
03681 
03682       POINTLARRAY points( lpoints, cptl );
03683 
03684       ds &gt;&gt; points;
03685     }
<a name="l03689"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a2">03689</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a2">~EMRPOLYBEZIER</a> ( )<font class="keyword"></font>
03690 <font class="keyword">    </font>{
03691       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
03692     }
<a name="l03696"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a3">03696</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a3">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
03697 <font class="keyword">    </font>{
03698       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cptl &lt;&lt; POINTLARRAY( lpoints, cptl );
03699       <font class="keywordflow">return</font> <font class="keyword">true</font>;
03700     }
<a name="l03704"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a4">03704</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a4">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03710"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a5">03710</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a5">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03711 <font class="keyword">    </font>{
03712       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03713       PolyBezier( dc, (POINT*)lpoints, cptl );
03714     }
03715 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03716 <font class="preprocessor"></font>
03719     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03720 <font class="keyword">    </font>{
03721       printf( <font class="stringliteral">"*POLYBEZIER*\n"</font> );
03722       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03723 <font class="preprocessor">#if 0</font>
03724 <font class="preprocessor"></font>      printf( <font class="stringliteral">"\tcptl              : %ld\n"</font>, cptl );
03725       printf( <font class="stringliteral">"\taptl-&gt;\n"</font> );
03726       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; cptl; i++ )
03727         printf( <font class="stringliteral">"\t\t%ld, %ld\n"</font>, lpoints[i].x, lpoints[i].y );
03728 <font class="preprocessor">#else</font>
03729 <font class="preprocessor"></font>      edit_pointlarray( <font class="stringliteral">"\t"</font>, cptl, lpoints );
03730 <font class="preprocessor">#endif</font>
03731 <font class="preprocessor"></font>    }
03732 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03733   };
03734 
03736 
<a name="l03739"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html">03739</a>   <font class="keyword">class </font>EMRPOLYBEZIER16 : <font class="keyword">public</font> METARECORD, ::EMRPOLYBEZIER16 {
03740     POINT16* lpoints;
03741   <font class="keyword">public</font>:
<a name="l03747"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a0">03747</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a0">EMRPOLYBEZIER16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT16* points, INT n )<font class="keyword"></font>
03748 <font class="keyword">    </font>{
03749       cpts = n;
03750       apts[0].x = 0;            <font class="comment">// Really unused</font>
03751       apts[0].y = 0;
03752 
03753       emr.iType = EMR_POLYBEZIER16;
03754       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03755       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYBEZIER16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1);
03756 
03757       lpoints = <font class="keyword">new</font> POINT16[cpts];
03758 
03759       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03760         lpoints[i].x = points[i].x;
03761         lpoints[i].y = points[i].y;
03762       }
03763 
03764       rclBounds = *bounds;
03765     }
<a name="l03772"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a1">03772</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a0">EMRPOLYBEZIER16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
03773 <font class="keyword">    </font>{
03774       cpts = n;
03775       apts[0].x = 0;            <font class="comment">// Really unused</font>
03776       apts[0].y = 0;
03777 
03778       emr.iType = EMR_POLYBEZIER16;
03779       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03780       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYBEZIER16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1);
03781 
03782       lpoints = <font class="keyword">new</font> POINT16[cpts];
03783 
03784       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03785         lpoints[i].x = points[i].x;
03786         lpoints[i].y = points[i].y;
03787       }
03788 
03789       rclBounds = *bounds;
03790     }
<a name="l03795"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a2">03795</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a0">EMRPOLYBEZIER16</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
03796 <font class="keyword">    </font>{
03797       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cpts;
03798 
03799       lpoints = <font class="keyword">new</font> POINT16[cpts];
03800 
03801       POINT16ARRAY points( lpoints, cpts );
03802 
03803       ds &gt;&gt; points;
03804     }
<a name="l03808"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a3">03808</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a3">~EMRPOLYBEZIER16</a> ( )<font class="keyword"></font>
03809 <font class="keyword">    </font>{
03810       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
03811     }
<a name="l03815"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a4">03815</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a4">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
03816 <font class="keyword">    </font>{
03817       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cpts &lt;&lt; POINT16ARRAY( lpoints, cpts );
03818       <font class="keywordflow">return</font> <font class="keyword">true</font>;
03819     }
<a name="l03823"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a5">03823</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a5">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03829"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a6">03829</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a6">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03830 <font class="keyword">    </font>{
03831       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03832       PolyBezier16( dc, lpoints, cpts );
03833     }
03834 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03835 <font class="preprocessor"></font>
03838     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03839 <font class="keyword">    </font>{
03840       printf( <font class="stringliteral">"*POLYBEZIER16*\n"</font> );
03841       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03842       edit_point16array( <font class="stringliteral">"\t"</font>, cpts, lpoints );
03843     }
03844 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03845   };
03846 
03848 
<a name="l03851"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html">03851</a>   <font class="keyword">class </font>EMRPOLYBEZIERTO : <font class="keyword">public</font> METARECORD, ::EMRPOLYBEZIER {
03852     POINTL* lpoints;
03853   <font class="keyword">public</font>:
<a name="l03859"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a0">03859</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a0">EMRPOLYBEZIERTO</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
03860 <font class="keyword">    </font>{
03861       cptl = n;
03862       aptl[0].x = 0;            <font class="comment">// Really unused</font>
03863       aptl[0].y = 0;
03864 
03865       emr.iType = EMR_POLYBEZIERTO;
03866       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03867       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYBEZIERTO ) + <font class="keyword">sizeof</font>( POINTL ) * (cptl-1);
03868 
03869       lpoints = <font class="keyword">new</font> POINTL[cptl];
03870 
03871       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03872         lpoints[i].x = points[i].x;
03873         lpoints[i].y = points[i].y;
03874       }
03875 
03876       rclBounds = *bounds;
03877     }
<a name="l03882"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a1">03882</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a0">EMRPOLYBEZIERTO</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
03883 <font class="keyword">    </font>{
03884       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cptl;
03885 
03886       lpoints = <font class="keyword">new</font> POINTL[cptl];
03887 
03888       POINTLARRAY points( lpoints, cptl );
03889 
03890       ds &gt;&gt; points;
03891     }
<a name="l03895"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a2">03895</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a2">~EMRPOLYBEZIERTO</a> ( )<font class="keyword"></font>
03896 <font class="keyword">    </font>{
03897       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
03898     }
<a name="l03902"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a3">03902</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a3">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
03903 <font class="keyword">    </font>{
03904       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cptl &lt;&lt; POINTLARRAY( lpoints, cptl );
03905       <font class="keywordflow">return</font> <font class="keyword">true</font>;
03906     }
<a name="l03910"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a4">03910</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a4">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03916"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a5">03916</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a5">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03917 <font class="keyword">    </font>{
03918       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03919       PolyBezierTo( dc, (POINT*)lpoints, cptl );
03920     }
03921 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03922 <font class="preprocessor"></font>
03925     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03926 <font class="keyword">    </font>{
03927       printf( <font class="stringliteral">"*POLYBEZIERTO*\n"</font> );
03928       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03929 <font class="preprocessor">#if 0</font>
03930 <font class="preprocessor"></font>      printf( <font class="stringliteral">"\tcptl              : %ld\n"</font>, cptl );
03931       printf( <font class="stringliteral">"\taptl-&gt;\n"</font> );
03932       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; cptl; i++ )
03933         printf( <font class="stringliteral">"\t\t%ld, %ld\n"</font>, lpoints[i].x, lpoints[i].y );
03934 <font class="preprocessor">#else</font>
03935 <font class="preprocessor"></font>      edit_pointlarray( <font class="stringliteral">"\t"</font>, cptl, lpoints );
03936 <font class="preprocessor">#endif</font>
03937 <font class="preprocessor"></font>    }
03938 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03939   };
03940 
03942 
<a name="l03945"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html">03945</a>   <font class="keyword">class </font>EMRPOLYBEZIERTO16 : <font class="keyword">public</font> METARECORD, ::EMRPOLYBEZIER16 {
03946     POINT16* lpoints;
03947   <font class="keyword">public</font>:
<a name="l03953"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a0">03953</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a0">EMRPOLYBEZIERTO16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT16* points, INT n )<font class="keyword"></font>
03954 <font class="keyword">    </font>{
03955       cpts = n;
03956       apts[0].x = 0;            <font class="comment">// Really unused</font>
03957       apts[0].y = 0;
03958 
03959       emr.iType = EMR_POLYBEZIERTO16;
03960       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03961       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYBEZIERTO16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1);
03962 
03963       lpoints = <font class="keyword">new</font> POINT16[cpts];
03964 
03965       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03966         lpoints[i].x = points[i].x;
03967         lpoints[i].y = points[i].y;
03968       }
03969 
03970       rclBounds = *bounds;
03971     }
<a name="l03978"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a1">03978</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a0">EMRPOLYBEZIERTO16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
03979 <font class="keyword">    </font>{
03980       cpts = n;
03981       apts[0].x = 0;            <font class="comment">// Really unused</font>
03982       apts[0].y = 0;
03983 
03984       emr.iType = EMR_POLYBEZIERTO16;
03985       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03986       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYBEZIERTO16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1);
03987 
03988       lpoints = <font class="keyword">new</font> POINT16[cpts];
03989 
03990       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03991         lpoints[i].x = points[i].x;
03992         lpoints[i].y = points[i].y;
03993       }
03994 
03995       rclBounds = *bounds;
03996     }
<a name="l04001"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a2">04001</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a0">EMRPOLYBEZIERTO16</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
04002 <font class="keyword">    </font>{
04003       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cpts;
04004 
04005       lpoints = <font class="keyword">new</font> POINT16[cpts];
04006 
04007       POINT16ARRAY points( lpoints, cpts );
04008 
04009       ds &gt;&gt; points;
04010     }
<a name="l04014"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a3">04014</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a3">~EMRPOLYBEZIERTO16</a> ( )<font class="keyword"></font>
04015 <font class="keyword">    </font>{
04016       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
04017     }
<a name="l04021"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a4">04021</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a4">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04022 <font class="keyword">    </font>{
04023       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cpts &lt;&lt; POINT16ARRAY( lpoints, cpts );
04024       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04025     }
<a name="l04029"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a5">04029</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a5">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l04035"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a6">04035</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a6">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
04036 <font class="keyword">    </font>{
04037       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
04038       PolyBezierTo16( dc, lpoints, cpts );
04039     }
04040 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04041 <font class="preprocessor"></font>
04044     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04045 <font class="keyword">    </font>{
04046       printf( <font class="stringliteral">"*POLYBEZIERTO16*\n"</font> );
04047       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
04048       edit_point16array( <font class="stringliteral">"\t"</font>, cpts, lpoints );
04049     }
04050 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04051   };
04052 
04054 
<a name="l04057"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO.html">04057</a>   <font class="keyword">class </font>EMRPOLYLINETO : <font class="keyword">public</font> METARECORD, ::EMRPOLYLINETO {
04058     POINTL* lpoints;
04059   <font class="keyword">public</font>:
<a name="l04065"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a0">04065</a>     <a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a0">EMRPOLYLINETO</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
04066 <font class="keyword">    </font>{
04067       cptl = n;
04068       aptl[0].x = 0;
04069       aptl[0].y = 0;
04070 
04071       emr.iType = EMR_POLYLINETO;
04072       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
04073       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYLINETO ) + <font class="keyword">sizeof</font>( POINTL ) * (cptl-1);
04074 
04075       lpoints = <font class="keyword">new</font> POINTL[cptl];
04076 
04077       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
04078         lpoints[i].x = points[i].x;
04079         lpoints[i].y = points[i].y;
04080       }
04081 
04082       rclBounds = *bounds;
04083     }
<a name="l04088"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a1">04088</a>     <a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a0">EMRPOLYLINETO</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
04089 <font class="keyword">    </font>{
04090       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cptl;
04091 
04092       lpoints = <font class="keyword">new</font> POINTL[cptl];
04093 
04094       POINTLARRAY points( lpoints, cptl );
04095 
04096       ds &gt;&gt; points;
04097     }
<a name="l04101"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a2">04101</a>     <a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a2">~EMRPOLYLINETO</a> ( )<font class="keyword"></font>
04102 <font class="keyword">    </font>{
04103       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
04104     }
<a name="l04108"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a3">04108</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a3">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04109 <font class="keyword">    </font>{
04110       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cptl &lt;&lt; POINTLARRAY( lpoints, cptl );
04111       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04112     }
<a name="l04116"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a4">04116</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a4">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l04122"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a5">04122</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a5">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
04123 <font class="keyword">    </font>{
04124       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
04125       PolylineTo( dc, (POINT*)lpoints, cptl );
04126     }
04127 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04128 <font class="preprocessor"></font>
04131     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04132 <font class="keyword">    </font>{
04133       printf( <font class="stringliteral">"*POLYLINETO*\n"</font> );
04134       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
04135 <font class="preprocessor">#if 0</font>
04136 <font class="preprocessor"></font>      printf( <font class="stringliteral">"\tcptl              : %ld\n"</font>, cptl );
04137       printf( <font class="stringliteral">"\taptl-&gt;\n"</font> );
04138       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; cptl; i++ )
04139         printf( <font class="stringliteral">"\t\t%ld, %ld\n"</font>, lpoints[i].x, lpoints[i].y );
04140 <font class="preprocessor">#else</font>
04141 <font class="preprocessor"></font>      edit_pointlarray( <font class="stringliteral">"\t"</font>, cptl, lpoints );
04142 <font class="preprocessor">#endif</font>
04143 <font class="preprocessor"></font>    }
04144 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04145   };
04146 
04148 
<a name="l04151"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO16.html">04151</a>   <font class="keyword">class </font>EMRPOLYLINETO16 : <font class="keyword">public</font> METARECORD, ::EMRPOLYLINETO16 {
04152     POINT16* lpoints;
04153   <font class="keyword">public</font>:
<a name="l04159"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a0">04159</a>     <a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a0">EMRPOLYLINETO16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT16* points, INT n )<font class="keyword"></font>
04160 <font class="keyword">    </font>{
04161       cpts = n;
04162       apts[0].x = 0;
04163       apts[0].y = 0;
04164 
04165       emr.iType = EMR_POLYLINETO16;
04166       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
04167       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYLINETO16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1);
04168 
04169       lpoints = <font class="keyword">new</font> POINT16[cpts];
04170 
04171       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
04172         lpoints[i].x = points[i].x;
04173         lpoints[i].y = points[i].y;
04174       }
04175 
04176       rclBounds = *bounds;
04177     }
<a name="l04184"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a1">04184</a>     <a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a0">EMRPOLYLINETO16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
04185 <font class="keyword">    </font>{
04186       cpts = n;
04187       apts[0].x = 0;
04188       apts[0].y = 0;
04189 
04190       emr.iType = EMR_POLYLINETO16;
04191       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
04192       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYLINETO16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1);
04193 
04194       lpoints = <font class="keyword">new</font> POINT16[cpts];
04195 
04196       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
04197         lpoints[i].x = points[i].x;
04198         lpoints[i].y = points[i].y;
04199       }
04200 
04201       rclBounds = *bounds;
04202     }
<a name="l04207"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a2">04207</a>     <a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a0">EMRPOLYLINETO16</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
04208 <font class="keyword">    </font>{
04209       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cpts;
04210 
04211       lpoints = <font class="keyword">new</font> POINT16[cpts];
04212 
04213       POINT16ARRAY points( lpoints, cpts );
04214 
04215       ds &gt;&gt; points;
04216     }
<a name="l04220"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a3">04220</a>     <a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a3">~EMRPOLYLINETO16</a> ( )<font class="keyword"></font>
04221 <font class="keyword">    </font>{
04222       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
04223     }
<a name="l04227"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a4">04227</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a4">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04228 <font class="keyword">    </font>{
04229       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cpts &lt;&lt; POINT16ARRAY( lpoints, cpts );
04230       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04231     }
<a name="l04235"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a5">04235</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a5">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l04241"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a6">04241</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a6">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
04242 <font class="keyword">    </font>{
04243       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
04244       PolylineTo16( dc, lpoints, cpts );
04245     }
04246 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04247 <font class="preprocessor"></font>
04250     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04251 <font class="keyword">    </font>{
04252       printf( <font class="stringliteral">"*POLYLINETO16*\n"</font> );
04253       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
04254       edit_point16array( <font class="stringliteral">"\t"</font>, cpts, lpoints );
04255     }
04256 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04257   };
04258 
04260 
<a name="l04265"></a><a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html">04265</a>   <font class="keyword">class </font>EMREXTTEXTOUTA : <font class="keyword">public</font> METARECORD, ::EMREXTTEXTOUTA {
04266     PSTR string_a;
04267     <font class="keywordtype">int</font> string_size;
04268 
04269     INT* dx_i;
04270   <font class="keyword">public</font>:
<a name="l04280"></a><a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a0">04280</a>     <a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a0">EMREXTTEXTOUTA</a> ( <font class="keyword">const</font> RECTL* bounds, DWORD graphicsMode, FLOAT xScale,
04281                      FLOAT yScale, <font class="keyword">const</font> PEMRTEXT text, LPCSTR string,
04282                      <font class="keyword">const</font> INT* dx )<font class="keyword"></font>
04283 <font class="keyword">    </font>{
04284       emr.iType = EMR_EXTTEXTOUTA;
04285       emr.nSize = <font class="keyword">sizeof</font>( ::EMREXTTEXTOUTA );
04286 
04287       rclBounds = *bounds;
04288 
04289       iGraphicsMode = graphicsMode;
04290       exScale = xScale;
04291       eyScale = yScale;
04292 
04293       emrtext = *text;
04294 
04295       string_size = ROUND_TO_LONG( emrtext.nChars );
04296 
04297       string_a = <font class="keyword">new</font> CHAR[ string_size ];
04298 
04299       memset( string_a, 0, <font class="keyword">sizeof</font>(CHAR) * string_size );
04300 
04301       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i=0; i&lt;emrtext.nChars; i++ )
04302         string_a[i] = *string++;
04303 
04304       emrtext.offString = emr.nSize;
04305       emr.nSize += string_size * <font class="keyword">sizeof</font>(CHAR);
04306 
04307       <font class="keywordflow">if</font> ( dx ) {
04308 
04309         dx_i = <font class="keyword">new</font> INT[ emrtext.nChars ];
04310 
04311         <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i=0; i&lt;emrtext.nChars; i++ )
04312           dx_i[i] = *dx++;
04313 
04314         emrtext.offDx = emr.nSize;
04315         emr.nSize += emrtext.nChars * <font class="keyword">sizeof</font>(INT);
04316       }
04317       <font class="keywordflow">else</font> {
04318         emrtext.offDx = 0;
04319         dx_i = 0;
04320       }
04321     }
<a name="l04326"></a><a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a1">04326</a>     <a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a0">EMREXTTEXTOUTA</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
04327 <font class="keyword">    </font>{
04328       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; iGraphicsMode &gt;&gt; exScale &gt;&gt; eyScale &gt;&gt; emrtext;
04329 
04330       <font class="keywordflow">if</font> ( emrtext.offString != 0 ) {
04331         string_size = ROUND_TO_LONG( emrtext.nChars );
04332 
04333         string_a = <font class="keyword">new</font> CHAR[ string_size ];
04334 
04335         memset( string_a, 0, <font class="keyword">sizeof</font>(CHAR) * string_size );
04336 
04337         CHARSTR string( string_a, string_size );
04338 
04339         ds &gt;&gt; string;
04340       }
04341       <font class="keywordflow">else</font>
04342         string_a = 0;
04343 
04344       <font class="keywordflow">if</font> ( emrtext.offDx ) {
04345         dx_i = <font class="keyword">new</font> INT[ emrtext.nChars ];
04346 
04347         INTARRAY dx_is( dx_i, emrtext.nChars );
04348 
04349         ds &gt;&gt; dx_is;
04350       }
04351       <font class="keywordflow">else</font>
04352         dx_i = 0;
04353     }
<a name="l04358"></a><a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a2">04358</a>     <a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a2">~EMREXTTEXTOUTA</a> ( )<font class="keyword"></font>
04359 <font class="keyword">    </font>{
04360       <font class="keywordflow">if</font> ( string_a ) <font class="keyword">delete</font>[] string_a;
04361       <font class="keywordflow">if</font> ( dx_i ) <font class="keyword">delete</font>[] dx_i;
04362     }
<a name="l04366"></a><a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a3">04366</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a3">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04367 <font class="keyword">    </font>{
04368       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; iGraphicsMode &lt;&lt; exScale &lt;&lt; eyScale
04369          &lt;&lt; emrtext &lt;&lt; CHARSTR( string_a, string_size );
04370       <font class="keywordflow">if</font> ( dx_i )
04371         ds &lt;&lt; INTARRAY( dx_i, emrtext.nChars );
04372       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04373     }
<a name="l04377"></a><a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a4">04377</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a4">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l04383"></a><a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a5">04383</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a5">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
04384 <font class="keyword">    </font>{
04385       RECT rect;
04386       rect.left = emrtext.rcl.left;
04387       rect.top = emrtext.rcl.top;
04388       rect.right = emrtext.rcl.right;
04389       rect.bottom = emrtext.rcl.bottom;
04390 
04391       ExtTextOutA( dc, emrtext.ptlReference.x, emrtext.ptlReference.y,
04392                    emrtext.fOptions, &amp;rect, string_a, emrtext.nChars,
04393                    dx_i );
04394     }
04395 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04396 <font class="preprocessor"></font>
04399     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04400 <font class="keyword">    </font>{
04401       printf( <font class="stringliteral">"*EXTTEXTOUTA*\n"</font> );
04402       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
04403       printf( <font class="stringliteral">"\tiGraphicsMode\t: "</font> );
04404       <font class="keywordflow">switch</font> ( iGraphicsMode ) {
04405       <font class="keywordflow">case</font> GM_COMPATIBLE: printf( <font class="stringliteral">"GM_COMPATIBLE\n"</font> ); <font class="keywordflow">break</font>;
04406       <font class="keywordflow">case</font> GM_ADVANCED: printf( <font class="stringliteral">"GM_ADVANCED\n"</font> ); <font class="keywordflow">break</font>;
04407       <font class="keywordflow">default</font>: printf( <font class="stringliteral">"unknown(%ld)\n"</font>, iGraphicsMode );
04408       }
04409       printf( <font class="stringliteral">"\texScale\t\t: %f\n"</font>, exScale );
04410       printf( <font class="stringliteral">"\teyScale\t\t: %f\n"</font>, eyScale );
04411       printf( <font class="stringliteral">"\tptlReference\t: (%ld,%ld)\n"</font>, emrtext.ptlReference.x,
04412               emrtext.ptlReference.y );
04413       printf( <font class="stringliteral">"\tnChars\t\t: %ld\n"</font>, emrtext.nChars );
04414       printf( <font class="stringliteral">"\toffString\t: %ld\n"</font>, emrtext.offString );
04415       printf( <font class="stringliteral">"\tfOptions\t: "</font> );
04416       <font class="keywordflow">if</font> ( emrtext.fOptions == 0 )
04417         printf( <font class="stringliteral">"None"</font> );
04418       <font class="keywordflow">else</font> {
04419         <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ETO_GRAYED ) {
04420           printf( <font class="stringliteral">"ETO_GRAYED"</font> );
04421           <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ~ETO_GRAYED )
04422             printf( <font class="stringliteral">" | "</font> );
04423         }
04424         <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ETO_OPAQUE ) {
04425           printf( <font class="stringliteral">"ETO_OPAQUE"</font> );
04426           <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ~(ETO_GRAYED | ETO_OPAQUE) )
04427             printf( <font class="stringliteral">" | "</font> );
04428         }
04429         <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ETO_CLIPPED ) {
04430           printf( <font class="stringliteral">"ETO_CLIPPED"</font> );
04431           <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ~(ETO_GRAYED | ETO_OPAQUE | ETO_CLIPPED ) )
04432             printf( <font class="stringliteral">" | "</font> );
04433         }
04434         <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ETO_GLYPH_INDEX ) {
04435           printf( <font class="stringliteral">"ETO_GLYPH_INDEX"</font> );
04436           <font class="keywordflow">if</font> ( emrtext.fOptions &amp;
04437                ~(ETO_GRAYED | ETO_OPAQUE | ETO_CLIPPED | ETO_GLYPH_INDEX) )
04438             printf( <font class="stringliteral">" | "</font> );
04439         }
04440         <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ETO_RTLREADING ) {
04441           printf( <font class="stringliteral">"ETO_RTLREADING"</font> );
04442           <font class="keywordflow">if</font> ( emrtext.fOptions &amp;
04443                ~(ETO_GRAYED | ETO_OPAQUE | ETO_CLIPPED | ETO_GLYPH_INDEX |
04444                  ETO_RTLREADING) )
04445             printf( <font class="stringliteral">" | "</font> );
04446         }
04447         <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ETO_IGNORELANGUAGE )
04448           printf( <font class="stringliteral">"ETO_IGNORELANGUAGE"</font> );
04449       }
04450       printf( <font class="stringliteral">"\n"</font> );
04451       edit_rectl( <font class="stringliteral">"rcl\t"</font>, emrtext.rcl );
04452       printf( <font class="stringliteral">"\toffDx\t\t: %ld\n"</font>, emrtext.offDx );
04453       printf( <font class="stringliteral">"\tString:\n\t\t%s\n"</font>,  string_a );
04454 
04455       <font class="keywordflow">if</font> ( emrtext.offDx != 0 ) {
04456         printf( <font class="stringliteral">"\tOffsets:\n\t\t"</font> );
04457         <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; emrtext.nChars; i++ )
04458           printf( <font class="stringliteral">"%d "</font>, dx_i[i] );
04459         printf( <font class="stringliteral">"\n"</font> );
04460       }
04461     }
04462 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04463   };
04464 
04466 
<a name="l04469"></a><a class="code" href="classEMF_1_1EMRSETPIXELV.html">04469</a>   <font class="keyword">class </font>EMRSETPIXELV : <font class="keyword">public</font> METARECORD, ::EMRSETPIXELV {
04470   <font class="keyword">public</font>:
<a name="l04476"></a><a class="code" href="classEMF_1_1EMRSETPIXELV.html#a0">04476</a>     <a class="code" href="classEMF_1_1EMRSETPIXELV.html#a0">EMRSETPIXELV</a> ( INT x, INT y, COLORREF color )<font class="keyword"></font>
04477 <font class="keyword">    </font>{
04478       emr.iType = EMR_SETPIXELV;
04479       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETPIXELV );
04480       ptlPixel.x = x;
04481       ptlPixel.y = y;
04482       crColor = color;
04483     }
<a name="l04488"></a><a class="code" href="classEMF_1_1EMRSETPIXELV.html#a1">04488</a>     <a class="code" href="classEMF_1_1EMRSETPIXELV.html#a0">EMRSETPIXELV</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
04489 <font class="keyword">    </font>{
04490       ds &gt;&gt; emr &gt;&gt; ptlPixel &gt;&gt; crColor;
04491     }
<a name="l04495"></a><a class="code" href="classEMF_1_1EMRSETPIXELV.html#a2">04495</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETPIXELV.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04496 <font class="keyword">    </font>{
04497       ds &lt;&lt; emr &lt;&lt; ptlPixel &lt;&lt; crColor;
04498       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04499     }
<a name="l04503"></a><a class="code" href="classEMF_1_1EMRSETPIXELV.html#a3">04503</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETPIXELV.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l04509"></a><a class="code" href="classEMF_1_1EMRSETPIXELV.html#a4">04509</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETPIXELV.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
04510 <font class="keyword">    </font>{
04511       SetPixel( dc, ptlPixel.x, ptlPixel.y, crColor );
04512     }
04513 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04514 <font class="preprocessor"></font>
04517     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04518 <font class="keyword">    </font>{
04519       printf( <font class="stringliteral">"*SETPIXELV*\n"</font> );
04520       edit_pointl( <font class="stringliteral">"ptlPixel"</font>, ptlPixel );
04521       edit_color( <font class="stringliteral">"crColor\t"</font>, crColor );
04522     }
04523 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04524   };
04525 
04526   <font class="keyword">class </font>PEN;
04527   <font class="keyword">class </font>EXTPEN;
04528   <font class="keyword">class </font>BRUSH;
04529   <font class="keyword">class </font>FONT;
04530   <font class="keyword">class </font>PALETTE;
04531 
04533 
<a name="l04536"></a><a class="code" href="classEMF_1_1EMRCREATEPEN.html">04536</a>   <font class="keyword">class </font>EMRCREATEPEN : <font class="keyword">public</font> METARECORD, <font class="keyword">public</font> ::EMRCREATEPEN
04537   {
04538   <font class="keyword">public</font>:
04543     <a class="code" href="classEMF_1_1EMRCREATEPEN.html#a0">EMRCREATEPEN</a> ( PEN* pen, HGDIOBJ handle );
04548     <a class="code" href="classEMF_1_1EMRCREATEPEN.html#a0">EMRCREATEPEN</a> ( DATASTREAM&amp; ds );
<a name="l04552"></a><a class="code" href="classEMF_1_1EMRCREATEPEN.html#a2">04552</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRCREATEPEN.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04553 <font class="keyword">    </font>{
04554       ds &lt;&lt; emr &lt;&lt; ihPen &lt;&lt; lopn;
04555       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04556     }
<a name="l04560"></a><a class="code" href="classEMF_1_1EMRCREATEPEN.html#a3">04560</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRCREATEPEN.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
04566     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRCREATEPEN.html#a4">execute</a> ( METAFILEDEVICECONTEXT* source, HDC dc ) <font class="keyword">const</font>;
04567 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04568 <font class="preprocessor"></font>
04571     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04572 <font class="keyword">    </font>{
04573       printf( <font class="stringliteral">"*CREATEPEN*\n"</font> );
04574       printf( <font class="stringliteral">"\tihPen\t\t: 0x%lx\n"</font>, ihPen );
04575       edit_pen_style( <font class="stringliteral">"lopn.lopnStyle"</font>, lopn.lopnStyle );
04576       printf( <font class="stringliteral">"\tlopn.lopnWidth\t: %ld, %ld\n"</font>, lopn.lopnWidth.x, lopn.lopnWidth.y );
04577       edit_color( <font class="stringliteral">"lopn.lopnColor"</font>, lopn.lopnColor );
04578     }
04579 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04580   };
04581 
04583 
<a name="l04587"></a><a class="code" href="classEMF_1_1EMREXTCREATEPEN.html">04587</a>   <font class="keyword">class </font>EMREXTCREATEPEN : <font class="keyword">public</font> METARECORD, <font class="keyword">public</font> ::EMREXTCREATEPEN
04588   {
04589   <font class="keyword">public</font>:
04594     <a class="code" href="classEMF_1_1EMREXTCREATEPEN.html#a0">EMREXTCREATEPEN</a> ( EXTPEN* pen, HGDIOBJ handle );
04599     <a class="code" href="classEMF_1_1EMREXTCREATEPEN.html#a0">EMREXTCREATEPEN</a> ( DATASTREAM&amp; ds );
<a name="l04603"></a><a class="code" href="classEMF_1_1EMREXTCREATEPEN.html#a2">04603</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMREXTCREATEPEN.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04604 <font class="keyword">    </font>{
04605       ds &lt;&lt; emr &lt;&lt; ihPen &lt;&lt; offBmi &lt;&lt; cbBmi &lt;&lt; offBits &lt;&lt; cbBits &lt;&lt; elp;
04606       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04607     }
<a name="l04611"></a><a class="code" href="classEMF_1_1EMREXTCREATEPEN.html#a3">04611</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMREXTCREATEPEN.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
04617     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMREXTCREATEPEN.html#a4">execute</a> ( METAFILEDEVICECONTEXT* source, HDC dc ) <font class="keyword">const</font>;
04618 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04619 <font class="preprocessor"></font>
04622     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04623 <font class="keyword">    </font>{
04624       printf( <font class="stringliteral">"*EXTCREATEPEN*\n"</font> );
04625       printf( <font class="stringliteral">"\tihPen\t\t\t: 0x%lx\n"</font>, ihPen );
04626       printf( <font class="stringliteral">"\toffBmi\t\t\t: %ld\n"</font>,  offBmi );
04627       printf( <font class="stringliteral">"\tcbBmi\t\t\t: %ld\n"</font>, cbBmi );
04628       printf( <font class="stringliteral">"\toffBits\t\t\t: %ld\n"</font>, offBits );
04629       printf( <font class="stringliteral">"\tcbBits\t\t\t: %ld\n"</font>, cbBits );
04630       edit_pen_style( <font class="stringliteral">"elp.elpPenStyle\t"</font>, elp.elpPenStyle );
04631       printf( <font class="stringliteral">"\telp.elpWidth\t\t: %ld\n"</font>, elp.elpWidth );
04632       edit_brush_style( <font class="stringliteral">"elp.elpBrushStyle"</font>, elp.elpBrushStyle );
04633       edit_color( <font class="stringliteral">"elp.elpColor\t"</font>, elp.elpColor );
04634       edit_brush_hatch( <font class="stringliteral">"elp.elpHatch\t"</font>, elp.elpHatch );
04635       printf( <font class="stringliteral">"\telp.elpNumEntries\t: %ld\n"</font>, elp.elpNumEntries );
04636     }
04637 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04638   };
04639 
04641 
<a name="l04644"></a><a class="code" href="classEMF_1_1EMRCREATEBRUSHINDIRECT.html">04644</a>   <font class="keyword">class </font>EMRCREATEBRUSHINDIRECT : <font class="keyword">public</font> METARECORD, <font class="keyword">public</font> ::EMRCREATEBRUSHINDIRECT
04645   {
04646   <font class="keyword">public</font>:
04651     <a class="code" href="classEMF_1_1EMRCREATEBRUSHINDIRECT.html#a0">EMRCREATEBRUSHINDIRECT</a> ( BRUSH* brush, HGDIOBJ handle );
04656     <a class="code" href="classEMF_1_1EMRCREATEBRUSHINDIRECT.html#a0">EMRCREATEBRUSHINDIRECT</a> ( DATASTREAM&amp; ds );
<a name="l04660"></a><a class="code" href="classEMF_1_1EMRCREATEBRUSHINDIRECT.html#a2">04660</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRCREATEBRUSHINDIRECT.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04661 <font class="keyword">    </font>{
04662       ds &lt;&lt; emr &lt;&lt; ihBrush &lt;&lt; lb;
04663       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04664     }
<a name="l04668"></a><a class="code" href="classEMF_1_1EMRCREATEBRUSHINDIRECT.html#a3">04668</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRCREATEBRUSHINDIRECT.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
04674     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRCREATEBRUSHINDIRECT.html#a4">execute</a> ( METAFILEDEVICECONTEXT* source, HDC dc ) <font class="keyword">const</font>;
04675 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04676 <font class="preprocessor"></font>
04679     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04680 <font class="keyword">    </font>{
04681       printf( <font class="stringliteral">"*CREATEBRUSHINDIRECT*\n"</font> );
04682       printf( <font class="stringliteral">"\tihBrush\t\t: 0x%lx\n"</font>, ihBrush );
04683       edit_brush_style( <font class="stringliteral">"lb.lbStyle"</font>, lb.lbStyle );
04684       edit_color( <font class="stringliteral">"lb.lbColor"</font>, lb.lbColor );
04685       edit_brush_hatch( <font class="stringliteral">"lb.lbHatch"</font>, lb.lbHatch );
04686     }
04687 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04688   };
04689 
04691 
<a name="l04694"></a><a class="code" href="classEMF_1_1EMREXTCREATEFONTINDIRECTW.html">04694</a>   <font class="keyword">class </font>EMREXTCREATEFONTINDIRECTW : <font class="keyword">public</font> METARECORD, <font class="keyword">public</font> ::EMREXTCREATEFONTINDIRECTW
04695   {
04696   <font class="keyword">public</font>:
04701     <a class="code" href="classEMF_1_1EMREXTCREATEFONTINDIRECTW.html#a0">EMREXTCREATEFONTINDIRECTW</a> ( FONT* font, HGDIOBJ handle );
04706     <a class="code" href="classEMF_1_1EMREXTCREATEFONTINDIRECTW.html#a0">EMREXTCREATEFONTINDIRECTW</a> ( DATASTREAM&amp; ds );
<a name="l04710"></a><a class="code" href="classEMF_1_1EMREXTCREATEFONTINDIRECTW.html#a2">04710</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMREXTCREATEFONTINDIRECTW.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04711 <font class="keyword">    </font>{
04712       <font class="comment">// Since EMF records have to be multiples of 4 bytes, this</font>
04713       <font class="comment">// should perhaps be a general thing, but we know it's currently</font>
04714       <font class="comment">// only a problem for this structure.</font>
04715 
04716       ds &lt;&lt; emr &lt;&lt; ihFont &lt;&lt; elfw &lt;&lt; PADDING( 2 );
04717 
04718       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04719     }
<a name="l04723"></a><a class="code" href="classEMF_1_1EMREXTCREATEFONTINDIRECTW.html#a3">04723</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMREXTCREATEFONTINDIRECTW.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
04729     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMREXTCREATEFONTINDIRECTW.html#a4">execute</a> ( METAFILEDEVICECONTEXT* source, HDC dc ) <font class="keyword">const</font>;
04730 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04731 <font class="preprocessor"></font>
04734     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04735 <font class="keyword">    </font>{
04736       printf( <font class="stringliteral">"*EXTCREATEFONTINDIRECTW*\n"</font> );
04737       printf( <font class="stringliteral">"\tihFont\t\t\t: %ld\n"</font>, ihFont );
04738       printf( <font class="stringliteral">"\tlfHeight\t\t: %ld\n"</font>, elfw.elfLogFont.lfHeight );
04739       printf( <font class="stringliteral">"\tlfWidth\t\t\t: %ld\n"</font>, elfw.elfLogFont.lfWidth );
04740       printf( <font class="stringliteral">"\tlfEscapement\t\t: %ld\n"</font>, elfw.elfLogFont.lfEscapement );
04741       printf( <font class="stringliteral">"\tlfOrientation\t\t: %ld\n"</font>, elfw.elfLogFont.lfOrientation );
04742       printf( <font class="stringliteral">"\tlfWeight\t\t: "</font> );
04743       <font class="keywordflow">switch</font> ( elfw.elfLogFont.lfWeight ) {
04744       <font class="keywordflow">case</font> FW_DONTCARE: printf( <font class="stringliteral">"FW_DONTCARE\n"</font> ); <font class="keywordflow">break</font>;
04745       <font class="keywordflow">case</font> FW_THIN: printf( <font class="stringliteral">"FW_THIN\n"</font> ); <font class="keywordflow">break</font>;
04746       <font class="keywordflow">case</font> FW_EXTRALIGHT: printf( <font class="stringliteral">"FW_EXTRALIGHT\n"</font> ); <font class="keywordflow">break</font>;
04747       <font class="keywordflow">case</font> FW_LIGHT: printf( <font class="stringliteral">"FW_LIGHT\n"</font> ); <font class="keywordflow">break</font>;
04748       <font class="keywordflow">case</font> FW_NORMAL: printf( <font class="stringliteral">"FW_NORMAL\n"</font> ); <font class="keywordflow">break</font>;
04749       <font class="keywordflow">case</font> FW_MEDIUM: printf( <font class="stringliteral">"FW_MEDIUM\n"</font> ); <font class="keywordflow">break</font>;
04750       <font class="keywordflow">case</font> FW_SEMIBOLD: printf( <font class="stringliteral">"FW_SEMIBOLD\n"</font> ); <font class="keywordflow">break</font>;
04751       <font class="keywordflow">case</font> FW_BOLD: printf( <font class="stringliteral">"FW_BOLD\n"</font> ); <font class="keywordflow">break</font>;
04752       <font class="keywordflow">case</font> FW_EXTRABOLD: printf( <font class="stringliteral">"FW_EXTRABOLD\n"</font> ); <font class="keywordflow">break</font>;
04753       <font class="keywordflow">case</font> FW_BLACK: printf( <font class="stringliteral">"FW_BLACK\n"</font> ); <font class="keywordflow">break</font>;
04754       }
04755       printf( <font class="stringliteral">"\tlfItalic\t\t: %d\n"</font>, elfw.elfLogFont.lfItalic );
04756       printf( <font class="stringliteral">"\tlfUnderline\t\t: %d\n"</font>, elfw.elfLogFont.lfUnderline );
04757       printf( <font class="stringliteral">"\tlfStrikeOut\t\t: %d\n"</font>, elfw.elfLogFont.lfStrikeOut );
04758       printf( <font class="stringliteral">"\tlfCharSet\t\t: %d\n"</font>, elfw.elfLogFont.lfCharSet );
04759       printf( <font class="stringliteral">"\tlfOutPrecision\t\t: %d\n"</font>, elfw.elfLogFont.lfOutPrecision );
04760       printf( <font class="stringliteral">"\tlfClipPrecision\t\t: %d\n"</font>, elfw.elfLogFont.lfClipPrecision );
04761       printf( <font class="stringliteral">"\tlfQuality\t\t: %d\n"</font>, elfw.elfLogFont.lfQuality );
04762       printf( <font class="stringliteral">"\tlfPitchAndFamily\t: %d\n"</font>, elfw.elfLogFont.lfPitchAndFamily );
04763       <font class="keywordtype">int</font> i = 0;
04764       printf( <font class="stringliteral">"\tlfFaceName\t\t: '"</font> );
04765       <font class="keywordflow">while</font> ( elfw.elfLogFont.lfFaceName[i] != 0 &amp;&amp; i &lt; LF_FACESIZE ) {
04766         putchar( elfw.elfLogFont.lfFaceName[i] );
04767         i++;
04768       }
04769       puts( <font class="stringliteral">"'"</font> );
04770 
04771       i = 0;
04772       printf( <font class="stringliteral">"\telfFullName\t\t: '"</font> );
04773       <font class="keywordflow">while</font> ( elfw.elfFullName[i] != 0 &amp;&amp; i &lt; LF_FULLFACESIZE ) {
04774         putchar( elfw.elfFullName[i] );
04775         i++;
04776       }
04777       puts( <font class="stringliteral">"'"</font> );
04778 
04779       i = 0;
04780       printf( <font class="stringliteral">"\telfStyle\t\t: '"</font> );
04781       <font class="keywordflow">while</font> ( elfw.elfStyle[i] != 0 &amp;&amp; i &lt; LF_FACESIZE ) {
04782         putchar( elfw.elfStyle[i] );
04783         i++;
04784       }
04785       puts( <font class="stringliteral">"'"</font> );
04786 
04787       printf( <font class="stringliteral">"\telfVersion\t\t: %ld\n"</font>, elfw.elfVersion );
04788       printf( <font class="stringliteral">"\telfStyleSize\t\t: %ld\n"</font>, elfw.elfStyleSize );
04789       printf( <font class="stringliteral">"\telfMatch\t\t: %ld\n"</font>, elfw.elfMatch );
04790       printf( <font class="stringliteral">"\telfVendorId\t\t: '%s'\n"</font>, elfw.elfVendorId );
04791       printf( <font class="stringliteral">"\telfCulture\t\t: %ld\n"</font>, elfw.elfCulture );
04792       printf( <font class="stringliteral">"\telfPanose\t\t:\n"</font> );
04793       printf( <font class="stringliteral">"\t\tbFamilyType\t\t: %d\n"</font>, elfw.elfPanose.bFamilyType );
04794       printf( <font class="stringliteral">"\t\tbSerifStyle\t\t: %d\n"</font>, elfw.elfPanose.bSerifStyle );
04795       printf( <font class="stringliteral">"\t\tbWeight\t\t\t: %d\n"</font>, elfw.elfPanose.bWeight );
04796       printf( <font class="stringliteral">"\t\tbProportion\t\t: %d\n"</font>, elfw.elfPanose.bProportion );
04797       printf( <font class="stringliteral">"\t\tbContrast\t\t: %d\n"</font>, elfw.elfPanose.bContrast );
04798       printf( <font class="stringliteral">"\t\tbStrokeVariation\t: %d\n"</font>, elfw.elfPanose.bStrokeVariation );
04799       printf( <font class="stringliteral">"\t\tbArmStyle\t\t: %d\n"</font>, elfw.elfPanose.bArmStyle );
04800       printf( <font class="stringliteral">"\t\tbLetterform\t\t: %d\n"</font>, elfw.elfPanose.bLetterform );
04801       printf( <font class="stringliteral">"\t\tbMidline\t\t: %d\n"</font>, elfw.elfPanose.bMidline );
04802       printf( <font class="stringliteral">"\t\tbXHeight\t\t: %d\n"</font>, elfw.elfPanose.bXHeight );
04803     }
04804 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04805   };
04806 
04808 
<a name="l04811"></a><a class="code" href="classEMF_1_1EMRCREATEPALETTE.html">04811</a>   <font class="keyword">class </font>EMRCREATEPALETTE : <font class="keyword">public</font> METARECORD, <font class="keyword">public</font> ::EMRCREATEPALETTE
04812   {
04813   <font class="keyword">public</font>:
04818     <a class="code" href="classEMF_1_1EMRCREATEPALETTE.html#a0">EMRCREATEPALETTE</a> ( PALETTE* palette, HGDIOBJ handle );
04823     <a class="code" href="classEMF_1_1EMRCREATEPALETTE.html#a0">EMRCREATEPALETTE</a> ( DATASTREAM&amp; ds );
<a name="l04827"></a><a class="code" href="classEMF_1_1EMRCREATEPALETTE.html#a2">04827</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRCREATEPALETTE.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04828 <font class="keyword">    </font>{
04829       ds &lt;&lt; emr &lt;&lt; ihPal &lt;&lt; lgpl;
04830       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04831     }
<a name="l04835"></a><a class="code" href="classEMF_1_1EMRCREATEPALETTE.html#a3">04835</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRCREATEPALETTE.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
04841     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRCREATEPALETTE.html#a4">execute</a> ( METAFILEDEVICECONTEXT* source, HDC dc ) <font class="keyword">const</font>;
04842 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04843 <font class="preprocessor"></font>
04846     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04847 <font class="keyword">    </font>{
04848       printf( <font class="stringliteral">"*CREATEPALETTE* (not really handled by libEMF)\n"</font> );
04849     }
04850 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04851   };
04852 
04854 
<a name="l04857"></a><a class="code" href="classEMF_1_1EMRFILLPATH.html">04857</a>   <font class="keyword">class </font>EMRFILLPATH : <font class="keyword">public</font> METARECORD, ::EMRFILLPATH {
04858   <font class="keyword">public</font>:
<a name="l04863"></a><a class="code" href="classEMF_1_1EMRFILLPATH.html#a0">04863</a>     <a class="code" href="classEMF_1_1EMRFILLPATH.html#a0">EMRFILLPATH</a> ( <font class="keyword">const</font> RECTL* bounds )<font class="keyword"></font>
04864 <font class="keyword">    </font>{
04865       emr.iType = EMR_FILLPATH;
04866       emr.nSize = <font class="keyword">sizeof</font>( ::EMRFILLPATH );
04867       rclBounds = *bounds;
04868     }
<a name="l04873"></a><a class="code" href="classEMF_1_1EMRFILLPATH.html#a1">04873</a>     <a class="code" href="classEMF_1_1EMRFILLPATH.html#a0">EMRFILLPATH</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
04874 <font class="keyword">    </font>{
04875       ds &gt;&gt; emr &gt;&gt; rclBounds;
04876     }
<a name="l04880"></a><a class="code" href="classEMF_1_1EMRFILLPATH.html#a2">04880</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRFILLPATH.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04881 <font class="keyword">    </font>{
04882       ds &lt;&lt; emr &lt;&lt; rclBounds;
04883       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04884     }
<a name="l04888"></a><a class="code" href="classEMF_1_1EMRFILLPATH.html#a3">04888</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRFILLPATH.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l04894"></a><a class="code" href="classEMF_1_1EMRFILLPATH.html#a4">04894</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRFILLPATH.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
04895 <font class="keyword">    </font>{
04896       FillPath( dc );
04897     }
04898 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04899 <font class="preprocessor"></font>
04902     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04903 <font class="keyword">    </font>{
04904       printf( <font class="stringliteral">"*FILLPATH*\n"</font> );
04905       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
04906     }
04907 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04908   };
04910 
<a name="l04913"></a><a class="code" href="classEMF_1_1EMRSTROKEPATH.html">04913</a>   <font class="keyword">class </font>EMRSTROKEPATH : <font class="keyword">public</font> METARECORD, ::EMRSTROKEPATH {
04914   <font class="keyword">public</font>:
<a name="l04919"></a><a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a0">04919</a>     <a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a0">EMRSTROKEPATH</a> ( <font class="keyword">const</font> RECTL* bounds )<font class="keyword"></font>
04920 <font class="keyword">    </font>{
04921       emr.iType = EMR_STROKEPATH;
04922       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSTROKEPATH );
04923       rclBounds = *bounds;
04924     }
<a name="l04929"></a><a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a1">04929</a>     <a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a0">EMRSTROKEPATH</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
04930 <font class="keyword">    </font>{
04931       ds &gt;&gt; emr &gt;&gt; rclBounds;
04932     }
<a name="l04936"></a><a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a2">04936</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04937 <font class="keyword">    </font>{
04938       ds &lt;&lt; emr &lt;&lt; rclBounds;
04939       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04940     }
<a name="l04944"></a><a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a3">04944</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l04950"></a><a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a4">04950</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
04951 <font class="keyword">    </font>{
04952       StrokePath( dc );
04953     }
04954 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04955 <font class="preprocessor"></font>
04958     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04959 <font class="keyword">    </font>{
04960       printf( <font class="stringliteral">"*STROKEPATH*\n"</font> );
04961       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
04962     }
04963 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04964   };
04966 
<a name="l04969"></a><a class="code" href="classEMF_1_1EMRBEGINPATH.html">04969</a>   <font class="keyword">class </font>EMRBEGINPATH : <font class="keyword">public</font> METARECORD, ::EMRBEGINPATH {
04970   <font class="keyword">public</font>:
<a name="l04974"></a><a class="code" href="classEMF_1_1EMRBEGINPATH.html#a0">04974</a>     <a class="code" href="classEMF_1_1EMRBEGINPATH.html#a0">EMRBEGINPATH</a> ( <font class="keywordtype">void</font> )<font class="keyword"></font>
04975 <font class="keyword">    </font>{
04976       emr.iType = EMR_BEGINPATH;
04977       emr.nSize = <font class="keyword">sizeof</font>( ::EMRBEGINPATH );
04978     }
<a name="l04983"></a><a class="code" href="classEMF_1_1EMRBEGINPATH.html#a1">04983</a>     <a class="code" href="classEMF_1_1EMRBEGINPATH.html#a0">EMRBEGINPATH</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
04984 <font class="keyword">    </font>{
04985       ds &gt;&gt; emr;
04986     }
<a name="l04990"></a><a class="code" href="classEMF_1_1EMRBEGINPATH.html#a2">04990</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRBEGINPATH.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04991 <font class="keyword">    </font>{
04992       ds &lt;&lt; emr;
04993       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04994     }
<a name="l04998"></a><a class="code" href="classEMF_1_1EMRBEGINPATH.html#a3">04998</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRBEGINPATH.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l05004"></a><a class="code" href="classEMF_1_1EMRBEGINPATH.html#a4">05004</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRBEGINPATH.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
05005 <font class="keyword">    </font>{
05006       BeginPath( dc );
05007     }
05008 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
05009 <font class="preprocessor"></font>
05012     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
05013 <font class="keyword">    </font>{
05014       printf( <font class="stringliteral">"*BEGINPATH*\n"</font> );
05015     }
05016 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
05017   };
05019 
<a name="l05022"></a><a class="code" href="classEMF_1_1EMRENDPATH.html">05022</a>   <font class="keyword">class </font>EMRENDPATH : <font class="keyword">public</font> METARECORD, ::EMRENDPATH {
05023   <font class="keyword">public</font>:
<a name="l05027"></a><a class="code" href="classEMF_1_1EMRENDPATH.html#a0">05027</a>     <a class="code" href="classEMF_1_1EMRENDPATH.html#a0">EMRENDPATH</a> ( <font class="keywordtype">void</font> )<font class="keyword"></font>
05028 <font class="keyword">    </font>{
05029       emr.iType = EMR_ENDPATH;
05030       emr.nSize = <font class="keyword">sizeof</font>( ::EMRENDPATH );
05031     }
<a name="l05036"></a><a class="code" href="classEMF_1_1EMRENDPATH.html#a1">05036</a>     <a class="code" href="classEMF_1_1EMRENDPATH.html#a0">EMRENDPATH</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
05037 <font class="keyword">    </font>{
05038       ds &gt;&gt; emr;
05039     }
<a name="l05043"></a><a class="code" href="classEMF_1_1EMRENDPATH.html#a2">05043</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRENDPATH.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
05044 <font class="keyword">    </font>{
05045       ds &lt;&lt; emr;
05046       <font class="keywordflow">return</font> <font class="keyword">true</font>;
05047     }
<a name="l05051"></a><a class="code" href="classEMF_1_1EMRENDPATH.html#a3">05051</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRENDPATH.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l05057"></a><a class="code" href="classEMF_1_1EMRENDPATH.html#a4">05057</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRENDPATH.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
05058 <font class="keyword">    </font>{
05059       EndPath( dc );
05060     }
05061 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
05062 <font class="preprocessor"></font>
05065     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
05066 <font class="keyword">    </font>{
05067       printf( <font class="stringliteral">"*ENDPATH*\n"</font> );
05068     }
05069 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
05070   };
05072 
<a name="l05075"></a><a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html">05075</a>   <font class="keyword">class </font>EMRCLOSEFIGURE : <font class="keyword">public</font> METARECORD, ::EMRCLOSEFIGURE {
05076   <font class="keyword">public</font>:
<a name="l05080"></a><a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a0">05080</a>     <a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a0">EMRCLOSEFIGURE</a> ( <font class="keywordtype">void</font> )<font class="keyword"></font>
05081 <font class="keyword">    </font>{
05082       emr.iType = EMR_CLOSEFIGURE;
05083       emr.nSize = <font class="keyword">sizeof</font>( ::EMRCLOSEFIGURE );
05084     }
<a name="l05089"></a><a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a1">05089</a>     <a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a0">EMRCLOSEFIGURE</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
05090 <font class="keyword">    </font>{
05091       ds &gt;&gt; emr;
05092     }
<a name="l05096"></a><a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a2">05096</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
05097 <font class="keyword">    </font>{
05098       ds &lt;&lt; emr;
05099       <font class="keywordflow">return</font> <font class="keyword">true</font>;
05100     }
<a name="l05104"></a><a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a3">05104</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l05110"></a><a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a4">05110</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
05111 <font class="keyword">    </font>{
05112       CloseFigure( dc );
05113     }
05114 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
05115 <font class="preprocessor"></font>
05118     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
05119 <font class="keyword">    </font>{
05120       printf( <font class="stringliteral">"*CLOSEFIGURE*\n"</font> );
05121     }
05122 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
05123   };
05125 
<a name="l05129"></a><a class="code" href="classEMF_1_1EMRSAVEDC.html">05129</a>   <font class="keyword">class </font>EMRSAVEDC : <font class="keyword">public</font> METARECORD, ::EMRSAVEDC {
05130   <font class="keyword">public</font>:
<a name="l05134"></a><a class="code" href="classEMF_1_1EMRSAVEDC.html#a0">05134</a>     <a class="code" href="classEMF_1_1EMRSAVEDC.html#a0">EMRSAVEDC</a> ( <font class="keywordtype">void</font> )<font class="keyword"></font>
05135 <font class="keyword">    </font>{
05136       emr.iType = EMR_SAVEDC;
05137       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSAVEDC );
05138     }
<a name="l05143"></a><a class="code" href="classEMF_1_1EMRSAVEDC.html#a1">05143</a>     <a class="code" href="classEMF_1_1EMRSAVEDC.html#a0">EMRSAVEDC</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
05144 <font class="keyword">    </font>{
05145       ds &gt;&gt; emr;
05146     }
<a name="l05150"></a><a class="code" href="classEMF_1_1EMRSAVEDC.html#a2">05150</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSAVEDC.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
05151 <font class="keyword">    </font>{
05152       ds &lt;&lt; emr;
05153       <font class="keywordflow">return</font> <font class="keyword">true</font>;
05154     }
<a name="l05158"></a><a class="code" href="classEMF_1_1EMRSAVEDC.html#a3">05158</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSAVEDC.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l05164"></a><a class="code" href="classEMF_1_1EMRSAVEDC.html#a4">05164</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSAVEDC.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
05165 <font class="keyword">    </font>{
05166       SaveDC( dc );
05167     }
05168 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
05169 <font class="preprocessor"></font>
05172     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
05173 <font class="keyword">    </font>{
05174       printf( <font class="stringliteral">"*SAVEDC*\n"</font> );
05175     }
05176 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
05177   };
05179 
<a name="l05182"></a><a class="code" href="classEMF_1_1EMRRESTOREDC.html">05182</a>   <font class="keyword">class </font>EMRRESTOREDC : <font class="keyword">public</font> METARECORD, ::EMRRESTOREDC {
05183   <font class="keyword">public</font>:
<a name="l05187"></a><a class="code" href="classEMF_1_1EMRRESTOREDC.html#a0">05187</a>     <a class="code" href="classEMF_1_1EMRRESTOREDC.html#a0">EMRRESTOREDC</a> ( INT n )<font class="keyword"></font>
05188 <font class="keyword">    </font>{
05189       emr.iType = EMR_RESTOREDC;
05190       emr.nSize = <font class="keyword">sizeof</font>( ::EMRRESTOREDC );
05191       iRelative = n;
05192     }
<a name="l05197"></a><a class="code" href="classEMF_1_1EMRRESTOREDC.html#a1">05197</a>     <a class="code" href="classEMF_1_1EMRRESTOREDC.html#a0">EMRRESTOREDC</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
05198 <font class="keyword">    </font>{
05199       ds &gt;&gt; emr &gt;&gt; iRelative;
05200     }
<a name="l05204"></a><a class="code" href="classEMF_1_1EMRRESTOREDC.html#a2">05204</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRRESTOREDC.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
05205 <font class="keyword">    </font>{
05206       ds &lt;&lt; emr &lt;&lt; iRelative;
05207       <font class="keywordflow">return</font> <font class="keyword">true</font>;
05208     }
<a name="l05212"></a><a class="code" href="classEMF_1_1EMRRESTOREDC.html#a3">05212</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRRESTOREDC.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l05218"></a><a class="code" href="classEMF_1_1EMRRESTOREDC.html#a4">05218</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRRESTOREDC.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
05219 <font class="keyword">    </font>{
05220       RestoreDC( dc, iRelative );
05221     }
05222 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
05223 <font class="preprocessor"></font>
05226     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
05227 <font class="keyword">    </font>{
05228       printf( <font class="stringliteral">"*RESTOREDC*\n"</font> );
05229       printf( <font class="stringliteral">"\tiRelative: %ld\n"</font>, iRelative );
05230     }
05231 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
05232   };
05234 
<a name="l05237"></a><a class="code" href="classEMF_1_1EMRSETMETARGN.html">05237</a>   <font class="keyword">class </font>EMRSETMETARGN : <font class="keyword">public</font> METARECORD, ::EMRSETMETARGN {
05238   <font class="keyword">public</font>:
<a name="l05242"></a><a class="code" href="classEMF_1_1EMRSETMETARGN.html#a0">05242</a>     <a class="code" href="classEMF_1_1EMRSETMETARGN.html#a0">EMRSETMETARGN</a> ( <font class="keywordtype">void</font> )<font class="keyword"></font>
05243 <font class="keyword">    </font>{
05244       emr.iType = EMR_SETMETARGN;
05245       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETMETARGN );
05246     }
<a name="l05251"></a><a class="code" href="classEMF_1_1EMRSETMETARGN.html#a1">05251</a>     <a class="code" href="classEMF_1_1EMRSETMETARGN.html#a0">EMRSETMETARGN</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
05252 <font class="keyword">    </font>{
05253       ds &gt;&gt; emr;
05254     }
<a name="l05258"></a><a class="code" href="classEMF_1_1EMRSETMETARGN.html#a2">05258</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETMETARGN.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
05259 <font class="keyword">    </font>{
05260       ds &lt;&lt; emr;
05261       <font class="keywordflow">return</font> <font class="keyword">true</font>;
05262     }
<a name="l05266"></a><a class="code" href="classEMF_1_1EMRSETMETARGN.html#a3">05266</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETMETARGN.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l05272"></a><a class="code" href="classEMF_1_1EMRSETMETARGN.html#a4">05272</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETMETARGN.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
05273 <font class="keyword">    </font>{
05274       SetMetaRgn( dc );
05275     }
05276 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
05277 <font class="preprocessor"></font>
05280     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
05281 <font class="keyword">    </font>{
05282       printf( <font class="stringliteral">"*SETMETARGN*\n"</font> );
05283     }
05284 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
05285   };
05286 
05288 
<a name="l05291"></a><a class="code" href="classEMF_1_1PEN.html">05291</a>   <font class="keyword">class </font>PEN : <font class="keyword">public</font> GRAPHICSOBJECT, <font class="keyword">public</font> LOGPEN {
05292   <font class="keyword">public</font>:
<a name="l05296"></a><a class="code" href="classEMF_1_1PEN.html#a0">05296</a>     <a class="code" href="classEMF_1_1PEN.html#a0">PEN</a> ( <font class="keyword">const</font> LOGPEN* lpen )<font class="keyword"></font>
05297 <font class="keyword">    </font>{
05298       lopnStyle = lpen-&gt;lopnStyle;
05299       lopnWidth = lpen-&gt;lopnWidth;
05300       lopnColor = lpen-&gt;lopnColor;
05301     }
<a name="l05305"></a><a class="code" href="classEMF_1_1PEN.html#a1">05305</a>     OBJECTTYPE <a class="code" href="classEMF_1_1PEN.html#a1">getType</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> O_PEN; }
<a name="l05312"></a><a class="code" href="classEMF_1_1PEN.html#a2">05312</a>     METARECORD* <a class="code" href="classEMF_1_1PEN.html#a2">newEMR</a> ( HDC dc, HGDIOBJ emf_handle )<font class="keyword"></font>
05313 <font class="keyword">    </font>{
05314       contexts[dc] = emf_handle;
05315       <font class="keywordflow">return</font> <font class="keyword">new</font> EMRCREATEPEN( <font class="keyword">this</font>, emf_handle );
05316     }
05317   };
05318 
05320 
<a name="l05323"></a><a class="code" href="classEMF_1_1EXTPEN.html">05323</a>   <font class="keyword">class </font>EXTPEN : <font class="keyword">public</font> GRAPHICSOBJECT, <font class="keyword">public</font> EXTLOGPEN {
05324   <font class="keyword">public</font>:
<a name="l05328"></a><a class="code" href="classEMF_1_1EXTPEN.html#a0">05328</a>     <a class="code" href="classEMF_1_1EXTPEN.html#a0">EXTPEN</a> ( <font class="keyword">const</font> EXTLOGPEN* lpen )<font class="keyword"></font>
05329 <font class="keyword">    </font>{
05330       elpPenStyle = lpen-&gt;elpPenStyle;
05331       elpWidth = lpen-&gt;elpWidth;
05332       elpBrushStyle = lpen-&gt;elpBrushStyle;
05333       elpColor = lpen-&gt;elpColor;
05334       elpHatch = lpen-&gt;elpHatch;
05335       elpNumEntries = 0;
05336       elpStyleEntry[0] = 0;
05337     }
<a name="l05341"></a><a class="code" href="classEMF_1_1EXTPEN.html#a1">05341</a>     OBJECTTYPE <a class="code" href="classEMF_1_1EXTPEN.html#a1">getType</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> O_EXTPEN; }
<a name="l05348"></a><a class="code" href="classEMF_1_1EXTPEN.html#a2">05348</a>     METARECORD* <a class="code" href="classEMF_1_1EXTPEN.html#a2">newEMR</a> ( HDC dc, HGDIOBJ emf_handle )<font class="keyword"></font>
05349 <font class="keyword">    </font>{
05350       contexts[dc] = emf_handle;
05351       <font class="keywordflow">return</font> <font class="keyword">new</font> EMREXTCREATEPEN( <font class="keyword">this</font>, emf_handle );
05352     }
05353   };
05354 
05356 
<a name="l05359"></a><a class="code" href="classEMF_1_1BRUSH.html">05359</a>   <font class="keyword">class </font>BRUSH : <font class="keyword">public</font> GRAPHICSOBJECT, <font class="keyword">public</font> LOGBRUSH {
05360   <font class="keyword">public</font>:
<a name="l05364"></a><a class="code" href="classEMF_1_1BRUSH.html#a0">05364</a>     <a class="code" href="classEMF_1_1BRUSH.html#a0">BRUSH</a> ( <font class="keyword">const</font> LOGBRUSH* lbrush )<font class="keyword"></font>
05365 <font class="keyword">    </font>{
05366       lbStyle = lbrush-&gt;lbStyle;
05367       lbColor = lbrush-&gt;lbColor;
05368       lbHatch = lbrush-&gt;lbHatch;
05369     }
<a name="l05373"></a><a class="code" href="classEMF_1_1BRUSH.html#a1">05373</a>     OBJECTTYPE <a class="code" href="classEMF_1_1BRUSH.html#a1">getType</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> O_BRUSH; }
<a name="l05380"></a><a class="code" href="classEMF_1_1BRUSH.html#a2">05380</a>     METARECORD* <a class="code" href="classEMF_1_1BRUSH.html#a2">newEMR</a> ( HDC dc, HGDIOBJ emf_handle )<font class="keyword"></font>
05381 <font class="keyword">    </font>{
05382       contexts[dc] = emf_handle;
05383       <font class="keywordflow">return</font> <font class="keyword">new</font> EMRCREATEBRUSHINDIRECT( <font class="keyword">this</font>, emf_handle );
05384     }
05385   };
05386 
05388 
<a name="l05391"></a><a class="code" href="classEMF_1_1FONT.html">05391</a>   <font class="keyword">class </font>FONT : <font class="keyword">public</font> GRAPHICSOBJECT, <font class="keyword">public</font> EXTLOGFONTW {
05392   <font class="keyword">public</font>:
<a name="l05396"></a><a class="code" href="classEMF_1_1FONT.html#a0">05396</a>     <a class="code" href="classEMF_1_1FONT.html#a0">FONT</a> ( <font class="keyword">const</font> LOGFONTW* lfont )<font class="keyword"></font>
05397 <font class="keyword">    </font>{
05398       this-&gt;elfLogFont = *lfont;
05399       <font class="comment">// There are a lot more entries in the EXTLOGFONTW structure than</font>
05400       <font class="comment">// the API has values for, so we invent them here</font>
05401       memset( &amp;elfFullName, 0, <font class="keyword">sizeof</font> elfFullName );
05402       memset( &amp;elfStyle, 0, <font class="keyword">sizeof</font> elfStyle );
05403       elfVersion = ELF_VERSION;
05404       elfStyleSize = 0;
05405       elfMatch = 0;
05406       elfReserved = 0;
05407       memset( &amp;elfVendorId, 0, <font class="keyword">sizeof</font> elfVendorId );
05408       elfCulture = ELF_CULTURE_LATIN;
05409       memset( &amp;elfPanose, 1, <font class="keyword">sizeof</font>(PANOSE) );
05410     }
<a name="l05414"></a><a class="code" href="classEMF_1_1FONT.html#a1">05414</a>     OBJECTTYPE <a class="code" href="classEMF_1_1FONT.html#a1">getType</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> O_FONT; }
<a name="l05421"></a><a class="code" href="classEMF_1_1FONT.html#a2">05421</a>     METARECORD* <a class="code" href="classEMF_1_1FONT.html#a2">newEMR</a> ( HDC dc, HGDIOBJ emf_handle )<font class="keyword"></font>
05422 <font class="keyword">    </font>{
05423       contexts[dc] = emf_handle;
05424       <font class="keywordflow">return</font> <font class="keyword">new</font> EMREXTCREATEFONTINDIRECTW( <font class="keyword">this</font>, emf_handle );
05425     }
05426   };
05427 
05429 
<a name="l05432"></a><a class="code" href="classEMF_1_1PALETTE.html">05432</a>   <font class="keyword">class </font>PALETTE : <font class="keyword">public</font> GRAPHICSOBJECT, <font class="keyword">public</font> LOGPALETTE {
05433   <font class="keyword">public</font>:
<a name="l05437"></a><a class="code" href="classEMF_1_1PALETTE.html#a0">05437</a>     <a class="code" href="classEMF_1_1PALETTE.html#a0">PALETTE</a> ( <font class="keyword">const</font> LOGPALETTE* lpalette )<font class="keyword"></font>
05438 <font class="keyword">    </font>{
05439       (<font class="keywordtype">void</font>)lpalette;
05440       palVersion = 0;
05441       palNumEntries = 0;
05442       PALETTEENTRY zero_entry = { 0, 0, 0, 0 };
05443       palPalEntry[0] = zero_entry;
05444     }
<a name="l05448"></a><a class="code" href="classEMF_1_1PALETTE.html#a1">05448</a>     OBJECTTYPE <a class="code" href="classEMF_1_1PALETTE.html#a1">getType</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> O_PALETTE; }
<a name="l05455"></a><a class="code" href="classEMF_1_1PALETTE.html#a2">05455</a>     METARECORD* <a class="code" href="classEMF_1_1PALETTE.html#a2">newEMR</a> ( HDC dc, HGDIOBJ emf_handle )<font class="keyword"></font>
05456 <font class="keyword">    </font>{
05457       contexts[dc] = emf_handle;
05458       <font class="keywordflow">return</font> <font class="keyword">new</font> EMRCREATEPALETTE( <font class="keyword">this</font>, emf_handle );
05459     }
05460   };
05461 
05463 
<a name="l05469"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html">05469</a>   <font class="keyword">class </font>METAFILEDEVICECONTEXT : <font class="keyword">public</font> OBJECT {
05477     <font class="keywordtype">void</font> init ( <font class="keyword">const</font> RECT* size, LPCWSTR description_w )<font class="keyword"> </font>{
05478 
05479       <font class="comment">// Evidently, metafile handles are numbered from 1, so don't</font>
05480       <font class="comment">// ever use 0.</font>
05481 
05482       handles.push_back( <font class="keyword">true</font> );
05483 
05484       <font class="comment">// Keep some of our graphics state in a header record</font>
05485 
05486       header = <font class="keyword">new</font> ENHMETAHEADER ( description_w );
05487       records.push_back( header );
05488 
05489       <font class="comment">// Compute the size and position of the metafile on the "page"</font>
05490 
05491       <font class="keywordflow">if</font> ( size ) {
05492         update_frame = <font class="keyword">false</font>;
05493 
05494         header-&gt;rclFrame.left = size-&gt;left;
05495         header-&gt;rclFrame.top = size-&gt;top;
05496         header-&gt;rclFrame.right = size-&gt;right;
05497         header-&gt;rclFrame.bottom = size-&gt;bottom;
05498 
05499         header-&gt;rclBounds.left =
05500           size-&gt;left * header-&gt;szlDevice.cx / ( header-&gt;szlMillimeters.cx * 100 );
05501         header-&gt;rclBounds.top =
05502           size-&gt;top * header-&gt;szlDevice.cy / ( header-&gt;szlMillimeters.cy * 100 );
05503         header-&gt;rclBounds.right =
05504           size-&gt;right * header-&gt;szlDevice.cx / ( header-&gt;szlMillimeters.cx * 100 );
05505         header-&gt;rclBounds.bottom =
05506           size-&gt;bottom * header-&gt;szlDevice.cy / ( header-&gt;szlMillimeters.cy * 100 );
05507       }
05508       <font class="keywordflow">else</font> {
05509         update_frame = <font class="keyword">true</font>;
05510 
05511         header-&gt;rclBounds.left = -10;
05512         header-&gt;rclBounds.top = -10;
05513         header-&gt;rclBounds.right = 10;
05514         header-&gt;rclBounds.bottom = 10;
05515 
05516         header-&gt;rclFrame.left = (LONG)floor( (<font class="keywordtype">float</font>)header-&gt;rclBounds.left *
05517           header-&gt;szlMillimeters.cx * 100 / header-&gt;szlDevice.cx );
05518         header-&gt;rclFrame.top = (LONG)floor( (<font class="keywordtype">float</font>)header-&gt;rclBounds.top *
05519           header-&gt;szlMillimeters.cy * 100 / header-&gt;szlDevice.cy );
05520         header-&gt;rclFrame.right = (LONG)ceil( (<font class="keywordtype">float</font>)header-&gt;rclBounds.right *
05521           header-&gt;szlMillimeters.cx * 100 / header-&gt;szlDevice.cx );
05522         header-&gt;rclFrame.bottom = (LONG)ceil( (<font class="keywordtype">float</font>)header-&gt;rclBounds.bottom *
05523           header-&gt;szlMillimeters.cy * 100 / header-&gt;szlDevice.cy );
05524       }
05525 
05526       <font class="comment">// Some default graphics state (are they really, though?)</font>
05527 
05528       SIZEL default_resolution = { RESOLUTION, RESOLUTION };
05529       resolution = default_resolution;
05530       SIZEL default_viewport_ext = { 1, 1 };
05531       viewport_ext = default_viewport_ext;
05532       POINT default_viewport_org = { 0, 0 };
05533       viewport_org = default_viewport_org;
05534       SIZEL default_window_ext = { 1, 1 };
05535       window_ext = default_window_ext;
05536       POINT default_window_org = { 0, 0 };
05537       window_org = default_window_org;
05538 
05539       min_device_point = viewport_org;
05540       max_device_point = viewport_org;
05541 
05542       pen = (PEN*)globalObjects.find( BLACK_PEN | ENHMETA_STOCK_OBJECT );
05543       brush = (BRUSH*)globalObjects.find( BLACK_BRUSH | ENHMETA_STOCK_OBJECT );
05544       font = (FONT*)globalObjects.find( DEVICE_DEFAULT_FONT | ENHMETA_STOCK_OBJECT);
05545       palette = (PALETTE*)globalObjects.find( DEFAULT_PALETTE|ENHMETA_STOCK_OBJECT);
05546 
05547       text_alignment = TA_BASELINE;
05548       text_color = RGB(0,0,0);
05549       bk_color = RGB(0xff,0xff,0xff);
05550       bk_mode = OPAQUE;
05551       polyfill_mode = ALTERNATE;
05552       map_mode = MM_TEXT;
05553 
05554       handle = globalObjects.add( <font class="keyword">this</font> );
05555     }
05556 
05557   <font class="keyword">public</font>:
<a name="l05561"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m0">05561</a>     ::FILE* fp;
<a name="l05566"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m1">05566</a>     DATASTREAM ds;
<a name="l05570"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m2">05570</a>     ENHMETAHEADER* header;
<a name="l05574"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m3">05574</a>     std::vector&lt; EMF::METARECORD* &gt; records;
05575 
05576     <font class="comment">// Keep a small set of graphics state information</font>
<a name="l05577"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m4">05577</a>     SIZEL resolution;           
<a name="l05578"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m5">05578</a>     SIZEL viewport_ext;         
<a name="l05579"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m6">05579</a>     POINT viewport_org;         
<a name="l05580"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m7">05580</a>     SIZEL window_ext;           
<a name="l05581"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m8">05581</a>     POINT window_org;           
<a name="l05582"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m9">05582</a>     <font class="keywordtype">bool</font> update_frame;          
<a name="l05583"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m10">05583</a>     POINT min_device_point;     
<a name="l05584"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m11">05584</a>     POINT max_device_point;     
<a name="l05585"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m12">05585</a>     POINT point;                
<a name="l05586"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m13">05586</a>     PEN* pen;                   
<a name="l05587"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m14">05587</a>     BRUSH* brush;               
<a name="l05588"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m15">05588</a>     FONT* font;                 
<a name="l05589"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m16">05589</a>     PALETTE* palette;           
<a name="l05590"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m17">05590</a>     UINT text_alignment;        
<a name="l05591"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m18">05591</a>     COLORREF text_color;        
<a name="l05592"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m19">05592</a>     COLORREF bk_color;          
<a name="l05593"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m20">05593</a>     INT bk_mode;                
<a name="l05594"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m21">05594</a>     INT polyfill_mode;          
<a name="l05595"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m22">05595</a>     INT map_mode;               
05596 
<a name="l05602"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m23">05602</a>     std::vector&lt; bool &gt; handles;
05603 
<a name="l05609"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m24">05609</a>     std::map&lt; HGDIOBJ, HGDIOBJ &gt; emf_handles;
05610 
<a name="l05621"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a0">05621</a>       <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a0">METAFILEDEVICECONTEXT</a> ( FILE* fp_, <font class="keyword">const</font> RECT* size,
05622                               LPCWSTR description_w )
05623         : fp(fp_), ds( fp_ )
05624     {
05625           init( size, description_w );
05626     }
<a name="l05631"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a1">05631</a>     <font class="keyword">virtual</font> <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a1">~METAFILEDEVICECONTEXT</a> ( )<font class="keyword"></font>
05632 <font class="keyword">    </font>{
05633       <font class="comment">// Purge all the metarecords (if there are any) {this include the</font>
05634       <font class="comment">// header record, too}</font>
05635       <font class="keywordflow">if</font> ( records.<a class="code" href="classEMF_1_1METARECORD.html#a2">size</a>() &gt; 0 )
05636         <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a7">deleteMetafile</a>();
05637     }
<a name="l05641"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a2">05641</a>     OBJECTTYPE <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a2">getType</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> O_METAFILEDEVICECONTEXT; }
<a name="l05646"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a3">05646</a>     DWORD <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a3">nextHandle</a> ( <font class="keywordtype">void</font> )<font class="keyword"></font>
05647 <font class="keyword">    </font>{
05648       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 1; i &lt; handles.size(); i++ ) {
05649         <font class="keywordflow">if</font> ( !handles[i] ) {
05650           handles[i] = <font class="keyword">true</font>;
05651           <font class="keywordflow">return</font> i;
05652         }
05653       }
05654       handles.push_back( <font class="keyword">true</font> );
05655       <font class="comment">// Well, it appears that even StockObject handles count for something.</font>
05656       <font class="comment">// Not sure what the right value here is, then.</font>
05657       header-&gt;nHandles = handles.size();
05658       <font class="keywordflow">return</font> handles.size()-1;
05659     }
<a name="l05663"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a4">05663</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a4">clearHandle</a> ( DWORD handle )<font class="keyword"></font>
05664 <font class="keyword">    </font>{
05665       handles[handle] = <font class="keyword">false</font>;
05666     }
<a name="l05672"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a5">05672</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a5">appendRecord</a> ( METARECORD* record )<font class="keyword"></font>
05673 <font class="keyword">    </font>{
05674       records.push_back( record );
05675 
05676       header-&gt;nBytes += record-&gt;size();
05677       header-&gt;nRecords++;
05678     }
<a name="l05684"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a6">05684</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a6">appendHandle</a> ( METARECORD* record )<font class="keyword"></font>
05685 <font class="keyword">    </font>{
05686       records.push_back( record );
05687 
05688       header-&gt;nBytes += record-&gt;size();
05689       header-&gt;nRecords++;
05690     }
<a name="l05695"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a7">05695</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a7">deleteMetafile</a> ( <font class="keywordtype">void</font> )<font class="keyword"></font>
05696 <font class="keyword">    </font>{
05697       <font class="keywordflow">for</font> ( std::vector&lt;METARECORD*&gt;::const_iterator r = records.begin();
05698             r != records.end();
05699             r++ ) {
05700         <font class="keyword">delete</font> *r;
05701       }
05702       records.clear();
05703     }
<a name="l05708"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a8">05708</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a8">mergePoint</a> ( <font class="keyword">const</font> LONG&amp; x, <font class="keyword">const</font> LONG&amp; y )<font class="keyword"></font>
05709 <font class="keyword">    </font>{
05710       POINT p;
05711       p.x = x;
05712       p.y = y;
05713       <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a8">mergePoint</a>( p );
05714     }
<a name="l05719"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a9">05719</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a8">mergePoint</a>( <font class="keyword">const</font> POINT&amp; p )<font class="keyword"></font>
05720 <font class="keyword">    </font>{
05721       POINT device_point;
05722 
05723       <font class="comment">// *** Note, it's possible for the global transformation matrix to</font>
05724       <font class="comment">// affect this too. ***</font>
05725 
05726       device_point.x = (LONG)( (<font class="keywordtype">float</font>)( p.x - window_org.x ) / window_ext.cx *
05727         viewport_ext.cx + viewport_org.x );
05728 
05729       device_point.y = (LONG)( (<font class="keywordtype">float</font>)( p.y - window_org.y ) / window_ext.cy *
05730         viewport_ext.cy + viewport_org.y );
05731 
05732       <font class="comment">// If the user didn't specify a bounding rectangle in the constructor,</font>
05733       <font class="comment">// compute one from this data, too.</font>
05734       <font class="keywordflow">if</font> ( device_point.x &lt; min_device_point.x ) {
05735         min_device_point.x = device_point.x;
05736         <font class="keywordflow">if</font> ( update_frame ) {
05737           header-&gt;rclBounds.left = min_device_point.x - 10;
05738           header-&gt;rclFrame.left = (LONG)floor( (<font class="keywordtype">float</font>)header-&gt;rclBounds.left *
05739             header-&gt;szlMillimeters.cx * 100 / header-&gt;szlDevice.cx );
05740         }
05741       }
05742       <font class="keywordflow">else</font> <font class="keywordflow">if</font> ( device_point.x &gt; max_device_point.x ) {
05743         max_device_point.x = device_point.x;
05744         <font class="keywordflow">if</font> ( update_frame ) {
05745           header-&gt;rclBounds.right = max_device_point.x + 10;
05746           header-&gt;rclFrame.right = (LONG)ceil( (<font class="keywordtype">float</font>)header-&gt;rclBounds.right *
05747             header-&gt;szlMillimeters.cx * 100 / header-&gt;szlDevice.cx );
05748         }
05749       }
05750 
05751       <font class="keywordflow">if</font> ( device_point.y &lt; min_device_point.y ) {
05752         min_device_point.y = device_point.y;
05753         <font class="keywordflow">if</font> ( update_frame ) {
05754           header-&gt;rclBounds.top = min_device_point.y - 10;
05755           header-&gt;rclFrame.top = (LONG)floor( (<font class="keywordtype">float</font>)header-&gt;rclBounds.top *
05756             header-&gt;szlMillimeters.cy * 100 / header-&gt;szlDevice.cy );
05757         }
05758       }
05759       <font class="keywordflow">else</font> <font class="keywordflow">if</font> ( device_point.y &gt; max_device_point.y ) {
05760         max_device_point.y = device_point.y;
05761         <font class="keywordflow">if</font> ( update_frame ) {
05762           header-&gt;rclBounds.bottom = max_device_point.y + 10;
05763           header-&gt;rclFrame.bottom = (LONG)ceil( (<font class="keywordtype">float</font>)header-&gt;rclBounds.bottom *
05764             header-&gt;szlMillimeters.cy * 100 / header-&gt;szlDevice.cy );
05765         }
05766       }
05767     }
05768   };
05769 
05770 } <font class="comment">// close EMF namespace</font>
05771 
05772 <font class="preprocessor">#endif </font><font class="comment">/* _LIBEMF_H */</font>
</pre></div><hr><address><small>Generated at Mon Jan 28 14:57:44 2002 for EMF by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.8.1 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
