% ======================================================================
% scrlttr2-experts.tex
% Copyright (c) Markus Kohm, 2002-2012
%
% This file is part of the LaTeX2e KOMA-Script bundle.
%
% This work may be distributed and/or modified under the conditions of
% the LaTeX Project Public License, version 1.3c of the license.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3c or later is part of all distributions of LaTeX 
% version 2005/12/01 or later and of this work.
%
% This work has the LPPL maintenance status "author-maintained".
%
% The Current Maintainer and author of this work is Markus Kohm.
%
% This work consists of all files listed in manifest.txt.
% ----------------------------------------------------------------------
% scrlttr2-experts.tex
% Copyright (c) Markus Kohm, 2002-2012
%
% Dieses Werk darf nach den Bedingungen der LaTeX Project Public Lizenz,
% Version 1.3c, verteilt und/oder veraendert werden.
% Die neuste Version dieser Lizenz ist
%   http://www.latex-project.org/lppl.txt
% und Version 1.3c ist Teil aller Verteilungen von LaTeX
% Version 2005/12/01 oder spaeter und dieses Werks.
%
% Dieses Werk hat den LPPL-Verwaltungs-Status "author-maintained"
% (allein durch den Autor verwaltet).
%
% Der Aktuelle Verwalter und Autor dieses Werkes ist Markus Kohm.
% 
% Dieses Werk besteht aus den in manifest.txt aufgefuehrten Dateien.
% ======================================================================
%
% Chapter about scrlttr2 of the KOMA-Script guide expert part
% Maintained by Markus Kohm
%
% ----------------------------------------------------------------------
%
% Kapitel über scrlttr2 im Experten-Teil der KOMA-Script-Anleitung
% Verwaltet von Markus Kohm
%
% ============================================================================

\ProvidesFile{scrlttr2-experts.tex}[2012/03/01 KOMA-Script guide (chapter: scrlttr2 for experts)]

\chapter{Zusätzliche Informationen zur 
  Briefklasse \Class{scrlttr2}}
\labelbase{scrlttr2-experts}

In diesem Kapitel finden Sie zusätzliche Informationen zu der
\KOMAScript-Klasse \Class{scrlttr2}. \iffree{Einige Teile des Kapitels sind dabei dem \KOMAScript-Buch
  \cite{book:komascript} vorbehalten. Dies sollte kein Problem sein, denn
  der}{Der} Anwender, der die Klasse
einfach nur verwenden will, wird diese Informationen normalerweise nicht
benötigen. Ein Teil der Informationen richtet sich an Anwender, denen die
vordefinierten Möglichkeiten nicht mehr genügen. So befasst sich
beispielsweise der erste Abschnitt ausführlich mit den Pseudolängen, die den
Briefbogen bestimmen und die für Anpassungen an eigene Briefbogenlayouts
abweichend zu setzen sind. Darüber hinaus finden sich in diesem Kapitel auch
Informationen über Möglichkeiten, die aus Gründen der Verbesserung der
Kompatibilität zur obsoleten \KOMAScript-Klasse \Class{scrlettr} geschaffen
wurden. Es wird auch ausführlich erklärt, wie man einen Brief dieser
veralteten Klasse auf die aktuelle Briefklasse übertragen kann.


\section{Pseudolängen für fortgeschrittene Anwender}
\label{sec:scrlttr2-experts.pseudoLengths}
\BeginIndex{}{Pseudolängen}

\TeX{} arbeitet mit einem festen Satz an Registern. Es gibt Register für
Token, für Boxen, für Zähler, für Abstände (englisch: \emph{skip}) und für
Größen (englisch: \emph{dimension}). Von all diesen Registern gibt es jeweils
256~Stück. Für \LaTeX{}-Längen, die mit \Macro{newlength} angefordert werden,
werden Abstandsregister belegt. Sind alle diese Register verbraucht, kann man
keine weiteren Längen definieren. Die Briefklasse \Class{scrlttr2} würde
normalerweise allein für die erste Seite mehr als 20 solche Register
verbrauchen. \LaTeX{} selbst belegt bereits 40 dieser Register. Das
\Package{typearea}-Paket benötigt ebenfalls einige, so dass ein Viertel der
kostbaren Register verbraucht wäre. Aus diesem Grund werden briefspezifische
Längen in \Class{scrlttr2} eben nicht in Längen, sondern in Makros abgelegt,
den Pseudolängen. Der Nachteil dieses Vorgehens besteht darin, dass man mit
diesen Makros nicht so einfach rechnen kann wie mit echten Längen.

Wer nun einwenden will, dass \LaTeX{} in der empfohlenen und für \KOMAScript{}
benötigten Installation mit \eTeX{} inzwischen das oben genannte
Beschränkungsproblem nicht mehr besitzt, hat Recht. Allerdings kam diese
Entscheidung für \Class{scrlttr2} ein wenig zu spät.

Eine Auf"|listung aller von \Class{scrlttr2} definierten und verwendeten
Pseudolängen ist \autoref{tab:scrlttr2-experts.pseudoLengths} zu
entnehmen. Dabei ist auch angegeben, wo in den nachfolgenden Unterabschnitten
nähere Erklärungen zu der jeweiligen Pseudolänge zu finden
sind. 

\autoref{fig:scrlttr2-experts.pseudoLengths} auf
\autopageref{fig:scrlttr2-experts.pseudoLengths} zeigt eine schematische
Darstellung der wichtigsten Abstände auf dem Briefbogen. Dabei sind neben den
Pseudolängen für die veränderbaren Abständen zusätzlich in heller Schrift auch
die Längen angegeben, die für einige, wenige fest programmierte Abstände
verwendet werden. Aus Gründen der Übersichtlichkeit wurde in der Darstellung
auf einige weniger häufig benötigten Pseudolängen jedoch auch verzichtet.
%
\iffree{}{\vskip-\dp\strutbox}% Umbruchkorrektur!!!
\begin{desclist}
  \renewcommand{\abovecaptionskipcorrection}{-\normalbaselineskip}%
  \desccaption{%
    Von der Klasse \Class{scrlttr2} verwendete Pseudolängen%
    \label{tab:scrlttr2-experts.pseudoLengths}%
  }{%
    Von der Klasse \Class{scrlttr2} verwendete Pseudolängen
    (\emph{Fortsetzung})%
  }%
  \pentry{backaddrheight}{%
    Höhe der Rücksendeadresse am oberen Rand des Anschriftfeldes
    (\autoref{sec:scrlttr2-experts.addressee},
    \autopageref{desc:scrlttr2-experts.plength.backaddrheight})%
  }%
  \pentry{bfoldmarklength}{%
    Länge der unteren horizontalen Faltmarke
    (\autoref{sec:scrlttr2-experts.foldmarks},
    \autopageref{desc:scrlttr2-experts.plength.bfoldmarkvpos})%
  }%
  \pentry{bfoldmarkvpos}{%
    Abstand der unteren horizontalen Faltmarke von der oberen Kante des
    Papiers
    (\autoref{sec:scrlttr2-experts.foldmarks},
    \autopageref{desc:scrlttr2-experts.plength.bfoldmarkvpos})%
  }%
  \pentry{firstfoothpos}{%
    Abstand des Brief"|fußes von der linken Kante des Papiers; Werte
    größer der Breite oder kleiner der negativen Breite des Papiers werden
    gesondert behandelt (\autoref{sec:scrlttr2-experts.firstFoot},
    \autopageref{desc:scrlttr2-experts.plength.firstfoothpos})%
  }%
  \pentry{firstfootvpos}{%
    Abstand des Brief"|fußes von der oberen Kante des Papiers
    (\autoref{sec:scrlttr2-experts.firstFoot},
    \autopageref{desc:scrlttr2-experts.plength.firstfootvpos})%
  }%
  \pentry{firstfootwidth}{%
    Breite des Brief"|fußes
    (\autoref{sec:scrlttr2-experts.firstFoot},
    \autopageref{desc:scrlttr2-experts.plength.firstfootwidth})%
  }%
  \pentry{firstheadhpos}{%
    Abstand des Briefkopfes von der linken Kante des Papiers; Werte
    größer der Breite oder kleiner der negativen Breite des Papiers werden
    gesondert behandelt (\autoref{sec:scrlttr2-experts.firstHead},
    \autopageref{desc:scrlttr2-experts.plength.firstheadhpos})%
  }%
  \pentry{firstheadvpos}{%
    Abstand des Briefkopfes von der oberen Kante des Papiers
    (\autoref{sec:scrlttr2-experts.firstHead},
    \autopageref{desc:scrlttr2-experts.plength.firstheadvpos})%
  }%
  \pentry{firstheadwidth}{%
    Breite des Briefkopfes
    (\autoref{sec:scrlttr2-experts.firstHead},
    \autopageref{desc:scrlttr2-experts.plength.firstheadwidth})%
  }%
  \pentry{foldmarkhpos}{%
    Abstand der horizontalen Faltmarken von der linken Kante des Papiers
    (\autoref{sec:scrlttr2-experts.foldmarks},
    \autopageref{desc:scrlttr2-experts.plength.foldmarkhpos})%
  }%
  \pentry{foldmarkvpos}{%
    Abstand der vertikalen Faltmarken von der oberen Kante des Papiers
    (\autoref{sec:scrlttr2-experts.foldmarks},
    \autopageref{desc:scrlttr2-experts.plength.foldmarkvpos})%
  }%
  \pentry{fromrulethickness}{%
    Dicke einer optionalen 
    \iffalse horizontalen \fi% Umbruchkorrektur
    Linie im Briefkopf
    (\autoref{sec:scrlttr2-experts.firstHead},
    \autopageref{desc:scrlttr2-experts.plength.fromrulethickness})%
  }%
  \pentry{fromrulewidth}{%
    Länge einer optionalen 
    \iffalse horizontalen \fi% Umbruchkorrektur
    Linie im Briefkopf
    (\autoref{sec:scrlttr2-experts.firstHead},
    \autopageref{desc:scrlttr2-experts.plength.fromrulewidth})%
  }%
  \pentry{lfoldmarkhpos}{%
    Abstand der vertikalen Faltmarke von der linken Kante des Papiers
    (\autoref{sec:scrlttr2-experts.foldmarks},
    \autopageref{desc:scrlttr2-experts.plength.lfoldmarkhpos})%
  }%
  \pentry{lfoldmarklength}{%
    Länge der vertikalen Faltmarke 
    (\autoref{sec:scrlttr2-experts.foldmarks},
    \autopageref{desc:scrlttr2-experts.plength.lfoldmarklength})%
  }%
  \pentry{locheight}{%
    Höhe der Absenderergänzung, falls der Wert nicht 0 ist; bei 0 wird
    stattdessen \PLength{toaddrheight} verwendet
    (\autoref{sec:scrlttr2-experts.locationField},
    \autopageref{desc:scrlttr2-experts.plength.locheight})%
  }%
  \pentry{lochpos}{%
    Abstand der Absenderergänzung von der rechten Papierkante, falls der Wert
    positiv ist, oder negativer Abstand der Absenderergänzung von der linken
    Papierkante, falls der Wert negativ ist; bei 0 wird stattdessen der
    negative Wert von \PLength{toaddrhpos} verwendet
    (\autoref{sec:scrlttr2-experts.locationField},
    \autopageref{desc:scrlttr2-experts.plength.lochpos})%
  }%
  \pentry{locvpos}{%
    Abstand der Absenderergänzung von der oberen Papierkante, falls der Wert
    nicht 0 ist; bei 0 wird stattdessen \PLength{toaddrvpos} verwendet
    (\autoref{sec:scrlttr2-experts.locationField},
    \autopageref{desc:scrlttr2-experts.plength.locvpos})%
  }%
  \pentry{locwidth}{%
    Breite des Feldes für die Absenderergänzung, wobei bei einem Wert von 0
    die Breite automatisch aufgrund der in \autoref{sec:scrlttr2.firstpage},
    \autopageref{desc:scrlttr2.option.locfield} beschriebenen Option
    \Option{locfield} berechnet wird
    (\autoref{sec:scrlttr2-experts.locationField},
    \autopageref{desc:scrlttr2-experts.plength.locwidth})%
  }%
  \pentry{mfoldmarklength}{%
    Länge der mittleren horizontalen Faltmarke
    (\autoref{sec:scrlttr2-experts.foldmarks},
    \autopageref{desc:scrlttr2-experts.plength.mfoldmarklength})%
  }%
  \pentry{mfoldmarkvpos}{%
    Abstand der mittleren horizontalen Faltmarke von der oberen Kante des
    Papiers 
    (\autoref{sec:scrlttr2-experts.foldmarks},
    \autopageref{desc:scrlttr2-experts.plength.mfoldmarkvpos})%
  }%
  \pentry{pfoldmarklength}{%
    Länge der Lochermarke 
    (\autoref{sec:scrlttr2-experts.foldmarks},
    \autopageref{desc:scrlttr2-experts.plength.pfoldmarklength})%
  }%
  \pentry{refaftervskip}{%
    vertikaler Abstand nach der Geschäftszeile
    (\autoref{sec:scrlttr2-experts.refLine},
    \autopageref{desc:scrlttr2-experts.plength.refaftervskip})%
  }%
  \pentry{refhpos}{%
    Abstand der Geschäftszeile von der linken Papierkante, wobei bei einem
    Wert von 0 automatisch relativ zur Papierbreite zentriert wird
    (\autoref{sec:scrlttr2-experts.refLine},
    \autopageref{desc:scrlttr2-experts.plength.refhpos})%
  }%
  \pentry{refvpos}{%
    Abstand der Geschäftszeile von der oberen Kante des Papiers
    (\autoref{sec:scrlttr2-experts.refLine},
    \autopageref{desc:scrlttr2-experts.plength.refvpos})%
  }%
  \pentry{refwidth}{%
    Breite der Geschäftszeile
    (\autoref{sec:scrlttr2-experts.refLine},
    \autopageref{desc:scrlttr2-experts.plength.refwidth})%
  }%
  \pentry{sigbeforevskip}{%
    vertikaler Abstand zwischen Gruß und Signatur
    (\autoref{sec:scrlttr2-experts.closing},
    \autopageref{desc:scrlttr2-experts.plength.sigbeforevskip})%
  }%
  \pentry{sigindent}{%
    Einzug der Signatur gegenüber dem Textkörper
    (\autoref{sec:scrlttr2-experts.closing},
    \autopageref{desc:scrlttr2-experts.plength.sigindent})%
  }%
  \pentry{specialmailindent}{%
    linker Einzug der Versandart innerhalb des Anschriftfeldes
    (\autoref{sec:scrlttr2-experts.addressee},
    \autopageref{desc:scrlttr2-experts.plength.specialmailindent})%
  }%
  \pentry{specialmailrightindent}{%
    rechter Einzug der Versandart innerhalb des Anschriftfeldes
    (\autoref{sec:scrlttr2-experts.addressee},
    \autopageref{desc:scrlttr2-experts.plength.specialmailrightindent})%
  }%
  \pentry{subjectaftervskip}{%
    vertikaler Abstand nach dem Betreff
    (\autoref{sec:scrlttr2-experts.subject},
    \autopageref{desc:scrlttr2-experts.plength.subjectaftervskip})%
  }%
  \pentry{subjectbeforevskip}{%
    zusätzlicher vertikaler Abstand vor dem Betreff
    (\autoref{sec:scrlttr2-experts.subject},
    \autopageref{desc:scrlttr2-experts.plength.subjectbeforevskip})%
  }%
  \pentry{subjectvpos}{%
    Abstand des Betreffs von der oberen Kante des Papiers, wobei ein Wert von
    0 stattdessen den Betreff gemäß Option \Option{subject} setzt
    (\autoref{sec:scrlttr2-experts.subject},
    \autopageref{desc:scrlttr2-experts.plength.subjectaftervskip})%
  }%
  \pentry{tfoldmarklength}{%
    Länge der oberen horizontalen Faltmarke
    (\autoref{sec:scrlttr2-experts.foldmarks},
    \autopageref{desc:scrlttr2-experts.plength.tfoldmarklength})%
  }%
  \pentry{tfoldmarkvpos}{%
    Abstand der oberen horizontalen Faltmarke von der oberen Kante des Papiers
    (\autoref{sec:scrlttr2-experts.foldmarks},
    \autopageref{desc:scrlttr2-experts.plength.tfoldmarkvpos})%
  }%
  \pentry{toaddrheight}{%
    Höhe des Anschriftfeldes
    (\autoref{sec:scrlttr2-experts.addressee},
    \autopageref{desc:scrlttr2-experts.plength.toaddrheight})%
  }%
  \pentry{toaddrhpos}{%
    Abstand des Anschriftfeldes von der linken Papierkante, falls der Wert
    positiv ist, oder negativer Abstand des Anschriftfeldes von der rechten
    Papierkante, falls der Wert negativ ist
    (\autoref{sec:scrlttr2-experts.addressee},
    \autopageref{desc:scrlttr2-experts.plength.toaddrhpos})%
  }%
  \pentry{toaddrindent}{%
    linker und rechter Einzug der Anschrift innerhalb des Anschrift\-feldes
    (\autoref{sec:scrlttr2-experts.addressee},
    \autopageref{desc:scrlttr2-experts.plength.toaddrindent})%
  }%
  \pentry{toaddrvpos}{%
    Abstand des Anschriftfeldes von der oberen Kante des Papiers
    (\autoref{sec:scrlttr2-experts.addressee},
    \autopageref{desc:scrlttr2-experts.plength.toaddrvpos})%
  }%
  \pentry{toaddrwidth}{%
    Breite des Anschriftfeldes 
    (\autoref{sec:scrlttr2-experts.addressee},
    \autopageref{desc:scrlttr2-experts.plength.toaddrwidth})%
  }%
\end{desclist}

\begin{figure}
  \centering
  \includegraphics{plenDIN}
  \caption{Schematische Darstellung der wichtigsten Pseudolängen für den
    Briefbogen}
  \label{fig:scrlttr2-experts.pseudoLengths}
\end{figure}

\iffree{}{\clearpage}% Umbruchoptimierung!!!

\begin{Declaration}
  \Macro{@newplength}\Parameter{Name}
\end{Declaration}
\BeginIndex{Cmd}{@newplength}%
Mit Hilfe dieser Anweisung wird eine neue Pseudolänge definiert. Die
neue Pseudolänge ist dann über ihren \PName{Namen} eindeutig
identifiziert. 
%
\iffalse % Umbruchoptimierungstext
Es wird sichergestellt, dass jeder \PName{Name} nur
einmal vergeben wird.%
\else
Wird versucht, eine bereits vorhandene Pseudolänge erneut
zu definieren, so wird dies mit einer Fehlermeldung quittiert.%
%
\fi

Da der Anwender selbst normalerweise keine eigenen Pseudolängen definieren
muss, handelt es sich bei diesem Befehl um keine Benutzeranweisung. Sie kann
innerhalb des Dokuments nicht, wohl aber beispielsweise innerhalb einer
\File{lco}-Datei\Index{lco-Datei=\File{lco}-Datei} verwendet
werden. \iffree{}{Will man eine Pseudolänge aber doch einmal innerhalb des
  Dokuments definieren, so kann man die Beschränkung mit
  Hilfe von \Macro{makeatletter}\important[i]{\Macro{makeatletter}\\
    \Macro{makeatother}}\IndexCmd{makeatletter} und
  \Macro{makeatother}\IndexCmd{makeatother} aufheben (siehe
  \cite{DANTE:FAQ}). Innerhalb\textnote{Achtung!} einer \File{lco}-Datei
  sollten diese beiden Anweisungen jedoch niemals verwendet werden!}
%
\EndIndex{Cmd}{@newplength}%

\begin{Declaration}
  \Macro{@setplength}%
    \OParameter{Faktor}\Parameter{Pseudolänge}\Parameter{Wert}\\
  \Macro{@addtoplength}%
    \OParameter{Faktor}\Parameter{Pseudolänge}\Parameter{Wert}
\end{Declaration}
\BeginIndex{Cmd}{@setplength}%
\BeginIndex{Cmd}{@addtoplength}%
Mit Hilfe von \Macro{@setplength} kann einer \PName{Pseudolänge} das
Vielfache eines \PName{Wertes} zugewiesen werden. Der \PName{Faktor} wird
dabei als optionales Argument übergeben (siehe auch
\Macro{setlengthtoplength}, \autoref{sec:scrlttr2.pseudoLength},
\autopageref{desc:scrlttr2.cmd.setlengthtoplength}). 

Mit \Macro{@addtoplength} kann man zu einer \PName{Pseudolänge} das Vielfache
einen \PName{Wert} addieren. Auch dabei wird der \PName{Faktor} als optionales
Argument übergeben. 

Um einer \PName{Pseudolänge} das Vielfache einer anderen Pseudolänge
zuzuweisen oder hinzuzuaddieren, verwendet man innerhalb von \PName{Wert} die
Anweisung \Macro{useplength} (siehe \autoref{sec:scrlttr2.pseudoLength},
\autopageref{desc:scrlttr2.cmd.useplength}). Um von einer \PName{Pseudolänge}
den Wert einer anderen \PName{Pseudolänge} zu subtrahieren, verwendet man
gleichzeitig als \PName{Faktor} ein Minuszeichen, \PValue{-1} oder einen
anderen negativen Faktor.

Da der Anwender selbst normalerweise keine Pseudolängen ändern muss, handelt
es sich bei diesen Befehlen um keine Benutzeranweisungen. Sie können innerhalb
des Dokuments nicht, wohl aber beispielsweise innerhalb einer \File{lco}-Datei
verwendet werden. \iffree{}{Will man den Wert einer Pseudolänge aber doch
  einmal innerhalb des Dokuments ändern, so kann man die Beschränkung mit
  Hilfe von \Macro{makeatletter}\important[i]{\Macro{makeatletter}\\
    \Macro{makeatother}}\IndexCmd{makeatletter} und
  \Macro{makeatother}\IndexCmd{makeatother} aufheben (siehe
  \cite{DANTE:FAQ}). Innerhalb\textnote{Achtung!} einer \File{lco}-Datei
  sollten diese beiden Anweisungen jedoch niemals verwendet werden!}
\EndIndex{Cmd}{@setplength}%
\EndIndex{Cmd}{@addtoplength}%


\subsection{Faltmarken}
\label{sec:scrlttr2-experts.foldmarks}
\BeginIndex{}{Faltmarke}%

Falt- oder Falzmarken sind kleine horizontale Striche am linken und kleine
vertikale Striche am oberen Rand. \KOMAScript{} unterstützt für den Briefbogen
derzeit drei konfigurierbare horizontale und eine konfigurierbare vertikale
Faltmarke. Dazu wird noch eine horizontale Loch- oder Seitenmittenmarke
unterstützt, die nicht in der Vertikalen verschoben werden kann.


\begin{Declaration}
  \PLength{tfoldmarkvpos}\\
  \PLength{mfoldmarkvpos}\\
  \PLength{bfoldmarkvpos}
\end{Declaration}
\BeginIndex{PLength}{tfoldmarkvpos}%
\BeginIndex{PLength}{bfoldmarkvpos}%
\BeginIndex{PLength}{mfoldmarkvpos}%
Die Briefklasse \Class{scrlttr2} kennt insgesamt drei in der vertikalen
Platzierung konfigurierbaren Faltmarken. Die Position der oberen Faltmarke vom
oberen Papierrand wird von der Pseudolänge \PLength{tfoldmarkvpos}
bestimmt. Für die Position der mittleren Faltmarke ist Pseudolänge
\PLength{mfoldmarkvpos}\ChangedAt{v2.97e}{\Class{scrlttr2}}, für die unteren
Faltmarke \PLength{bfoldmarkvpos} zuständig. Mit der
Locher-\Index{Lochermarke} oder Seitenmittenmarke kommt noch eine weitere
horizontale Marke dazu. Diese wird jedoch immer in der vertikalen Seitenmitte
platziert. 
\iffalse% Umbruchkorrekturtext!
Da ihre vertikale Position also nicht konfigurierbar ist, existiert
auch keine Pseudolänge dafür.
\fi

Die\important{Achtung!} obere und untere Faltmarke dienen nicht der exakten
Drittelung des Papiers beim Falten. Stattdessen soll das Papier mit ihrer
Hilfe so geknickt werden können, dass das Feld für die Anschrift in einem
Fensterbriefumschlag zu sehen ist. Die Einstellungen sind daher in den
vordefinierten \File{lco}-Dateien\textnote{\File{lco}-Datei}%
\Index{lco-Datei=\File{lco}-Datei} unterschiedlich gewählt. Eine
Besonderheit\textnote{Achtung!} stellt \Option{DINmtext} dar. Hier wird
zwingend von einem Briefumschlag im Format C6/5 (auch »C6 lang« genannt)
ausgegangen. Briefe, die mit dieser Option erstellt wurden, sind weder für
Umschläge im Format C5 noch für Umschläge im Format C4 geeignet.

Die mittlere Faltmarke wird für abendländische Briefe normalerweise nicht
benötigt. Beispielsweise in Japan gibt es jedoch so unterschiedliche
Briefumschläge, dass eine weitere Faltmarke benötigt wurde (siehe die
japanischen \File{lco}-Dateien). An dieser Stelle sei darauf hingewiesen, dass
die Bezeichnungen »obere«, »mittlere« und »untere« Faltmarke lediglich eine
Sprachkonvention darstellen. Tatsächlich ist nicht festgelegt, dass
\PLength{tfoldmarkvpos} kleiner als \PLength{mfoldmarkvpos} und dieses kleiner
als \PLength{bfoldmarkvpos} sein muss. Ist\textnote{Achtung!} eine der
Pseudolängen hingegen Null, so wird die entsprechende Faltmarke auch dann
nicht gesetzt, wenn sie per Option
\Option{foldmarks}\IndexOption{foldmarks~=\PName{Einstellung}}\important{\Option{foldmarks}}
(siehe \autoref{sec:scrlttr2.firstpage},
\autopageref{desc:scrlttr2.option.foldmarks}) explizit aktiviert wurde.%
%
\EndIndex{PLength}{tfoldmarkvpos}%
\EndIndex{PLength}{mfoldmarkvpos}%
\EndIndex{PLength}{bfoldmarkvpos}%


\begin{Declaration}
  \PLength{tfoldmarklength}\\
  \PLength{mfoldmarklength}\\
  \PLength{bfoldmarklength}\\
  \PLength{pfoldmarklength}
\end{Declaration}
\BeginIndex{PLength}{tfoldmarklength}%
\BeginIndex{PLength}{mfoldmarklength}%
\BeginIndex{PLength}{bfoldmarklength}%
\BeginIndex{PLength}{pfoldmarklength}%
Diese\ChangedAt{v2.97e}{\Class{scrlttr2}} vier Pseudolängen bestimmen die
Länge der vier horizontalen Marken. Dabei gilt eine
Besonderheit. Ist\textnote{Achtung!} die Länge nämlich mit Null angegeben, so
werden bei den Pseudolängen \PLength{tfoldmarklength},
\PLength{mfoldmarklength} und \PLength{bfoldmarklength} für die drei in der
vertikalen Position konfigurierbaren Faltmarken stattdessen 2\Unit{mm} als
Länge verwendet. Die Länge der Lochermarke, \PLength{pfoldmarklength}, wird
hingegen auf 4\Unit{mm} gesetzt.%
\EndIndex{PLength}{tfoldmarklength}%
\EndIndex{PLength}{mfoldmarklength}%
\EndIndex{PLength}{bfoldmarklength}%
\EndIndex{PLength}{pfoldmarklength}%


\begin{Declaration}
  \PLength{foldmarkhpos}
\end{Declaration}
\BeginIndex{PLength}{foldmarkhpos}%
Diese Pseudolänge gibt den Abstand aller horizontalen Faltmarken vom linken
Papier\-rand an.  Normalerweise sind das 3{,}5\Unit{mm}. Sie\textnote{Tipp!}
können den Wert aber auch in Ihrer eigenen \File{lco}-Datei ändern, falls Sie
einen Drucker verwenden, der einen breiteren unbedruckbaren linken Rand
hat. Ob die Faltmarken überhaupt gesetzt werden, hängt außerdem von der Option
\Option{foldmarks}\important{\Option{foldmarks}}%
\IndexOption{foldmarks~=\PName{Einstellung}} ab (siehe
\autoref{sec:scrlttr2.firstpage},
\autopageref{desc:scrlttr2.option.foldmarks}).%
%
\EndIndex{PLength}{foldmarkhpos}%


\begin{Declaration}
  \PLength{lfoldmarkhpos}
\end{Declaration}
\BeginIndex{PLength}{lfoldmarkhpos}%
Neben\ChangedAt{v2.97e}{\Class{scrlttr2}} den horizontalen Faltmarken gibt es
auch noch eine vertikale Faltmarke. Deren Abstand von der linken Papierkante
wird über die Pseudolänge \PLength{lfoldmarkhpos} bestimmt. Diese Faltmarke
wird beispielsweise bei Briefen für einige japanische Chou- oder You-Umschläge
benötigt, wenn man diese für A4-Papier verwenden will. Auch für Umschläge im
C6-Format kann sie nützlich sein.%
\EndIndex{PLength}{lfoldmarkhpos}%


\begin{Declaration}
  \PLength{lfoldmarklength}
\end{Declaration}
\BeginIndex{PLength}{lfoldmarklength}%
Die Pseudolänge \PLength{lfoldmarklength} bestimmt
die\ChangedAt{v2.97e}{\Class{scrlttr2}} Länge der vertikalen
Faltmarke. Auch\textnote{Achtung!}  hier gibt es die Besonderheit, dass bei
einer angegebenen Länge von Null stattdessen 4\Unit{mm} verwendet werden.%
\EndIndex{PLength}{lfoldmarklength}%


\begin{Declaration}
  \PLength{foldmarkvpos}
\end{Declaration}
\BeginIndex{PLength}{foldmarkvpos}%
Diese\ChangedAt{v2.97e}{\Class{scrlttr2}} Pseudolänge gibt den Abstand aller
vertikalen Faltmarken vom oberen Papier\-rand an.  Normalerweise sind das
3{,}5\Unit{mm}. Sie\textnote{Tipp!} können den Wert aber auch in Ihrer eigenen
\File{lco}-Datei ändern, falls Sie einen Drucker verwenden, der einen
breiteren unbedruckbaren oberen Rand hat. Ob die Faltmarken überhaupt gesetzt
werden, hängt außerdem von der Option
\Option{foldmarks}\important{\Option{foldmarks}}%
\IndexOption{foldmarks~=\PName{Einstellung}}
ab (siehe \autoref{sec:scrlttr2.firstpage},
\autopageref{desc:scrlttr2.option.foldmarks}). Derzeit gibt es nur eine
einzige vertikale Faltmarke, die als linke vertikale Faltmarke bezeichnet
wird.%
\EndIndex{PLength}{foldmarkvpos}%


\begin{Declaration}
  \PLength{foldmarkthickness}
\end{Declaration}
\BeginIndex{PLength}{foldmarkthickness}%
Diese\ChangedAt{v2.97c}{\Class{scrlttr2}} Pseudolänge gibt die Dicke aller
Faltmarken an. Voreingestellt sind 0,2\Unit{pt}, also eine sehr dünne
Haarlinie. Insbesondere\textnote{Tipp!}, wenn die Farbe der Faltmarken
geändert wird, kann dies zu wenig sein!%
\EndIndex{PLength}{foldmarkthickness}%
%
\EndIndex{}{Faltmarke}%


\subsection{Briefkopf}
\label{sec:scrlttr2-experts.firstHead}
\BeginIndex{}{Briefkopf}%

Unter dem Briefkopf verstehen wir alle Angaben, die den Absender betreffen und
die über der Anschrift stehen. Normalerweise würde man erwarten, dass diese
über den Seitenstil gesetzt werden. Bei der alten Briefklasse \Class{scrlettr}
war dies auch so. Bei\textnote{Achtung!} \Class{scrlttr2} wird der Briefkopf
jedoch unabhängig vom Seitenstil von der Anweisung
\Macro{opening}\IndexCmd{opening} ausgegeben.
% Fuellmaterial
\iftrue%
Dabei wird der Briefkopf absolut positioniert, ist also vom
Satzspiegel unabhängig.  Die erste Seite eines Briefes, also die Seite
mit dem Briefkopf, wird tatsächlich mit dem Seitenstil \PValue{empty}
gesetzt.%
\fi
% Ende des Fuellmaterials


\begin{Declaration}
  \PLength{firstheadvpos}
\end{Declaration}
\BeginIndex{PLength}{firstheadvpos}%
Die Pseudolänge \PLength{firstheadvpos} gibt den Abstand des Briefkopfes von
der oberen Papierkante an. Der Wert wird in den vordefinierten
\File{lco}-Dateien\textnote{\File{lco}-Datei}\Index{lco-Datei=\File{lco}-Datei}
unterschiedlich gesetzt. Ein typischer Wert ist 8\Unit{mm}.%
\EndIndex{PLength}{firstheadvpos}%


\begin{Declaration}
  \PLength{firstheadhpos}
\end{Declaration}
\BeginIndex{PLength}{firstheadhpos}%
Die Pseudolänge \PLength{firstheadhpos}\ChangedAt{v3.05}{\Class{scrlttr2}}
gibt bei einem positiven Wert den Abstand des Briefkopfes von der linken
Papierkante an. Ist\textnote{Achtung!} der Wert sogar größer oder gleich der
Breite des Papiers,
\Length{paperwidth}\important{\Length{paperwidth}}\IndexLength{paperwidth}, so
wird der Briefkopf horizontal zentriert auf dem Briefbogen platziert. Ein
negativer Wert gibt den Abstand des Briefkopfes von der rechten Papierkante
an. Ist der Wert jedoch kleiner oder gleich der negativen Breite des Papiers,
so wird der Briefkopf bündig zum linken Rand des Satzspiegels platziert.

Voreingestellt\textnote{Achtung!} ist typischerweise ein Wert von
\Length{maxdimen}\IndexLength{maxdimen}, also der größt mögliche Wert für eine
Länge. Die Folge ist eine horizontale Zentrierung.%
\EndIndex{PLength}{firstheadhpos}%


\begin{Declaration}
  \PLength{firstheadwidth}
\end{Declaration}
\BeginIndex{PLength}{firstheadwidth}%
Die Pseudolänge \PLength{firstheadwidth} gibt die Breite des Briefkopfes
an. Der Wert wird in den vordefinierten
\File{lco}-Dateien\textnote{\File{lco}-Datei}\Index{lco-Datei=\File{lco}-Datei}
unterschiedlich gesetzt. Während er normalerweise von der Papierbreite und dem
horizontalen Abstand der Empfängeradresse vom linken Papierrand abhängt,
entspricht er bei \Option{KOMAold} der Breite des Satzspiegels und ist bei
\Option{NF} fest auf 170\Unit{mm} eingestellt.%
\EndIndex{PLength}{firstheadwidth}%


\begin{Declaration}
  \PLength{fromrulethickness}\\
  \PLength{fromrulewidth}
\end{Declaration}
\BeginIndex{PLength}{fromrulethickness}%
\BeginIndex{PLength}{fromrulewidth}%
Wie bereits bei Option \Option{fromrule}\IndexOption{fromrule} in
\autoref{sec:scrlttr2.firstpage}, \autopageref{desc:scrlttr2.option.fromrule}
erwähnt wurde, kann in den vordefinierten Briefköpfen eine Linie im oder unter
dem Absender gesetzt werden. Hat\textnote{Achtung!} die Pseudolänge
\PLength{fromrulewidth} die Länge 0, so wird dabei die Länge dieser Linie
automatisch bestimmt. Dies ist die Voreinstellung bei den vordefinierten
\File{lco}-Dateien. Der Wert kann mit \Macro{@setplength} (siehe
\autopageref{desc:scrlttr2-experts.cmd.@setplength}) in eigenen
\File{lco}-Dateien aber auch abweichend gesetzt werden. Die voreingestellte
Dicke\ChangedAt{v2.97c}{\Class{scrlttr2}}, \PLength{fromrulethickness}, der
Linie beträgt 0,4\Unit{pt}.%
\EndIndex{PLength}{fromrulethickness}%
\EndIndex{PLength}{fromrulewidth}%
%
\EndIndex{}{Briefkopf}%


\subsection{Anschrift}
\label{sec:scrlttr2-experts.addressee}%
\BeginIndex{}{Anschrift}%

Unter der Anschrift versteht man normalerweise nur den Namen und die Adresse
des Empfängers. Als erste Erweiterung zur Anschrift kann die Versandart
betrachtet werden, die etwa bei Einschreiben oder Infobriefen zur Anwendung
kommt. Bei Fensterbriefumschlägen wird auch die so genannte Rücksendeadresse
zur Anschrift gezählt, da sie im Anschriftfenster zu sehen sein wird. Die
Anschrift folgt unmittelbar auf den Briefkopf.


\begin{Declaration}
  \PLength{toaddrvpos}\\
  \PLength{toaddrhpos}
\end{Declaration}
\BeginIndex{PLength}{toaddrvpos}%
\BeginIndex{PLength}{toaddrhpos}%
Diese Pseudolängen geben den Abstand des Anschriftfensters eines
Fensterbriefumschlags vom oberen und vom linken Rand des Papiers an.  Sie
werden in den vordefinierten
\File{lco}-Dateien\textnote{\File{lco}-Datei}\Index{lco-Datei=\File{lco}-Datei}
unterschiedlich eingestellt.  Für \PLength{toaddrhpos} gilt außerdem eine
Besonderheit. Ist\textnote{Achtung!} der Wert negativ, so ist sein Betrag der
Abstand des Anschriftfeldes vom rechten Rand des
Papiers. Sie\textnote{Beispiel!} finden dies beispielsweise bei \Option{SN}
oder \Option{NF}. Am kleinsten ist der Wert \PLength{toaddrvpos} bei
\Option{DINmtext}. Hier kann es schnell passieren, dass der Briefkopf in das
Anschriftfenster ragt. Ob das Anschriftfenster überhaupt gesetzt wird, hängt
von der Option \Option{addrfield} ab (siehe \autoref{sec:scrlttr2.firstpage},
\autopageref{desc:scrlttr2.option.addrfield}).%
\EndIndex{PLength}{toaddrhpos}%
\EndIndex{PLength}{toaddrvpos}%


\begin{Declaration}
  \PLength{toaddrheight}
\end{Declaration}
\BeginIndex{PLength}{toaddrheight}%
Diese Pseudolänge gibt die Höhe des Anschriftfeldes einschließlich der
Versandart an. Ist keine Versandart angegeben, so wird die Anschrift vertikal
innerhalb dieses Feldes zentriert. Ist eine Versandart angegeben, so wird die
Anschrift unterhalb der Versandart vertikal im Rest des Anschriftfeldes
zentriert.%
\EndIndex{PLength}{toaddrheight}


\begin{Declaration}
  \PLength{toaddrwidth}
\end{Declaration}
\BeginIndex{PLength}{toaddrwidth}%
Diese Pseudolänge gibt die Breite des Anschriftfensters an. Diese wird in den
vordefinierten \File{lco}-Dateien\textnote{\File{lco}-Datei}\Index{lco-Datei=\File{lco}-Datei} entsprechend der unterschiedlichen Normen
unterschiedlich eingestellt. Typische Werte liegen zwischen 70\Unit{mm} und
100\Unit{mm}.
\begin{Example}
  Angenommen, Sie haben das Problem, dass Ihr Drucker einen sehr breiten
  unbedruckbaren rechten oder linken Rand von 15\Unit{mm} besitzt. Dadurch
  kann bei Option \Option{SN} der Briefkopf, die Absenderergänzung und die
  Anschrift nicht komplett gedruckt werden. Sie erstellen daher eine neue
  \File{lco}-Datei mit folgendem Inhalt:
\begin{lstcode}
  \ProvidesFile{SNmmarg.lco}
               [2002/06/04 v0.1 my own lco]
  \LoadLetterOption{SN}
  \@addtoplength{toaddrwidth}{%
    -\useplength{toaddrhpos}}
  \@setplength{toaddrhpos}{-15mm}
  \@addtoplength{toaddrwidth}{%
    \useplength{toaddrhpos}}
  \endinput
\end{lstcode}
  Bis Sie sich einen Drucker mit kleineren Rändern zugelegt haben, verwenden
  Sie dann \Option{SNmmarg} an Stelle von \Option{SN}.
\end{Example}
%
\EndIndex{PLength}{toaddrwidth}%


\begin{Declaration}
  \PLength{toaddrindent}
\end{Declaration}
\BeginIndex{PLength}{toaddrindent}%
Manchmal will man, dass die Anschrift nicht am linken Rand des
Anschriftfensters beginnt und bis zum rechten Rand des Fensters reicht,
sondern ein wenig eingezogen wird. Der Wert dieses Einzugs kann über die
Pseudolänge \PLength{toaddrindent} festgelegt werden. Typischerweise ist
dieser Wert jedoch 0\Unit{pt}. 

Bei\textnote{Achtung!} jeder der
Einstellungen\ChangedAt{v3.03}{\Class{scrlttr2}}
\OptionValue{addrfield}{PP}\important[i]{%
  \OptionValue{addrfield}{PP}\\
  \OptionValue{addrfield}{image}\\
  \begin{tabular}{@{}l@{}}
    \KOption{addrfield}\\
    \quad\PValue{backgroundimage}
  \end{tabular}}\IndexOption{addrfield~=\PValue{PP}},
\OptionValue{addrfield}{image}\IndexOption{addrfield~=\PValue{image}} und
\OptionValue{addrfield}{backgroundimage}%
\IndexOption{addrfield~=\PValue{backgroundimage}} (siehe
\autoref{sec:scrlttr2.firstpage},
\autopageref{desc:scrlttr2.option.addrfield}) wird beim Wert 0\Unit{pt}
stattdessen ein Einzug von 8\Unit{mm} verwendet. Soll hier tatsächlich kein
Einzug verwendet werden, so kann mit 1\Unit{sp} ein vernachlässigbar kleiner
Einzug gesetzt werden. Desweiteren wird \PLength{toaddrindent} bei den
genannten Einstellungen für \Option{addrfield} auch für den Abstand zum
rechten Rand des Anschriftfensters verwendet.%
\EndIndex{PLength}{toaddrindent}%


\begin{Declaration}
  \PLength{backaddrheight}
\end{Declaration}
\BeginIndex{PLength}{backaddrheight}%
Bei Fensterbriefumschlägen wird der Absender häufig in einer kleinen Schrift
einzeilig über der Empfängeradresse ausgegeben. Diese Absenderangabe nennt man
Rücksendeadresse\textnote{Rücksendeadresse}%
\Index{Ruecksendeadresse=Rücksendeadresse},
da sie im Anschriftfenster sichtbar ist und der Post bei unzustellbaren
Briefen für die Rücksendung an den Absender dient. In dieser Adresse muss
daher auch nur die Information enthalten sein, die zu diesem Zweck notwendig
ist.

Die Höhe, die innerhalb des Anschriftfensters für die Rücksendeadresse zur
Verfügung steht, ist in der Pseudolänge \PLength{backaddrheight} abgelegt. Der
Wert wird in den vordefinierten \File{lco}-Dateien typischerweise auf
5\Unit{mm} eingestellt.  Ob die Rücksendeadresse überhaupt gesetzt wird,
bestimmt der Anwender mit den Optionen \Option{addrfield} (siehe
\autoref{sec:scrlttr2.firstpage},
\autopageref{desc:scrlttr2.option.addrfield}) und \Option{backaddress} (siehe
\autoref{sec:scrlttr2.firstpage},
\autopageref{desc:scrlttr2.option.backaddress}).%
\EndIndex{PLength}{backaddrheight}%


\begin{Declaration}
  \PLength{specialmailindent}\\
  \PLength{specialmailrightindent}
\end{Declaration}
\BeginIndex{PLength}{specialmailindent}%
\BeginIndex{PLength}{specialmailrightindent}%
Zwischen Rücksendeadresse und Empfängeradresse kann noch eine optionale
Versandart\Index{Versandart} gesetzt werden. Diese wird genau dann gesetzt,
wenn die Variable \Variable{specialmail} einen Inhalt hat. Die Ausrichtung
wird mit Hilfe der Pseudolängen \PLength{specialmailindent} und
\PLength{specialmailrightindent} festgelegt. Diese geben den linken und
rechten Einzug der Zeile an. In den vordefinierten \File{lco}-Dateien ist
\PLength{specialmailindent} auf den dehnbaren Wert \Macro{fill} gesetzt,
während \PLength{specialmailrightindent} auf 1\Unit{em} eingestellt ist. Damit
wird die Versandart 1\Unit{em} vom rechten Rand des Anschriftfensters
gesetzt.%
\EndIndex{PLength}{specialmailindent}%
\EndIndex{PLength}{specialmailrightindent}%

\begin{Declaration}
  \PLength{PPheadheight}\\
  \PLength{PPheadwidth}
\end{Declaration}
\BeginIndex{PLength}{PPheadheight}%
\BeginIndex{PLength}{PPheadwidth}%
Die Pseudolänge \PLength{PPheadheight} gibt bei den beiden
Einstellungen\ChangedAt{v3.03}{\Class{scrlttr2}}
\OptionValue{addrfield}{PP}\important[i]{%
  \OptionValue{addrfield}{PP}\\
  \begin{tabular}{@{}l@{}}
    \KOption{addrfield}\\
    \quad\PValue{backgroundimage}
  \end{tabular}}\IndexOption{addrfield~=\PValue{PP}} und
\OptionValue{addrfield}{backgroundimage}%
\IndexOption{addrfield~=\PValue{backgroundimage}} die Höhe an, die am Anfang
des Adressfeldes für den Port-Payé-Kopf reserviert wird. Die Pseudolänge
\PLength{PPheadwidth} wird nur bei \OptionValue{addrfield}{PP} (siehe
\autoref{sec:scrlttr2.firstpage},
\autopageref{desc:scrlttr2.option.addrfield}) verwendet und gibt die Breite
des linken Feldes des Port-Payé-Kopf mit dem P.\,P.-Logo, der Postleitzahl und
dem Ort an. Die Breite des rechten Feldes mit dem Code für den Absender und
der Priorität ist durch die Restbreite bestimmt. 

Den\textnote{Achtung!}  normalerweise voreingestellten Wert von 0\Unit{mm} für
Pseudolänge \PLength{PPheadheight} ändert \Class{scrlttr2} selbständig in
20,74\Unit{pt}. Den normalerweise voreingestellten Wert von 0\Unit{mm} für
\PLength{PPheadwidth} ändert \Class{scrlttr2} selbständig in 42\Unit{mm}.%
%
\EndIndex{PLength}{PPheadwidth}%
\EndIndex{PLength}{PPheadheight}%

\begin{Declaration}
  \PLength{PPdatamatrixvskip}
\end{Declaration}
\BeginIndex{PLength}{PPdatamatrixvskip}%
Durch\ChangedAt{v3.03}{\Class{scrlttr2}} diese Pseudolänge wird der vertikale
Abstand zwischen dem Port-Payé-Kopf und der Data-Matrix bei
\OptionValue{addrfield}{PP}\important{\OptionValue{addrfield}{PP}}\IndexOption{addrfield~=\PValue{PP}}
(siehe \autoref{sec:scrlttr2.firstpage},
\autopageref{desc:scrlttr2.option.addrfield})
festgelegt. Den\textnote{Achtung!}  normalerweise voreingestellten Wert von
0\Unit{mm} ändert \Class{scrlttr2} selbständig in 9\Unit{mm}. Die Data-Matrix
wird rechtsbündig zum Port-Payé-Kopf gesetzt.%
\EndIndex{PLength}{PPdatamatrixvskip}%
%
\EndIndex{}{Anschrift}%


\subsection{Absenderergänzungen}
\label{sec:scrlttr2-experts.locationField}
\BeginIndex{}{Absenderergaenzung=Absenderergänzung}%

Insbesondere bei Geschäftsbriefen reicht der Platz im Briefkopf und im
Seitenfuß oftmals nicht aus, um alle Angaben des Absenders unter zu bringen. Für
die zusätzlichen Informationen wird oft der Platz neben der Anschrift
genutzt. In dieser Anleitung wird dieses Feld \emph{Absenderergänzung}
genannt.


\begin{Declaration}
  \PLength{locheight}\\
  \PLength{lochpos}\\
  \PLength{locvpos}\\
  \PLength{locwidth}
\end{Declaration}
\BeginIndex{PLength}{locwidth}%
\BeginIndex{PLength}{locheight}%
\BeginIndex{PLength}{lochpos}%
\BeginIndex{PLength}{locvpos}%
Die Pseudolängen \PLength{locwidth} und
\PLength{locheight}\ChangedAt{v2.97d}{\Class{scrlttr2}} geben die Breite und
Höhe der Absenderergänzung an. Die Pseudolängen \PLength{lochpos} und
\PLength{locvpos} geben die Abstände von der rechten und der oberen
Papierkante an. Diese Werte werden in den vordefinierten \File{lco}-Dateien
typischerweise auf 0\Unit{pt} gesetzt. Dieser\textnote{Achtung!} Wert nimmt
eine Sonderstellung ein. Er bedeutet, dass die Werte erst bei
\Macro{opening}\IndexCmd{opening} an Hand der Breite des Papiers, der Breite
des Anschriftfensters und des Abstandes des Anschriftfensters von der linken
und oberen Papierkante gesetzt werden. Dabei findet auch die Option
\Option{locfield} (siehe \autoref{sec:scrlttr2.firstpage},
\autopageref{desc:scrlttr2.option.locfield})
Berücksichtigung. Wie\textnote{Achtung!} auch bei \PLength{toaddrhpos} nehmen
negative Werte für \PLength{lochpos} eine Sonderstellung ein. Es wird dann
statt des Abstandes vom rechten Papierrand der Betrag von \PLength{lochpos}
als Abstand vom linken Papierrand verwendet. Die Bedeutung ist also genau
umgekehrt zu der bei \PLength{toaddrhpos} (siehe
\autoref{sec:scrlttr2-experts.addressee},
\autopageref{desc:scrlttr2-experts.plength.toaddrhpos}).%
\EndIndex{PLength}{locwidth}%
\EndIndex{PLength}{locheight}%
\EndIndex{PLength}{lochpos}%
\EndIndex{PLength}{locvpos}%
%
\EndIndex{}{Absenderergaenzung=Absenderergänzung}%


\subsection{Geschäftszeile}
\label{sec:scrlttr2-experts.refLine}%
\BeginIndex{}{Geschaeftszeile=Geschäftszeile}%

Die Geschäftszeile kann auch länger als eine Zeile sein und wird nur gesetzt,
wenn mindestens eine der Variablen für die Geschäftszeile nicht leer ist.  Es
werden nur die Felder gesetzt, die nicht leer sind. Um\textnote{Tipp!} ein
scheinbar leeres Feld zu setzen, muss man der entsprechenden Variablen einen
scheinbar leeren Inhalt, beispielsweise ein festes Leerzeichen oder
\Macro{null}, geben. Wird auf die Geschäftszeile verzichtet, so werden an
ihrer Stelle Bezeichnung und Inhalt der Variablen \Variable{date}
ausgegeben. Informationen, wie Variablen zur Geschäftszeile hinzugefügt oder
entfernt werden, sind in \autoref{sec:scrlttr2-experts.variables},
\autopageref{desc:scrlttr2-experts.cmd.removereffields} zu finden.


\begin{Declaration}
  \PLength{refvpos}
\end{Declaration}
\BeginIndex{PLength}{refvpos}%
Diese Pseudolänge gibt den Abstand der Geschäftszeile von der Oberkante des
Papiers an. Ihr Wert wird in den vordefinierten \File{lco}-Dateien\textnote{\File{lco}-Datei}\Index{lco-Datei=\File{lco}-Datei}
unterschiedlich eingestellt. Typische Werte liegen zwischen 80{,}5\Unit{mm}
und 98{,}5\Unit{mm}.%
\EndIndex{PLength}{refvpos}%


\begin{Declaration}
  \PLength{refwidth}\\
  \PLength{refhpos}
\end{Declaration}
\BeginIndex{PLength}{refwidth}%
\BeginIndex{PLength}{refhpos}%
Die Pseudolänge \PLength{refwidth} gibt die Breite an, die für die
Geschäftszeile zur Verfügung steht. Ihr Wert wird in den vordefinierten
\File{lco}-Dateien typischerweise auf 0\Unit{pt}
gesetzt. Dieser\textnote{Achtung!} Wert hat eine besondere Bedeutung. Es wird
damit keineswegs festgelegt, dass für die Geschäftszeile keine Breite zur
Verfügung steht. Vielmehr bedeutet der Wert, dass die verfügbare Breite erst
innerhalb von \Macro{opening}\IndexCmd{opening} ermittelt wird.  Die dort
ermittelte Breite richtet sich dann nach der Einstellung der Option
\Option{refline}\important{\Option{refline}}%
\IndexOption{refline~=\PName{Einstellung}} (siehe
\autoref{sec:scrlttr2.firstpage},
\autopageref{desc:scrlttr2.option.refline}). Gleichzeitig wird dann auch
\PLength{refhpos} entsprechend der Option gesetzt. Bei
\OptionValue{refline}{wide}\IndexOption{refline~=\PValue{wide}} wird die
Geschäftszeile zentriert, wohingegen sie bei
\OptionValue{refline}{narrow}\IndexOption{refline~=\PValue{narrow}} am
Satzspiegel links ausgerichtet wird.

Ist \PLength{refwidth} von Null verschieden, wird die Breite der
Geschäftszeile also nicht von der Option \Option{refline} bestimmt, so gibt
\PLength{refhpos} den Abstand der Geschäftszeile von der linken Papierkante
an. Ist\textnote{Achtung!} dieser Abstand Null, so wird die Geschäftszeile so
ausgerichtet, dass das Verhältnis zwischen ihrem Abstand von der linken
Papierkante zu ihrem Abstand von der rechten Papierkante dem Verhältnis
zwischen dem Abstand des Satzspiegels von der linken Papierkante zu seinem
Abstand von der rechten Papierkante entspricht. Bei auf dem Papier horizontal
zentriertem Satzspiegel wird also auch die Geschäftszeile zentriert.

In der Regel werden diese Sonderfälle für die häufigsten Anwendungen von
geringem Interesse sein. Die\textnote{Tipp!} einfachste Regel lautet
hier: Entweder wird \PLength{refwidth} auf Null belassen und die Breite und
Ausrichtung der Geschäftszeile über die Option \Option{refline} bestimmt,
oder sowohl \PLength{refwidth} als auch \PLength{refhpos} werden vom Anwender
vorgegeben.%
\EndIndex{PLength}{refwidth}%
\EndIndex{PLength}{refhpos}%


\begin{Declaration}
  \PLength{refaftervskip}
\end{Declaration}
\BeginIndex{PLength}{refaftervskip}%
Diese Pseudolänge gibt den vertikalen Abstand an, der nach der Geschäftszeile
eingefügt werden soll. Der Wert wird in den vordefinierten \File{lco}-Dateien\textnote{\File{lco}-Datei}\Index{lco-Datei=\File{lco}-Datei}
eingestellt. Er wirkt sich unmittelbar auf die Höhe des Textbereiches der
ersten Seite aus. Der typische Wert liegt zwischen einer und zwei Zeilen.%
\EndIndex{PLength}{refaftervskip}%
%
\EndIndex{}{Geschaeftszeile=Geschäftszeile}%

%% NEW FEATURE 3.01
\subsection{Betreff}
\label{sec:scrlttr2-experts.subject}%
\BeginIndex{}{Betreff}

Der Betreff eine Briefes wird in unterschiedlichen Ländern unterschiedlich
gesetzt. Die einen haben ihn gerne vor der Anrede, die anderen setzen ihn
danach. Einige Berufsgruppen wollen ihn teilweise sogar vor der Geschäftszeile
haben.

\begin{Declaration}
  \PLength{subjectvpos}
\end{Declaration}
\BeginIndex{PLength}{subjectvpos}%
\ChangedAt{v3.01}{\Class{scrlttr2}}%
Ist\textnote{Achtung!} der Wert dieser Pseudolänge 0\Unit{pt}, so bestimmt die
Option \Option{subject}\important{\Option{subject}}%
\IndexOption{subject~=\PName{Einstellung}} (siehe
\autoref{sec:scrlttr2.firstpage}, \autopageref{desc:scrlttr2.option.subject})
die Position des Betreffs. Dabei spielen dann auch die nachfolgend erklärten
Pseudolängen \PLength{subjectbeforevskip} und \PLength{subjectaftervskip} ihre
Rolle. Bei allen anderen Werten wird der Betreff mit dem entsprechenden
Abstand von der oberen Papierkante platziert. Es\textnote{Tipp!} wird
empfohlen in diesem Fall darauf zu achten, dass genügend Platz zur Verfügung
steht, damit Überschneidungen mit anderen Elementen unwahrscheinlich sind.
\begin{Example}
  Einige wenige Berufsgruppen ziehen es vor, wenn der Betreff noch vor der
  Geschäftszeile steht. Hierzu kann man die Position wie folgt wählen, wobei
  auch die Position der Geschäftszeile angepasst wird:
\begin{lstcode}
  \ProvidesFile{lawsubj.lco}
               [2008/11/03 lawyers lco file]
  \@setplength{subjectvpos}{\useplength{refvpos}}
  \@addtoplength{refvpos}{3\baselineskip}
  \endinput
\end{lstcode}
  Will man, dass zwischen Betreff und Geschäftszeile noch mindestens eine
  Zeile frei bleibt, hat man so Platz für maximal zwei Zeilen Betreff.
\end{Example}
\EndIndex{PLength}{subjectvpos}%


\begin{Declaration}
  \PLength{subjectbeforevskip}\\
  \PLength{subjectaftervskip}
\end{Declaration}
\BeginIndex{PLength}{subjectbeforevskip}%
\BeginIndex{PLength}{subjectaftervskip}%
\ChangedAt{v3.01}{\Class{scrlttr2}}%
Wird der Betreff nicht absolut platziert, sondern vor oder nach der Anrede, so
kann vor und nach dem Betreff ein zusätzlicher Abstand eingefügt werden. Der
Abstand vor dem Betreff trifft dabei ggf. mit anderen Abständen, etwa dem
automatischen Abstand von einer Zeile nach dem Titel, zusammen. In der
Voreinstellung wird daher in der Regel kein weiterer Abstand an dieser Stelle
eingefügt. Der Abstand nach dem Betreff beträgt in der Voreinstellung der
Klasse hingegen zwei Zeilen.%
\EndIndex{PLength}{subjectaftervskip}%
\EndIndex{PLength}{subjectbeforevskip}%
\EndIndex{}{Betreff}
%% END NEW FEATURE 3.01


\subsection{Schlussgruß}
\label{sec:scrlttr2-experts.closing}
\BeginIndex{}{Schlussgruss=Schlussgruß}

Der Schlussgruß\Index{Gruss=Gruß} eines Briefes besteht aus mehreren Teilen.
Neben der Grußformel selbst gibt es noch die Unterschrift und die Signatur,
eine Art Erläuterung zur Unterschrift.


\begin{Declaration}
  \PLength{sigindent}\\
  \PLength{sigbeforevskip}
\end{Declaration}
\BeginIndex{PLength}{sigindent}%
\BeginIndex{PLength}{sigbeforevskip}%
Grußfloskel\Index{Gruss=Gruß}\Index{Signatur} und Erläuterung der
Unterschrift\Index{Unterschrift} werden innerhalb einer Box gesetzt.  Die
Breite dieser Box wird durch die längste Zeile innerhalb von Grußfloskel und
Erläuterung bestimmt.

Die Box wird mit dem durch die Pseudolänge \PLength{sigindent} bestimmten
Einzug gesetzt. In den vordefinierten \File{lco}-Dateien ist der Einzug auf
0\Unit{mm} gesetzt.

Zwischen Grußfloskel und Erläuterung wird ein vertikaler Abstand eingefügt,
der mit der Pseudolänge \PLength{sigbeforevskip} festgelegt ist. In den
vordefinierten \File{lco}-Dateien ist der Wert auf zwei Zeilen eingestellt. In
diese Lücke setzen Sie dann Ihre Unterschrift.%
\EndIndex{PLength}{sigindent}%
\EndIndex{PLength}{sigbeforevskip}%
%
\EndIndex{}{Schlussgruss=Schlussgruß}


\subsection{Briefbogenfuß}
\label{sec:scrlttr2-experts.firstFoot}%
\BeginIndex{}{Briefbogenfuss=Briefbogenfuß}%

Die erste Seite eines Briefes, der Briefbogen, enthält nicht nur einen eigenen
Kopf, den Briefkopf. Diese Seite enthält auch einen eigenen
Fuß\Index{Fuss=Fuß}. Auch dieser wird nicht über den Seitenstil, sondern
direkt von \Macro{opening}\IndexCmd{opening}\important{\Macro{opening}}
ausgegeben.


\begin{Declaration}
  \PLength{firstfootvpos}
\end{Declaration}
\BeginIndex{PLength}{firstfootvpos}%
Diese Pseudolänge gibt den Abstand des Fußes der ersten Briefseite von der
Oberkante des Papiers an. Es wird außerdem dafür gesorgt, dass der Textbereich
nicht in den Fuß hineinragt. Hierzu wird auf der ersten Seite gegebenenfalls
die Höhe des Textbereiches mit Hilfe von
\Macro{enlargethispage}\IndexCmd{enlargethispage}%
\important{\Macro{enlargethispage}} verkleinert. Mit Hilfe der Option
\Option{enlargefirstpage}\important{\Option{enlargefirstpage}} (siehe
\autoref{sec:scrlttr2.firstpage},
\autopageref{desc:scrlttr2.option.enlargefirstpage}) kann dafür gesorgt
werden, dass die Höhe des Textbereiches umgekehrt gegebenenfalls auch
vergrößert wird. Damit kann dann der Abstand zwischen Textbereich und Fuß der
ersten Seite auf den Wert der Länge
\Length{footskip}\IndexLength{footskip}\important{\Length{footskip}}
verringert werden.

Bei\textnote{Achtung!}
Kompatibilitätseinstellungen\ChangedAt{v2.9t}{\Class{scrlttr2}} bis
Version~2.9t\IndexOption{version~=\PValue{2.9t}} (siehe \Option{version} in
\autoref{sec:scrlttr2.compatibilityOptions},
\autopageref{desc:scrlttr2.option.version}) wird außer bei \Option{KOMAold}
und \Option{NF} in allen vordefinierten
\File{lco}-Dateien\textnote{\File{lco}-Datei}\Index{lco-Datei=\File{lco}-Datei}
(siehe \autoref{sec:scrlttr2.lcoFile}) der Fuß abhängig vom Satzspiegel
gesetzt.  Damit hat dann auch
\Option{enlargefirstpage}\important{\Option{enlargefirstpage}} keine
Wirkung. Ab Version 2.9u\IndexOption{version~=\PValue{2.9u}} bekommt der Fuß
eine Position am unteren Ende des Papiers. Damit ist dann die Höhe des
Satzspiegels des Briefbogens eventuell auch von der Option
\Option{enlargefirstpage} abhängig.

Sollte der Briefbogenfuß mittels Option
\OptionValue{firstfoot}{false}\important{\OptionValue{firstfoot}{false}}%
\IndexOption{firstfoot~=\PValue{false}}\ChangedAt{v2.97e}{\Class{scrlttr2}}
(siehe \autoref{sec:scrlttr2.firstpage},
\autopageref{desc:scrlttr2.option.firstfoot}) abgeschaltet sein, so wird die
Einstellung von \PLength{firstfootvpos} ignoriert und stattdessen
\Length{paperheight}\IndexLength{paperheight} angenommen. Es bleibt damit dann
ein minimaler unterer Rand von \Length{footskip}\IndexLength{footskip}.%
\EndIndex{PLength}{firstfootvpos}%


\begin{Declaration}
  \PLength{firstfoothpos}
\end{Declaration}
\BeginIndex{PLength}{firstfoothpos}%
Die\textnote{Achtung!} Pseudolänge
\PLength{firstfoothpos}\ChangedAt{v3.05}{\Class{scrlttr2}} gibt bei einem
positiven Wert den Abstand des Briefbogenfußes von der linken Papierkante
an. Ist der Wert sogar größer oder gleich der Breite des Papiers,
\Length{paperwidth}\IndexLength{paperwidth}, so wird der Fuß horizontal
zentriert auf dem Briefbogen platziert. Ein negativer Wert gibt den Abstand
des Fußes von der rechten Papierkante an. Ist der Wert jedoch kleiner oder
gleich der negativen Breite des Papiers, so wird der Fuß bündig zum linken
Rand des Satzspiegels platziert.

Voreingestellt ist typischerweise ein Wert von
\Length{maxdimen}\IndexLength{maxdimen}, also der größt mögliche Wert für eine
Länge. Die Folge ist eine horizontale Zentrierung.%
\EndIndex{PLength}{firstfoothpos}%


\begin{Declaration}
  \PLength{firstfootwidth}
\end{Declaration}
\BeginIndex{PLength}{firstfootwidth}%
Diese Pseudolänge gibt die Breite des Fußes der ersten Briefseite, also des
Briefbogens, an. Der Wert stimmt in den vordefinierten \File{lco}-Dateien mit
\PLength{firstheadwidth}\important{\PLength{firstheadwidth}}%
\IndexPLength{firstheadwidth} überein.%
%
\EndIndex{PLength}{firstfootwidth}%
%
\EndIndex{}{Briefbogenfuss=Briefbogenfuß}%
%
\EndIndex{}{Pseudolängen}


\section{Variablen für fortgeschrittene Anwender}
\label{sec:scrlttr2-experts.variables}
\BeginIndex{}{Variablen}

Neben der Möglichkeit, vordefinierte Variablen zu verwenden, bietet
\Class{scrlttr2} auch Anweisungen, um neue Variablen zu definieren oder deren
automatische Verwendung innerhalb der Geschäftszeile zu beeinflussen.


\begin{Declaration}
  \Macro{newkomavar}\OParameter{Bezeichnung}\Parameter{Name}\\
  \Macro{newkomavar*}\OParameter{Bezeichnung}\Parameter{Name}\\
  \Macro{removereffields}\\
  \Macro{defaultreffields}\\
  \Macro{addtoreffields}\Parameter{Name}
\end{Declaration}
\BeginIndex{Cmd}{newkomavar}%
\BeginIndex{Cmd}{newkomavar*}%
\BeginIndex{Cmd}{addtoreffields}%
\BeginIndex{Cmd}{removereffields}%
\BeginIndex{Cmd}{defaultreffields}%
Mit \Macro{newkomavar} wird eine neue Variable definiert. Diese Variable wird
über \PName{Name} angesprochen. Optional kann eine \PName{Bezeichnung} für die
Variable \PName{Name} angegeben werden. Eine \PName{Bezeichnung} wird dabei im
Unterschied zum \PName{Name} nicht verwendet, um auf eine Variable
zuzugreifen. Vielmehr ist die \PName{Bezeichnung} eine Ergänzung zum Inhalt
einer Variable, die ähnlich ihrem Inhalt ausgegeben werden kann. 

Mit der Anweisung \Macro{addtoreffields} kann die Variable \PName{Name} der
Geschäftszeile\Index{Geschaeftszeile=Geschäftszeile} (siehe
\autoref{sec:scrlttr2.firstpage}, \autopageref{desc:scrlttr2.option.refline})
hinzugefügt werden. Dabei wird die \PName{Bezeichnung} und der Inhalt der
Variablen an das Ende der Geschäftszeile angehängt, falls ihr Inhalt nicht
leer ist. Die Sternvariante \Macro{newkomavar*} entspricht der Variante ohne
Stern mit anschließendem Aufruf der Anweisung \Macro{addtoreffields}. Bei der
Sternvariante wird die Variable also automatisch zur Geschäftszeile
hinzugefügt.
\begin{Example}
  Angenommen, Sie benötigen in der Geschäftszeile ein zusätzliches Feld
  für eine Durchwahl. Sie können das Feld dann wahlweise mit
\begin{lstcode}
  \newkomavar[Durchwahl]{myphone}
  \addtoreffields{myphone}
\end{lstcode}
  oder kürzer mit
\begin{lstcode}
  \newkomavar*[Durchwahl]{myphone}
\end{lstcode}
  definieren.
\end{Example}
Im\textnote{Achtung!} Fall, dass eine Variable für die Geschäftszeile
definiert wird, sollten Sie immer eine Bezeichnung dafür angeben.

Mit der Anweisung \Macro{removereffields} können alle Variablen aus der
Geschäftszeile entfernt werden. Dies betrifft auch die in der Klasse
vordefinierten Variablen. Die Geschäftszeile ist dann leer. Sie können dies
beispielsweise nutzen, wenn Sie die Reihenfolge der Variablen in der
Geschäftszeile ändern wollen.

Zur Wiederherstellung der Reihenfolge der vordefinierten Variablen in der
Geschäftszeile dient \Macro{defaultreffields}. Dabei werden auch alle
selbst definierten Variablen aus der Geschäftszeile entfernt.

Das\textnote{Achtung!} Datum sollte der Geschäftszeile nicht über die
Anweisung \Macro{addtoreffields} hinzugefügt werden. Stattdessen stellt man
mit Option
\Option{date}\important[i]{\OptionValue{refline}{dateleft}\\
  \OptionValue{refline}{dateright}\\
  \OptionValue{refline}{nodate}}%
\IndexOption{refline~=\PValue{dateleft}}%
\IndexOption{refline~=\PValue{dateright}}%
\IndexOption{refline~=\PValue{nodate}} ein, ob das Datum links, rechts oder
gar nicht in der Geschäftszeile erscheinen soll. Diese Optionen haben darüber
hinaus auch einen Einfluss auf die Position des Datums, wenn gar keine
Geschäftszeile verwendet wird.%
%
\EndIndex{Cmd}{defaultreffields}%
\EndIndex{Cmd}{newkomavar}\EndIndex{Cmd}{newkomavar*}%
\EndIndex{Cmd}{addtoreffields}\EndIndex{Cmd}{removereffields}%


\begin{Declaration}
  \Macro{usekomavar}\OParameter{Anweisung}\Parameter{Name}\\
  \Macro{usekomavar*}\OParameter{Anweisung}\Parameter{Name}
\end{Declaration}
\BeginIndex{Cmd}{usekomavar}%
\BeginIndex{Cmd}{usekomavar*}%
Die Anweisungen \Macro{usekomavar} und \Macro{usekomavar*} sind wie alle
Anweisungen, von denen es eine Sternvariante gibt oder die ein optionales
Argument besitzen, nicht voll expandierbar.  Bei Verwendung innerhalb von
\Macro{markboth}\IndexCmd{markboth}, \Macro{markright}\IndexCmd{markright}
oder ähnlichen Anweisungen muss dennoch kein \Macro{protect}\IndexCmd{protect}
vorangestellt werden. Selbstverständlich gilt dies bei Verwendung von
\Package{scrpage2} auch für \Macro{markleft}\IndexCmd{markleft}.
Allerdings\textnote{Achtung!}  können die Anweisungen nicht innerhalb von
\Macro{MakeUppercase}\important{\Macro{MakeUppercase}}\IndexCmd{MakeUppercase}
und ähnlichen Anweisungen verwendet werden, die direkten Einfluss auf ihr
Argument haben. Diese Anweisungen können jedoch als optionales Argument
angegeben werden. So erhält man beispielsweise den Inhalt einer Variable in
Großbuchstaben mit:
\begin{lstcode}[escapeinside=»«]
  \usekomavar[\MakeUppercase]{»\PName{Name}«}
\end{lstcode}
%
\EndIndex{Cmd}{usekomavar}%
\EndIndex{Cmd}{usekomavar*}%


\begin{Declaration}
  \Macro{ifkomavarempty}\Parameter{Name}\Parameter{Wahr}\Parameter{Falsch}\\
  \Macro{ifkomavarempty*}\Parameter{Name}\Parameter{Wahr}\Parameter{Falsch}
\end{Declaration}
\BeginIndex{Cmd}{ifkomavarempty}%
\BeginIndex{Cmd}{ifkomavarempty*}%
Für die exakte Funktion ist wichtig, dass der Inhalt der Variablen soweit
expandiert wird, wie dies mit \Macro{edef} möglich ist. Bleiben dabei
Leerzeichen oder unexpandierbare Makros wie \Macro{relax} übrig, so gilt der
Inhalt auch dann als nicht leer, wenn die Verwendung der Variablen zu keiner
Ausgabe führen würde.

Auch\textnote{Achtung!} diese Anweisung kann nicht innerhalb von
\Macro{MakeUppercase} oder ähnlichen Anweisungen verwendet werden. Sie ist
jedoch robust genug, um beispielsweise als Argument von \Macro{markboth} oder
\Macro{footnote} zu funktionieren.
%
\EndIndex{Cmd}{ifkomavarempty*}%
\EndIndex{Cmd}{ifkomavarempty}%
%
\EndIndex{}{Variablen}


\section{\File{lco}-Dateien für fortgeschrittene Anwender}
\label{sec:scrlttr2-experts.lcoFile}
\BeginIndex{File}{lco}
\BeginIndex{}{lco-Datei=\File{lco}-Datei}

\BeginIndex{}{Papierformat>Beschraenkungen=Beschränkungen}%
Obwohl jedes von \Package{typearea} einstellbare Format verwendbar ist, kann
es bei der Ausgabe der ersten Briefseite mit manchen Formaten zu unerwünschten
Ergebnissen kommen. Das liegt aber nicht am Konzept der Klasse, sondern daran,
dass derzeit hauptsächlich Parametersätze für ISO A4 existieren. Leider gibt
es keine allgemein gültigen Regeln, um die Position von Anschriftfeldern und
Ähnlichem für beliebige Papierformate zu berechnen. Es ist jedoch möglich,
auch für andere Papierformate Parametersätze zu erstellen.%
\EndIndex{}{Papierformat>Beschraenkungen=Beschränkungen}%


\subsection{Überwachung des Papierformats}
\label{sec:scrlttr2-experts.papersize}

Derzeit existieren Parametersätze und \File{lco}-Dateien für A4-Papier und
letter-Papier. Die Klasse \Class{scrlttr2} versteht aber theoretisch sehr viel
mehr Papierformate. Daher ist es notwendig zu überwachen, ob die korrekte
Papiergröße eingestellt ist.

\begin{Declaration}
  \Macro{LetterOptionNeedsPapersize}%
    \Parameter{Optionsname}\Parameter{Papiergröße}
\end{Declaration}
\BeginIndex{Cmd}{LetterOptionNeedsPapersize}%
Damit man bei Verwendung einer in der \File{lco}-Datei nicht vorgesehenen
\PName{Papiergröße}\Index{Papierformat} zumindest gewarnt wird, sind in den
mit \KOMAScript{} ausgelieferten \File{lco}-Dateien
\Macro{LetterOptionNeedsPapersize}-Anweisungen zu finden. Als erstes Argument
wird dabei der Name der \File{lco}-Datei ohne die Endung »\File{.lco}«
übergeben. Als zweites Argument wird die Papiergröße übergeben, für die diese
\File{lco}-Datei gedacht ist.

Werden nacheinander mehrere \File{lco}-Dateien geladen, so kann jede dieser
\File{lco}-Dateien eine Anweisung \Macro{LetterOptionNeedsPapersize}
enthalten. Innerhalb von \Macro{opening}\IndexCmd{opening} wird jedoch nur auf
die jeweils letzte angegebene \PName{Papiergröße} geprüft. Wie das
nachfolgende Beispiel zeigt, ist es daher für den versierten Anwender leicht
möglich, \File{lco}-Dateien mit Parametersätzen für andere Papierformate zu
schreiben. 
\iffalse% Umbruchoptimierung!!!
Wer allerdings nicht vor hat, selbst solche \File{lco}-Dateien zu
schreiben, der kann die Erklärung zu dieser Anweisung gleich wieder vergessen
und auch das Beispiel überspringen.
\fi
\begin{Example}
  Nehmen wir einmal an, dass Sie A5-Papier in normaler Ausrichtung, also
  hochkant oder portrait, für Ihre Briefe verwenden. Nehmen wir weiter an,
  dass Sie diese in normale Fensterbriefumschläge im Format C6 stecken. Damit
  wäre prinzipiell die Position des Adressfeldes die gleiche wie bei einem
  normalen Brief in A4 nach DIN. Der Unterschied besteht im Wesentlichen
  darin, dass das A5-Papier nur einmal gefaltet werden muss. Sie wollen
  deshalb verhindern, dass die obere und die untere Faltmarke gesetzt
  wird. Dies erreichen Sie beispielsweise, indem Sie die Marken außerhalb des
  Papiers platzieren.
\begin{lstcode}
  \ProvidesFile{a5.lco}
               [2002/05/02 letter class option]
  \LetterOptionNeedsPapersize{paper=a5}{a5}
  \@setplength{tfoldmarkvpos}{\paperheight}
  \@setplength{bfoldmarkvpos}{\paperheight}
  \endinput
\end{lstcode}
  Eleganter wäre es natürlich, die Marken mit Hilfe der Option
  \Option{foldmarks} abzuschalten.  Außerdem muss auch noch die Position des
  Seitenfußes, also die Pseudolänge \PLength{firstfootvpos}, angepasst
  werden. Ich überlasse es dem Leser, dafür einen geeigneten Wert zu
  ermitteln. Mit einer solchen \File{lco}-Datei ist es lediglich wichtig, dass
  andere \File{lco}-Dateioptionen wie \File{SN} vor dem Laden von
  »\File{a5.lco}«, angegeben werden.
\end{Example}
%
\EndIndex{Cmd}{LetterOptionNeedsPapersize}%

\subsection{Positionen sichtbar machen}
\label{sec:scrlttr2-experts.visualize}
\BeginIndex{Option}{visualize}

Wenn man selbst \File{lco}-Dateien entwickelt, beispielsweise um die
Positionen von verschiedenen Feldern des Briefbogens an eigene Wünsche oder
Notwendigkeiten anzupassen, ist es hilfreich, wenn zumindest einige Elemente
direkt sichtbar gemacht werden können. Zu diesem Zweck existiert die
\File{lco}-Datei
\File{visualize.lco}\ChangedAt{v3.04}{\Class{scrlttr2}}. Diese kann wie jede
\File{lco}-Datei geladen werden. Allerdings ist das Laden dieser \emph{Letter
  Class Option} auf die Dokumentpräambel beschränkt und seine Auswirkungen
können nicht wieder rückgängig gemacht werden. Die \File{lco}-Datei bedient
sich der Pakete
\Package{eso-pic}\IndexPackage{eso-pic}%
\important[i]{\Package{eso-pic}\\\Package{graphicx}}
und \Package{graphicx}\IndexPackage{graphicx}, die nicht zu \KOMAScript{}
gehören.

\begin{Declaration}
  \Macro{showfields}\Parameter{Feldliste}
\end{Declaration}
\BeginIndex{Cmd}{showfields}%
Mit dieser Anweisung kann die Visualisierung von Feldern des Briefbogens
aktiviert werden. Das Argument \PName{Feldliste} ist dabei eine durch Komma
separierte Liste der Feldern, die visualisiert werden sollen. Folgende Felder
werden derzeit unterstützt:
\begin{labeling}[~--]{\PValue{location}}
\item[\PValue{test}] ist ein Testfeld der Größe 10\Unit{cm} auf 15\Unit{cm},
  das jeweils 1\Unit{cm} vom oberen und linken Papierrand entfernt ist. Dieses
  Testfeld existiert zu Debuggingzwecken. Es dient als Vergleichsmaß für den
  Fall, dass im Dokumenterstellungsprozess die Maße verfälscht werden.
\item[\PValue{head}] ist der Kopfbereich des Briefbogens. Es handelt sich hier
  um ein nach unten offenes Feld.
\item[\PValue{foot}] ist der Fußbereich des Briefbogens. Es handelt sich hier
  um ein nach unten offenes Feld.
\item[\PValue{address}] ist das Anschriftfenster.
\item[\PValue{location}] ist das Feld der Absenderergänzung.
\item[\PValue{refline}] ist die Geschäftszeile. Es handelt sich hier um ein
  nach unten offenes Feld.
\end{labeling}%
\BeginIndex{FontElement}{field}%
Mit Hilfe der Anweisungen \Macro{setkomafont} und \Macro{addtokomafont} (siehe
\autoref{sec:scrlttr2.textmarkup},
\autopageref{desc:scrlttr2.cmd.setkomafont}) für das Element
\FontElement{field}\important{\FontElement{field}} kann die Farbe der
Visualisierung geändert werden. Voreingestellt ist \Macro{normalcolor}.%
\EndIndex{FontElement}{field}%
%
\EndIndex{Cmd}{showfields}

\begin{Declaration}
  \Macro{setshowstyle}\Parameter{Visualisierungsstil}\\
  \Macro{edgesize}
\end{Declaration}
\BeginIndex{Cmd}{setshowstyle}%
\BeginIndex{Cmd}{edgesize}
In der Voreinstellung werden die einzelnen Felder durch
Begrenzungslinien\important{\PValue{frame}} markiert. Dies entspricht dem
\PName{Visualisierungsstil} \PValue{frame}. Nach unten offene Felder werden
dabei nicht komplett umrahmt, sondern unten offen mit kleinen Pfeilen nach
unten dargestellt. Als Alternative\important{\PValue{rule}} hierzu steht auch
der \PName{Visualisierungsstil} \PValue{rule} zur Verfügung. Dabei wird das
Feld farbig hinterlegt. Hierbei kann nicht zwischen geschlossenen und nach
unten offenen Feldern unterschieden werden. Stattdessen werden nach unten
offene Felder mit einer Mindesthöhe dargestellt. Der
dritte\important{\PValue{edge}} verfügbare \PName{Visualisierungsstil} ist
\PValue{edge}. Dabei werden die Ecken der Felder markiert. Bei nach unten
offenen Feldern entfallen dabei die unteren Eckmarkierungen. Die Größe der
Eckmarkierungen ist im Makro \Macro{edgesize} abgelegt und mit 1\Unit{ex}
voreingestellt.
\EndIndex{Cmd}{edgesize}
\EndIndex{Cmd}{setshowstyle}

\begin{Declaration}
  \Macro{showenvelope}(\PName{Breite},\PName{Höhe})%
                      (\PName{HOffset},\PName{VOffset})\OParameter{Zusatz}\\
  \Macro{showISOenvelope}\Parameter{Format}\OParameter{Zusatz}\\
  \Macro{showUScommercial}\Parameter{Format}\OParameter{Zusatz}\\
  \Macro{showUScheck}\OParameter{Zusatz}\\
  \Macro{unitfactor}
\end{Declaration}
\BeginIndex{Cmd}{showenvelope}%
\BeginIndex{Cmd}{showISOenvelope}%
\BeginIndex{Cmd}{showUScommercial}%
\BeginIndex{Cmd}{showUScheck}%
\BeginIndex{Cmd}{unitfactor}%
Diese Anweisungen dienen dazu eine Seite mit einer Zeichnung eines Umschlags
auszugeben. Der Umschlag wird dabei immer um 90° gedreht auf einer eigenen
Seite im Maßstab~1:1 ausgegeben. Das Anschriftfenster wird automatisch aus den
aktuellen Daten für die Anschriftposition auf dem Briefbogen:
\PLength{toaddrvpos}, \PLength{toaddrheight}, \PLength{toaddrwidth} und
\PLength{toaddrhpos}, erzeugt. Hierfür ist es notwendig zu wissen, um welchen
Wert der gefaltete Briefbogen auf jeder Seite kleiner als die
\PName{Breite} und \PName{Höhe} des Briefbogens ist. Sind diese beiden Werte,
\PName{HOffset} und \PName{VOffset}, bei \Macro{showenvelope} nicht angegeben,
so wird versucht, sie aus den Faltmarken und der Papiergröße selbst zu
berechnen.

Die Anweisungen \Macro{showISOenvelope}, \Macro{showUScommercial} und
\Macro{showUScheck} basieren auf \Macro{showenvelope}. Mit
\Macro{showISOenvelope} kann ein ISO-Umschlag im \PName{Format} C4, C5, C5/6,
DL (auch bekannt als C5/6) oder C6 erzeugt werden. Mit
\Macro{showUScommercial} wird hingegen ein US-Commercial-Umschlag im
\PName{Format} 9 oder 10 ausgegeben. \Macro{showUScheck} schließlich ist für
Umschläge im US-Check-Format zuständig.

\BeginIndex{FontElement}{letter}%
Innerhalb des Umschlags wird die Lage des Briefbogens gestrichelt
angedeutet. Die dabei verwendete Farbe kann mit Hilfe der Anweisungen
\Macro{setkomafont} und \Macro{addtokomafont} (siehe
\autoref{sec:scrlttr2.textmarkup},
\autopageref{desc:scrlttr2.cmd.setkomafont}) für das Element
\FontElement{letter}\important{\FontElement{letter}} verändert
werden. Voreingestellt ist \Macro{normalcolor}.%
\EndIndex{FontElement}{letter}

\BeginIndex{FontElement}{measure}%
Die Umschlagzeichnung wird automatisch bemaßt. Die Farbe der Bemaßung und die
Größe deren Beschriftung kann mit Hilfe der Anweisungen \Macro{setkomafont}
und \Macro{addtokomafont} (siehe \autoref{sec:scrlttr2.textmarkup},
\autopageref{desc:scrlttr2.cmd.setkomafont}) für das Element
\FontElement{measure}\important{\FontElement{measure}} verändert
werden. Voreingestellt ist hier \Macro{normalcolor}. Die Bemaßung erfolgt in
Vielfachen von \Length{unitlength} mit einer maximalen Genauigkeit von
$1/\Macro{unitfactor}$, wobei die Genauigkeit der \TeX-Arithmetik die
tatsächliche Grenze darstellt. Voreingestellt ist 1. Eine Umdefinierung ist
mit \Macro{renewcommand} möglich.%
\EndIndex{FontElement}{measure}

\begin{Example}
  Es wird ein Beispielbrief im Format ISO~A4 erzeugt. Die unterstützten Felder
  sollen zwecks Überprüfung ihrer Position mit gelben Rahmenlinien markiert
  werden. Desweiteren soll die Position des Fensters in einem Umschlag der
  Größe~DL mit Hilfe einer Zeichnung überprüft werden. Die Maßlinien in dieser
  Zeichnung sollen rot und die Maßzahlen in kleinerer Schrift ausgegeben
  werden, wobei die Maßzahlen in cm mit einer Genauigkeit von 1\Unit{mm}
  ausgegeben werden sollen. Der gestrichelte Briefbogen im Umschlag soll
  hingegen grün eingefärbt werden.
\begin{lstcode}
  \documentclass[visualize]{scrlttr2}
  \usepackage{xcolor}
  \setkomafont{field}{\color{yellow}}
  \setkomafont{measure}{\color{red}\small}
  \setkomafont{letter}{\color{green}}
  \showfields{head,address,location,refline,foot}
  \usepackage[ngerman]{babel}
  \usepackage{lipsum}
  \begin{document}
  \setkomavar{fromname}{Peter Musterfrau}
  \setkomavar{fromaddress}{Hinter dem Tal 2\\
                           54321 Musterheim}
  \begin{letter}{%
      Petra Mustermann\\
      Vor dem Berg 1\\
      12345 Musterhausen%
    }
  \opening{Hallo,}
  \lipsum[1]
  \closing{Bis dann}
  \end{letter}
  \setlength{\unitlength}{1cm}
  \renewcommand*{\unitfactor}{10}
  \showISOenvelope{DL}
  \end{document}
\end{lstcode}
  Auf der ersten Seite findet sich nun der Briefbogen, auf der zweiten Seite
  wird die Zeichnung des Umschlags ausgegeben.
\end{Example}

Bezüglich der Bemaßung ist zu beachten, dass ungünstige Kombinationen von
\Length{unitlength} und \Macro{unitfactor} sehr schnell einen \TeX-Fehler der
Art \emph{arithmetic overflow} provozieren. Ebenso kann es geschehen, dass
ausgegebene Maßzahlen geringfügig vom tatsächlichen Wert abweichen. Beides
sind keine Fehler von \Option{visualize}, sondern lediglich
Implementierungsgrenzen.
%
\EndIndex{Cmd}{unitfactor}%
\EndIndex{Cmd}{showUScheck}%
\EndIndex{Cmd}{showUScommercial}%
\EndIndex{Cmd}{showISOenvelope}%
\EndIndex{Cmd}{showenvelope}%
%
\EndIndex{Option}{visualize}%
%
\EndIndex{}{lco-Datei=\File{lco}-Datei}%
\EndIndex{File}{lco}%


\section{Unterstützung verschiedener Sprachen}
\label{sec:scrlttr2-experts.languages}%
\BeginIndex{}{Sprachen}%
Die Klasse \Class{scrlttr2} unterstützt viele Sprachen. Dazu zählen Deutsch
(\PValue{german} für alte deutsche Rechtschreibung, \PValue{ngerman} für neue
deutsche Rechtschreibung, \PValue{austrian} für Österreichisch mit alter
deutscher Rechtschreibung und
\PValue{naustrian}\ChangedAt{v3.09}{\Class{scrlttr2}} für Österreichisch mit
neuer deutscher Rechtschreibung), Englisch (\PValue{english} ohne Angabe, ob
amerikanisches oder britisches Englisch, \PValue{american} und
\PValue{USenglish} für Amerikanisch, \PValue{british} und \PValue{UKenglish}
für Britisch), Französisch, Italienisch, Spanisch, Niederländisch, Kroatisch,
Finnisch, Norwegisch\ChangedAt{v3.02}{\Class{scrlttr2}} und
Schwedisch\ChangedAt{v3.08}{\Class{scrlttr2}}.

Zwischen den Sprachen wird bei Verwendung des
\Package{babel}-Paketes\IndexPackage{babel} (siehe \cite{package:babel}) mit
der Anweisung \Macro{selectlanguage}\Parameter{Sprache} gewechselt. Andere
Pakete wie \Package{german}\IndexPackage{german} (siehe \cite{package:german})
und \Package{ngerman}\IndexPackage{ngerman} (siehe \cite{package:ngerman})
besitzen diese Anweisung ebenfalls. In der Regel erfolgt eine
Sprachumschaltung jedoch bereits aufgrund des Ladens eines solchen Paketes.
\iffalse% Umbruchkorrekturtext!!!
Näheres entnehmen Sie bitte der jeweiligen Anleitung.
\fi

Erlauben\textnote{Achtung!} Sie mir noch einen Hinweis zu den
Sprachumschaltpaketen. Das Paket
\Package{french}\IndexPackage{french}\important{\Package{french}} (siehe
\cite{package:french}) nimmt neben der Umdefinierung der Begriffe aus
\autoref{tab:scrlttr2-experts.languageTerms} weitere Änderungen vor. So
definiert es etwa die Anweisung \Macro{opening} um. Dabei geht es einfach
davon aus, dass \Macro{opening} immer wie in der Standardbriefklasse
\Class{letter} definiert ist. Dies ist bei \Class{scrlttr2} jedoch nicht der
Fall. Das Paket \Package{french} zerstört deshalb die Definition aus
\Class{scrlttr2} und arbeitet nicht korrekt mir \KOMAScript{} zusammen. Ich
betrachte dies als Fehler des Paketes \Package{french}.
  
Wird das Paket \Package{babel}\IndexPackage{babel} für die
Umschaltung auf die Sprache \PValue{french} verwendet und ist gleichzeitig das
Paket \Package{french} installiert, so ergeben sich eventuell genau dieselben
Probleme, weil in diesem Fall Teile des Paketes \Package{french} verwendet
werden.
%
\iffalse
  % Umbruchergänzungstext
  Ist das Paket \Package{french} nicht installiert, ergibt sich das Problem
  mit \Package{babel} nicht.  Ebenfalls existiert das Problem normalerweise
  nicht, wenn man bei \Package{babel} an Stelle der Sprache \PValue{french}
  eine der Sprachen \PValue{acadian}, \PValue{canadien}, \PValue{francais}
  oder \PValue{frenchb} verwendet.
\fi

Mit Babel ab Version 3.7j tritt dieses Problem jedoch nur noch auf, wenn per
Option explizit angegeben wird, dass \Package{babel} das
\Package{french}-Paket verwenden soll.
%
\iftrue
  % Umbruchoptimierungspassage
  Kann nicht sicher gestellt werden, dass nicht eine alte Version von
  \Package{babel} verwendet wird, so empfehle ich%
  \iftrue
    , mit
\begin{lstcode}[belowskip=\dp\strutbox]
  \usepackage[...,frenchb,...]{babel}
\end{lstcode}
    französische Sprache auszuwählen. Gegebenenfalls ist dann aber trotzdem
    mit \Macro{selectlanguage}\PParameter{french} auf Französisch
    umzuschalten.%
  \else 
    \space bei \Package{babel} die Option \Option{frenchb}.%
  \fi 
\fi

\iftrue
  \enlargethispage*{\baselineskip}%
  Es ist nicht auszuschließen, dass mit anderen Sprachen und Paketen ähnliche
  Probleme auf"|treten.
  \iffalse
  \iftrue 
    Für Deutsch sind solche Probleme jedoch nicht bekannt  und treten weder
    mit den Paketen \Package{german}\IndexPackage{german} oder
    \Package{ngerman}\IndexPackage{ngerman} noch mit \Package{babel} auf.
  \else
    Für Deutsch treten solche Probleme mit den Paketen
    \Package{german}\IndexPackage{german},
    \Package{ngerman}\IndexPackage{ngerman} oder \Package{babel} jedoch nicht
    auf.
  \fi
  \fi
\fi


\begin{Declaration}
  \Macro{captionsenglish}\\
  \Macro{captionsUSenglish}\\
  \Macro{captionsamerican}\\
  \Macro{captionsbritish}\\
  \Macro{captionsUKenglish}\\
  \Macro{captionsgerman}\\
  \Macro{captionsngerman}\\
  \Macro{captionsaustrian}\\
  \Macro{captionsnaustrian}\\
  \Macro{captionsfrench}\\
  \Macro{captionsitalian}\\
  \Macro{captionsspanish}\\
  \Macro{captionsdutch}\\
  \Macro{captionscroatian}\\
  \Macro{captionsfinnish}\\
  \Macro{captionsnorsk}\\
  \Macro{captionsswedish}
\end{Declaration}
\BeginIndex{Cmd}{captionsenglish}\BeginIndex{Cmd}{captionsUSenglish}%
\BeginIndex{Cmd}{captionsamerican}\BeginIndex{Cmd}{captionsbritish}%
\BeginIndex{Cmd}{captionsUKenglish}%
\BeginIndex{Cmd}{captionsgerman}\BeginIndex{Cmd}{captionsngerman}%
\BeginIndex{Cmd}{captionsaustrian}\BeginIndex{Cmd}{captionsnaustrian}%
\BeginIndex{Cmd}{captionsfrench}%
\BeginIndex{Cmd}{captionsitalian}%
\BeginIndex{Cmd}{captionsspanish}%
\BeginIndex{Cmd}{captionsdutch}%
\BeginIndex{Cmd}{captionscroatian}%
\BeginIndex{Cmd}{captionsfinnish}%
\BeginIndex{Cmd}{captionsnorsk}%
\BeginIndex{Cmd}{captionsswedish}%
Wird die Sprache eines Briefes gewechselt, so werden über diese Anweisungen
die Begriffe aus \autoref{tab:scrlttr2-experts.languageTerms},
\autopageref{tab:scrlttr2-experts.languageTerms} umdefiniert. Sollte das
verwendete Sprachumschaltpaket dies nicht unterstützen, so können obige
Anweisungen notfalls auch direkt verwendet werden.%
%
\EndIndex{Cmd}{captionsswedish}%
\EndIndex{Cmd}{captionsnorsk}%
\EndIndex{Cmd}{captionsenglish}\EndIndex{Cmd}{captionsUSenglish}%
\EndIndex{Cmd}{captionsamerican}\EndIndex{Cmd}{captionsbritish}%
\EndIndex{Cmd}{captionsUKenglish}\EndIndex{Cmd}{captionsgerman}%
\EndIndex{Cmd}{captionsngerman}%
\EndIndex{Cmd}{captionsaustrian}\EndIndex{Cmd}{captionsnaustrian}%
\EndIndex{Cmd}{captionsfrench}%
\EndIndex{Cmd}{captionsitalian}\EndIndex{Cmd}{captionsspanish}%
\EndIndex{Cmd}{captionsdutch}\EndIndex{Cmd}{captionscroatian}%
\EndIndex{Cmd}{captionsfinnish}%


\begin{Declaration}
  \Macro{dateenglish}\\
  \Macro{dateUSenglish}\\
  \Macro{dateamerican}\\
  \Macro{datebritish}\\
  \Macro{dateUKenglish}\\
  \Macro{dategerman}\\
  \Macro{datengerman}\\
  \Macro{dateaustrian}\\
  \Macro{datenaustrian}\\
  \Macro{datefrench}\\
  \Macro{dateitalian}\\
  \Macro{datespanish}\\
  \Macro{datedutch}\\
  \Macro{datecroatian}\\
  \Macro{datefinnish}\\
  \Macro{datenorsk}\\
  \Macro{dateswedish}
\end{Declaration}
\BeginIndex{Cmd}{dateenglish}\BeginIndex{Cmd}{dateUSenglish}%
\BeginIndex{Cmd}{dateamerican}\BeginIndex{Cmd}{datebritish}%
\BeginIndex{Cmd}{dateUKenglish}\BeginIndex{Cmd}{dategerman}%
\BeginIndex{Cmd}{datengerman}%
\BeginIndex{Cmd}{dateaustrian}\BeginIndex{Cmd}{datenaustrian}%
\BeginIndex{Cmd}{datefrench}%
\BeginIndex{Cmd}{dateitalian}\BeginIndex{Cmd}{datespanish}%
\BeginIndex{Cmd}{datedutch}\BeginIndex{Cmd}{datecroatian}%
\BeginIndex{Cmd}{datefinnish}%
\BeginIndex{Cmd}{datenorsk}%
\BeginIndex{Cmd}{dateswedish}%
Je nach verwendeter Sprache werden auch die Datumsangaben\Index{Datum} des
nummerischen Datums (siehe Option \Option{numericaldate} in
\autoref{sec:scrlttr2.firstpage},
\autopageref{desc:scrlttr2.option.numericaldate}) in unterschiedlicher Form
umgesetzt. Die genauen Angaben können der \autoref{tab:date} entnommen
werden.%
%
\begin{table}
%  \centering
  \KOMAoptions{captions=topbeside}%
  \setcapindent{0pt}%
%  \caption
  \begin{captionbeside}{Sprachabhängige Ausgabeformate für das Datum}[l]
    \begin{tabular}[t]{ll}
      \toprule
      Anweisung             & Ausgabebeispiel \\
      \midrule
      \Macro{dateenglish}   & 24/12/1993\\
      \Macro{dateUSenglish} & 12/24/1993\\
      \Macro{dateamerican}  & 12/24/1993\\
      \Macro{datebritish}   & 24/12/1993\\
      \Macro{dateUKenglish} & 24/12/1993\\
      \Macro{dategerman}    & 24.\,12.\,1993\\
      \Macro{datengerman}   & 24.\,12.\,1993\\
      \Macro{dateaustrian}  & 24.\,12.\,1993\\
      \Macro{datenaustrian} & 24.\,12.\,1993\\
      \Macro{datefrench}    & 24.\,12.\,1993\\
      \Macro{dateitalian}   & 24.\,12.\,1993\\
      \Macro{datespanish}   & 24.\,12.\,1993\\
      \Macro{datedutch}     & 24.\,12.\,1993\\
      \Macro{datecroatian}  & 24.\,12.\,1993.\\
      \Macro{datefinnish }  & 24.12.1993.\\
      \Macro{datenorsk}     & 24.12.1993\\
      \Macro{dateswedish}   & 24/12 1993\\
      \bottomrule
    \end{tabular}
  \end{captionbeside}
  \label{tab:date}
\end{table}
%
\EndIndex{Cmd}{dateswedish}%
\EndIndex{Cmd}{datenorsk}%
\EndIndex{Cmd}{dateenglish}\EndIndex{Cmd}{dateUSenglish}%
\EndIndex{Cmd}{dateamerican}\EndIndex{Cmd}{datebritish}%
\EndIndex{Cmd}{dateUKenglish}\EndIndex{Cmd}{dategerman}%
\EndIndex{Cmd}{datengerman}%
\EndIndex{Cmd}{dateaustrian}\EndIndex{Cmd}{datenaustrian}%
\EndIndex{Cmd}{datefrench}%
\EndIndex{Cmd}{dateitalian}\EndIndex{Cmd}{datespanish}%
\EndIndex{Cmd}{datedutch}\EndIndex{Cmd}{datecroatian}%
\EndIndex{Cmd}{datefinnish}%


\begin{Declaration}
  \Macro{yourrefname}\\
  \Macro{yourmailname}\\
  \Macro{myrefname}\\
  \Macro{customername}\\
  \Macro{invoicename}\\
  \Macro{subjectname}\\
  \Macro{ccname}\\
  \Macro{enclname}\\
  \Macro{headtoname}\\
  \Macro{headfromname}\\
  \Macro{datename}\\
  \Macro{pagename}\\
  \Macro{phonename}\\
  \Macro{faxname}\\
  \Macro{emailname}\\
  \Macro{wwwname}\\
  \Macro{bankname}
\end{Declaration}
\BeginIndex{Cmd}{yourrefname}\BeginIndex{Cmd}{yourmailname}%
\BeginIndex{Cmd}{myrefname}%
\BeginIndex{Cmd}{customername}\BeginIndex{Cmd}{invoicename}%
\BeginIndex{Cmd}{subjectname}%
\BeginIndex{Cmd}{ccname}\BeginIndex{Cmd}{enclname}%
\BeginIndex{Cmd}{headtoname}\BeginIndex{Cmd}{headfromname}%
\BeginIndex{Cmd}{datename}\BeginIndex{Cmd}{pagename}%
\BeginIndex{Cmd}{phonename}\BeginIndex{Cmd}{faxname}%
\BeginIndex{Cmd}{emailname}\BeginIndex{Cmd}{wwwname}%
\BeginIndex{Cmd}{bankname}%
Die aufgeführten Anweisungen enthalten die jeweiligen sprachtypischen
Begriffe. Diese können für die Realisierung einer weiteren Sprache oder aber
auch zur eigenen freien Gestaltung angepasst werden. Wie dies
geht\important[i]{%
  \Macro{newcaptionname}\\
  \Macro{renewcaptionname}\\
  \Macro{providecaptionname}}, wird in \autoref{sec:scrbase.languageSupport}
erklärt.  Von \Class{scrlttr2} werden die Begriffe erst nach der Präambel,
also bei \Macro{begin}\PParameter{document} gesetzt. Sie sind daher vorher
nicht verfügbar und können vorher auch nicht geändert werden. In
\autoref{tab:scrlttr2-experts.languageTerms} sind die Voreinstellungen für
\Option{english} und \Option{ngerman} zu finden.%
%
\begin{table}
  \begin{minipage}{\textwidth}
%  \centering
    \KOMAoptions{captions=topbeside}%
    \setcapindent{0pt}%
    %\caption
    \begin{captionbeside}[{%
        Voreinstellungen für die sprachabhängigen Begriffe%
      }]{%
        Voreinstellungen
        für die sprachabhängigen Begriffe bei Verwendung der Sprachen
        \Option{english} und \Option{ngerman} soweit nicht durch die Pakete
        zur Sprachumschaltung bereits definiert%
        \label{tab:scrlttr2-experts.languageTerms}%
      }[l]
      \begin{tabular}[t]{lll}
        \toprule
        Anweisung         & \Option{english} & \Option{ngerman} \\
        \midrule
        \Macro{bankname}     & Bank account   & Bankverbindung \\
        \Macro{ccname}\footnotemark[1]       & cc             & Kopien an \\
        \Macro{customername} & Customer no.   & Kundennummer \\
        \Macro{datename}     & Date           & Datum \\
        \Macro{emailname}    & Email          & E-Mail \\
        \Macro{enclname}\footnotemark[1]     & encl           & Anlagen \\
        \Macro{faxname}      & Fax            & Fax \\
        \Macro{headfromname} & From           & Von \\
        \Macro{headtoname}\footnotemark[1]   & To             & An \\
        \Macro{invoicename}  & Invoice no.    & Rechnungsnummer \\
        \Macro{myrefname}    & Our ref.       & Unser Zeichen \\
        \Macro{pagename}\footnotemark[1]     & Page           & Seite \\
        \Macro{phonename}    & Phone          & Telefon \\
        \Macro{subjectname}  & Subject        & Betrifft \\
        \Macro{wwwname}      & Url            & URL \\
        \Macro{yourmailname} & Your letter of & Ihr Schreiben vom\\
        \Macro{yourrefname}  & Your ref.      & Ihr Zeichen \\
        \bottomrule
      \end{tabular}
      \deffootnote{1em}{1em}{1\ }% brutal aber effektiv
      \footnotetext[1000]{Diese Begriffe werden normalerweise bereits von
        Sprachpaketen wie \Package{babel} definiert und dann von
        \Class{scrlttr2} nicht überschrieben. Abweichungen im Wortlaut sind
        daher möglich und der Anleitung des verwendeten Sprachpakets zu
        entnehmen.}
    \end{captionbeside}
  \end{minipage}
\end{table}
%
\EndIndex{Cmd}{yourrefname}\EndIndex{Cmd}{yourmailname}%
\EndIndex{Cmd}{myrefname}%
\EndIndex{Cmd}{customername}\EndIndex{Cmd}{invoicename}%
\EndIndex{Cmd}{subjectname}%
\EndIndex{Cmd}{ccname}\EndIndex{Cmd}{enclname}%
\EndIndex{Cmd}{headtoname}\EndIndex{Cmd}{headfromname}%
\EndIndex{Cmd}{datename}\EndIndex{Cmd}{pagename}%
\EndIndex{Cmd}{phonename}\EndIndex{Cmd}{faxname}%
\EndIndex{Cmd}{emailname}\EndIndex{Cmd}{wwwname}%
\EndIndex{Cmd}{bankname}%
%
\EndIndex{}{Sprachen}%


\section{Von der obsoleten \Class{scrlettr} zur 
aktuellen  \Class{scrlttr2}}
\label{sec:scrlttr2-experts.fromscrlettr}
\BeginIndex{Class}{scrlettr}

Die\textnote{Achtung!} alte Briefklasse \Class{scrlettr} wurde mit Einführung
von \Class{scrlttr2} (siehe \autoref{cha:scrlttr2}) 2002
obsolet. \Class{scrlettr} sollte für neue Briefe besser nicht mehr verwendet
werden. Die Klasse wird nicht mehr weiterentwickelt und es findet daher auch
kein Support mehr dafür statt.  Wer dennoch unbedingt die Anleitung zur alten
Briefklasse benötigt, kann diese in \File{scrlettr.dtx} finden. Am besten
führt man dazu einige \LaTeX-Läufe mit jener Datei durch, also beispielsweise:
\begin{lstoutput}[belowskip=\dp\strutbox,morekeywords={latex,mkindex}]
  latex scrlettr.dtx
  mkindex scrlettr
  latex scrlettr.dtx
  mkindex scrlettr
  latex scrlettr.dtx
\end{lstoutput}
Man erhält so die Datei \File{scrlettr.dvi} mit der Anleitung. Wer stattdessen
\File{scrlettr.pdf} haben möchte, ersetzt \File{latex} durch \File{pdflatex}.

Um den Umstieg von der alten auf die neue Klasse zu erleichtern, existiert mit
\Option{KOMAold} eine Kompatibilitätseinstellung. Grundsätzlich ist in der
neuen Klasse die gesamte alte Funktionalität enthalten. Ohne \Option{KOMAold}
ist jedoch die Benutzerschnittstelle eine andere und auch die Voreinstellungen
stimmen nicht überein. Näheres dazu ist \autoref{sec:scrlttr2.lcoFile},
\autoref{tab:lcoFiles} zu entnehmen.

\LoadNonFree{scrlttr2-experts}{0}

\EndIndex{Class}{scrlettr}%

\endinput

%%% Local Variables:
%%% mode: latex
%%% coding: iso-latin-1
%%% TeX-master: "guide.tex"
%%% End:

% LocalWords:  Pseudolänge Pseudolängen Rücksendeadresse Faltmarke Briefseite
% LocalWords:  Sternvariante Geschäftszeile Testfeld Kopfbereich Vergleichsmaß
% LocalWords:  Dokumenterstellungsprozess Fußbereich Anschriftfenster
% LocalWords:  Absenderergänzung Kundennummer Rechnungsnummer
