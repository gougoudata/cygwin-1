#!/bin/sh
[ -f /etc/postinstall/gcc-mingw-gdc-3.4.4-0.12.1-3.tar.xz ] || exit 0
/bin/mkdir -p /usr/i686-pc-mingw32
cd /usr/i686-pc-mingw32
for d in include lib bin
do
  if [ -e /usr/i686-pc-mingw32/$d -a -h /usr/i686-pc-mingw32/$d ]
  then
    rm -f /usr/i686-pc-mingw32/$d
  fi
done
echo "*** Unpacking /etc/postinstall/gcc-mingw-gdc-3.4.4-0.12.1-3.tar.xz.  Please wait. ***"
/bin/tar -xvJf /etc/postinstall/gcc-mingw-gdc-3.4.4-0.12.1-3.tar.xz -C /usr |\
	/bin/sort -r > /etc/preremove/gcc-mingw-gdc-manifest.tmp

echo "*** Creating symbolic link for cc1d.exe.  Please wait. ***"
cd /usr/lib/gcc/i686-pc-mingw32/3.4.4
ln -fs ../../i686-pc-cygwin/3.4.4/cc1d.exe .

echo lib/gcc/i686-pc-mingw32/3.4.4/cc1d.exe >> /etc/preremove/gcc-mingw-gdc-manifest.tmp

cat /etc/preremove/gcc-mingw-gdc-manifest.tmp | sort -r > /etc/preremove/gcc-mingw-gdc-manifest.lst
rm -f /etc/preremove/gcc-mingw-gdc-manifest.tmp

